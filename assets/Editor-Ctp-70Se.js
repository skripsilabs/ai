import{c as Pe,j as u,r as me,B as ht,a as bs,b as li,d as ys,N as De}from"./index-DeXttkso.js";import{P as xs,G as vs,S as ks,M as _s}from"./SidebarKiri-BGHGAOwu.js";import{B as nr,C as bt}from"./check-check-B02jodrh.js";import{P as ui,I as ci,R as Es}from"./rotate-ccw-UetKkalI.js";import{R as fn,M as Ss,E as Ts}from"./jspdf.es.min-rn-AgVKW.js";import{X as it}from"./x-DRrJGRAe.js";import{P as En,T as Sn}from"./trash-2-BSCXPgUz.js";import{L as As}from"./message-square-text-BvjBAWn2.js";import{C as di}from"./circle-check-tvsPT1AV.js";import{B as hn}from"./book-open-Cva1ig7P.js";import{U as Ns}from"./users-Bb4rYT0d.js";import{S as Mt}from"./sparkles-Bv4VGhTA.js";import{L as Tn}from"./loader-circle-C-DcKKyS.js";import{Z as js}from"./zap-DYRIj9g4.js";import{A as fi}from"./arrow-right-C5WVa9mE.js";import{S as Cs}from"./shield-check-B1VVpYKN.js";import{F as ar}from"./file-text-Cd2KtJ7j.js";import{S as $n}from"./search-Dh1ifHfy.js";import{T as Rs}from"./triangle-alert-CSylRYgh.js";import{L as Is}from"./layers-oA3DEzgg.js";import{C as pn}from"./copy-DYED4OW8.js";import{C as Fs}from"./chevron-down-QWUZ-oq0.js";import{S as Os}from"./save-C2Zajlu-.js";import{D as Ps}from"./download-CUH6WGNn.js";import"./check-BEtJWzDQ.js";import"./heart-BBzGTZyt.js";/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=Pe("AlignLeft",[["line",{x1:"21",x2:"3",y1:"6",y2:"6",key:"1fp77t"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}],["line",{x1:"17",x2:"3",y1:"18",y2:"18",key:"1awlsn"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=Pe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=Pe("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ls=Pe("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ms=Pe("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zs=Pe("FileType",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 13v-1h6v1",key:"1bb014"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"M11 18h2",key:"12mj7e"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=Pe("GitGraph",[["circle",{cx:"5",cy:"6",r:"3",key:"1qnov2"}],["path",{d:"M5 9v6",key:"158jrl"}],["circle",{cx:"5",cy:"18",r:"3",key:"104gr9"}],["path",{d:"M12 3v18",key:"108xh3"}],["circle",{cx:"19",cy:"6",r:"3",key:"108a5v"}],["path",{d:"M16 15.7A9 9 0 0 0 19 9",key:"1e3vqb"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ws=Pe("LayoutTemplate",[["rect",{width:"18",height:"7",x:"3",y:"3",rx:"1",key:"f1a2em"}],["rect",{width:"9",height:"7",x:"3",y:"14",rx:"1",key:"jqznyg"}],["rect",{width:"5",height:"7",x:"16",y:"14",rx:"1",key:"q5h2i8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pi=Pe("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mi=Pe("MessageSquareDashed",[["path",{d:"M3 6V5c0-1.1.9-2 2-2h2",key:"9usibi"}],["path",{d:"M11 3h3",key:"1c3ji7"}],["path",{d:"M18 3h1c1.1 0 2 .9 2 2",key:"19esxn"}],["path",{d:"M21 9v2",key:"p14lih"}],["path",{d:"M21 15c0 1.1-.9 2-2 2h-1",key:"1fo1j8"}],["path",{d:"M14 17h-3",key:"1w4p2m"}],["path",{d:"m7 17-4 4v-5",key:"ph9x1h"}],["path",{d:"M3 12v-2",key:"856n1q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hs=Pe("Microscope",[["path",{d:"M6 18h8",key:"1borvv"}],["path",{d:"M3 22h18",key:"8prr45"}],["path",{d:"M14 22a7 7 0 1 0 0-14h-1",key:"1jwaiy"}],["path",{d:"M9 14h2",key:"197e7h"}],["path",{d:"M9 12a2 2 0 0 1-2-2V6h6v4a2 2 0 0 1-2 2Z",key:"1bmzmy"}],["path",{d:"M12 6V3a1 1 0 0 0-1-1H9a1 1 0 0 0-1 1v3",key:"1drr47"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gi=Pe("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gs=Pe("PenTool",[["path",{d:"M15.707 21.293a1 1 0 0 1-1.414 0l-1.586-1.586a1 1 0 0 1 0-1.414l5.586-5.586a1 1 0 0 1 1.414 0l1.586 1.586a1 1 0 0 1 0 1.414z",key:"nt11vn"}],["path",{d:"m18 13-1.375-6.874a1 1 0 0 0-.746-.776L3.235 2.028a1 1 0 0 0-1.207 1.207L5.35 15.879a1 1 0 0 0 .776.746L13 18",key:"15qc1e"}],["path",{d:"m2.3 2.3 7.286 7.286",key:"1wuzzi"}],["circle",{cx:"11",cy:"11",r:"2",key:"xmgehs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ks=Pe("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qs=Pe("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vs=Pe("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $s=Pe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wi=Pe("WandSparkles",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72",key:"ul74o6"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xs=Pe("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zs=Pe("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Ys=[{id:"continue",label:"Auto Tulis",desc:"Lanjutkan tulisan dari posisi kursor terakhir.",icon:u.jsx(ui,{size:20}),requiresSelection:!1,color:"text-blue-600",bg:"bg-blue-50 group-hover:bg-blue-600 group-hover:text-white"},{id:"paraphrase",label:"Auto Parafrase",desc:"AI Mode: Ubah struktur kalimat agar unik & akademis (Anti-Plagiasi).",icon:u.jsx(fn,{size:20}),requiresSelection:!0,color:"text-purple-600",bg:"bg-purple-50 group-hover:bg-purple-600 group-hover:text-white"},{id:"fix",label:"Koreksi Ejaan",desc:"Perbaiki tata bahasa (PUEBI) dan typo otomatis.",icon:u.jsx(bt,{size:20}),requiresSelection:!0,color:"text-orange-600",bg:"bg-orange-50 group-hover:bg-orange-600 group-hover:text-white"},{id:"plagiarism",label:"Cek Plagiasi",desc:"Simulasi Turnitin: Cek potensi skor plagiasi & orisinalitas.",icon:u.jsx(Ms,{size:20}),requiresSelection:!0,color:"text-red-600",bg:"bg-red-50 group-hover:bg-red-600 group-hover:text-white"}],Js=({onToolAction:t,isGenerating:e,hasSelection:r})=>u.jsxs("div",{className:"w-full md:w-72 bg-white flex flex-col shadow-sm z-10 shrink-0 h-full sidebar-enter-right",children:[u.jsx("div",{className:"p-5 border-b border-slate-100 bg-white pt-8 md:pt-5 sticky top-0 z-10",children:u.jsxs("div",{className:"flex items-center gap-2.5 text-slate-800",children:[u.jsx("div",{className:"p-1.5 bg-slate-100 rounded-lg",children:u.jsx(wi,{size:18,className:"text-slate-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"font-bold text-sm",children:"Alat Bantu AI"}),u.jsx("p",{className:"text-[10px] text-slate-400",children:"Pilih tools untuk memproses teks"})]})]})}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 scroll-light bg-slate-50/50",children:Ys.map((l,d)=>{let o=l.label,s=l.desc,a=l.icon;return l.id==="continue"&&r&&(o="Auto Expand",s="Kembangkan teks terpilih menjadi beberapa paragraf detail.",a=u.jsx(pi,{size:20})),u.jsxs("button",{onClick:()=>t(l.id),disabled:e,className:"w-full text-left bg-white border border-slate-200 p-4 rounded-2xl shadow-sm hover:shadow-lg transition-all duration-300 group disabled:opacity-50 disabled:cursor-not-allowed hover:-translate-y-1 relative overflow-hidden",style:{animationDelay:`${d*100}ms`},children:[u.jsx("div",{className:`absolute inset-0 opacity-0 group-hover:opacity-10 transition-opacity duration-300 bg-current ${l.color}`}),u.jsxs("div",{className:"flex items-start gap-3 mb-2 relative z-10",children:[u.jsx("div",{className:`p-2.5 rounded-xl transition-colors duration-300 ${l.bg} ${l.color}`,children:a}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-slate-800 text-sm group-hover:text-slate-900",children:o}),l.requiresSelection&&u.jsx("span",{className:"text-[10px] bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded border border-slate-200 mt-1 inline-block font-medium",children:"Perlu Seleksi Teks"})]})]}),u.jsx("p",{className:"text-xs text-slate-500 leading-relaxed pl-1 group-hover:text-slate-600 relative z-10",children:s})]},l.id)})}),u.jsx("div",{className:"p-4 text-center border-t border-slate-100 bg-white",children:u.jsxs("p",{className:"text-[10px] text-slate-400 flex items-center justify-center gap-1",children:[u.jsx(nr,{size:10}),"Tools bekerja pada bagian aktif."]})})]}),Qs="<<<REFERENCES>>>",Xn=["Menganalisis konteks tulisan ...","Mengembangkan ide argumen ...","Mencari jurnal (jika diminta) ...","Menyusun paragraf akademik ...","Validasi format sitasi ...","Menyelesaikan naskah ..."],eo=({isOpen:t,onClose:e,onConfirm:r,metadata:l,sectionTitle:d,toolType:o,currentContent:s="",isExpandMode:a=!1,existingBibliography:c=[]})=>{const[x,v]=me.useState("parameter"),[S,T]=me.useState(2),[w,E]=me.useState(100),[y,A]=me.useState(0),[p,k]=me.useState("jurnal"),[j,O]=me.useState("nasional"),[F,G]=me.useState(""),[W,$]=me.useState(!1),[N,ne]=me.useState(!1),[se,B]=me.useState(""),[X,_]=me.useState(""),[Y,de]=me.useState([]),[Q,pe]=me.useState(0),[te,fe]=me.useState(0),H=me.useRef(null),R=5,K=S*2;me.useEffect(()=>{t&&(G(""),B(""),_(""),de([]),ne(!1),v("parameter"),pe(0),fe(0),$(!1),E(150),T(2),A(0),k("jurnal"),O("nasional"))},[t]),me.useEffect(()=>{if(!se)return;const P=se.split(Qs);if(_(P[0].trim()),P.length>1){const I=P[1].trim().split(`
`).map(J=>J.trim()).filter(J=>J.length>5);de(I)}else de([])},[se]),me.useEffect(()=>{y>K&&A(K)},[S,K]),me.useEffect(()=>{let P,C;return N?(pe(0),fe(5),P=setInterval(()=>{pe(I=>(I+1)%Xn.length)},3e3),C=setInterval(()=>{fe(I=>{if(I>=95)return I;const J=I<50?2:I<80?1:.5;return I+J})},200)):se&&fe(100),()=>{clearInterval(P),clearInterval(C)}},[N,se]);const V=P=>{E(C=>Math.max(50,Math.min(2e3,C+P)))},z=async()=>{var P,C;v("hasil"),B(""),ne(!0),H.current=new AbortController;try{let I=a?`(MODE: EXPAND) Kembangkan teks ini menjadi ${S} paragraf detail. ${F}`:F;if(W&&c.length>0){const Z=c.map((b,n)=>`[${n+1}] ${b}`).join(`
`);I+=`

[PENTING: Gunakan referensi berikut untuk sitasi. JANGAN buat referensi fiktif baru, ambil ilmunya dari sini]:
${Z}`}const J={numParagraphs:S,minWords:w,numReferences:W?0:y,refType:y>0&&!W?p:void 0,refScope:y>0&&!W?j:void 0,instruction:I},h=await bs({mode:"continue",metadata:l,sectionTitle:d,currentContent:s,config:J});for await(const Z of h){if((P=H.current)!=null&&P.signal.aborted)break;Z.text&&B(b=>b+Z.text)}}catch{(C=H.current)!=null&&C.signal.aborted||B(J=>J+`

[Error: Gagal menghubungi AI. Silakan coba lagi.]`)}finally{ne(!1),H.current=null}},g=()=>{r(X,Y),e()},m=()=>{H.current&&H.current.abort(),ne(!1)};if(!t)return null;const M=["parameter","informasi","hasil"];return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-md animate-fade-in",children:u.jsxs("div",{className:"bg-slate-950 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden border border-slate-800 flex flex-col max-h-[90vh]",children:[!N&&u.jsxs("div",{className:"bg-slate-900 border-b border-slate-800 p-4 shrink-0 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:`p-2 rounded-lg border ${a?"bg-purple-500/10 border-purple-500/30 text-purple-400":"bg-blue-500/10 border-blue-500/30 text-blue-400"}`,children:a?u.jsx(pi,{size:20}):u.jsx(ui,{size:20})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-base text-white",children:a?"Auto Expand (Pengembangan)":"Auto Tulis (Lanjutan)"}),u.jsx("p",{className:"text-[10px] text-slate-400",children:a?"Mengembangkan ide terpilih":"Melanjutkan dari akhir kalimat"})]})]}),u.jsx("button",{onClick:e,className:"text-slate-500 hover:text-white transition-colors",children:u.jsx(it,{size:20})})]}),!N&&u.jsx("div",{className:"flex border-b border-slate-800 bg-slate-900/50",children:M.map(P=>u.jsx("button",{onClick:()=>v(P),className:`flex-1 py-3 text-xs font-bold uppercase tracking-wider transition-all border-b-2 ${x===P?"border-blue-500 text-blue-400 bg-blue-500/5":"border-transparent text-slate-500 hover:text-slate-300"}`,children:P.charAt(0).toUpperCase()+P.slice(1)},P))}),u.jsx("div",{className:`flex-1 overflow-y-auto ${N?"p-0 flex items-center justify-center":"p-6"} scroll-dark min-h-[400px]`,children:N?u.jsxs("div",{className:"flex flex-col items-center justify-center text-center space-y-8 p-10 w-full h-full bg-slate-950 relative overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 z-0",children:u.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-blue-600/10 rounded-full blur-[80px] animate-pulse"})}),u.jsxs("div",{className:"relative z-10 flex flex-col items-center animate-fade-in-up",children:[u.jsx("div",{className:"p-4 bg-slate-900/50 rounded-2xl border border-slate-800 shadow-xl mb-4",children:u.jsx(ht,{className:"w-16 h-16 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-white tracking-tight",children:"Skripsi Labs"}),u.jsx("p",{className:"text-xs text-blue-300 uppercase tracking-[0.2em] font-medium mt-1",children:"Artificial Intellegent Laboratoriums"})]}),u.jsxs("div",{className:"relative z-10 w-full max-w-sm space-y-4",children:[u.jsx("div",{className:"flex items-center justify-center gap-3 text-slate-300",children:u.jsx("span",{className:"text-sm font-mono animate-pulse min-w-[200px] text-center",children:Xn[Q]})}),u.jsx("div",{className:"h-1.5 w-full bg-slate-900 rounded-full overflow-hidden border border-slate-800/50",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-purple-600 shadow-[0_0_10px_#3b82f6] transition-all duration-300 ease-out",style:{width:`${te}%`}})})]}),u.jsx("button",{onClick:m,className:"relative z-10 px-6 py-2 rounded-full border border-slate-800 text-slate-500 text-xs hover:text-white hover:border-red-500/50 hover:bg-red-500/10 transition-colors mt-8",children:"Batalkan Proses"})]}):u.jsxs(u.Fragment,{children:[x==="parameter"&&u.jsxs("div",{className:"space-y-6 animate-fade-in",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase block flex justify-between",children:[u.jsx("span",{children:"Jumlah Paragraf"}),u.jsx("span",{className:"text-blue-400",children:S})]}),u.jsx("div",{className:"flex items-center gap-4 bg-slate-900 p-3 rounded-lg border border-slate-800",children:u.jsx("input",{type:"range",min:"1",max:R,step:"1",value:S,onChange:P=>T(parseInt(P.target.value)),className:"flex-1 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-blue-500"})}),u.jsx("p",{className:"text-[9px] text-slate-500",children:"Maksimal 5 paragraf per generasi."})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block",children:"Target Kata"}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx("button",{onClick:()=>V(-50),className:"w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 text-slate-300 transition-colors",children:u.jsx(gi,{size:14})}),u.jsxs("div",{className:"flex-1 bg-slate-900 border border-slate-800 h-8 flex items-center justify-center rounded text-xs font-mono text-white",children:[w," Kata"]}),u.jsx("button",{onClick:()=>V(50),className:"w-8 h-8 flex items-center justify-center bg-slate-800 rounded hover:bg-slate-700 text-slate-300 transition-colors",children:u.jsx(En,{size:14})})]})]})]}),u.jsxs("div",{className:"bg-slate-900/50 p-4 rounded-xl border border-slate-800",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-300 uppercase block flex items-center gap-2",children:[u.jsx(nr,{size:14,className:"text-emerald-500"})," Referensi & Sitasi (APA 7)"]}),!W&&u.jsxs("span",{className:"text-[10px] text-emerald-400 bg-emerald-500/10 px-2 py-0.5 rounded border border-emerald-500/20",children:["Max: ",K]})]}),c.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2",children:[u.jsxs("label",{className:"text-[10px] text-slate-500 font-bold flex gap-1 items-center",children:[u.jsx(As,{size:12})," Sumber Data"]}),u.jsxs("span",{className:"text-[10px] text-slate-500",children:[c.length," Tersedia"]})]}),u.jsxs("button",{onClick:()=>$(!W),className:`w-full py-2.5 px-3 rounded-lg text-xs font-bold flex items-center justify-center gap-2 transition-all border ${W?"bg-purple-600 text-white border-purple-500 shadow-lg shadow-purple-900/20":"bg-slate-800 text-slate-400 border-slate-700 hover:bg-slate-700"}`,children:[W?u.jsx(di,{size:14}):u.jsx(hn,{size:14}),"Gunakan Referensi Yang Ada"]}),W&&u.jsx("p",{className:"text-[9px] text-purple-300 mt-2 text-center animate-pulse",children:"AI akan mengutip dari daftar pustaka Anda."})]}),!W&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex items-center gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{className:"text-[10px] text-slate-500 mb-1 block",children:"Jumlah Sumber (Cari Baru)"}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("input",{type:"range",min:"0",max:K,step:"1",value:y,onChange:P=>A(parseInt(P.target.value)),className:"flex-1 h-1.5 bg-slate-700 rounded-lg appearance-none cursor-pointer accent-emerald-500"}),u.jsx("span",{className:"text-sm font-bold text-white w-6 text-center",children:y})]})]})}),y>0&&u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-3 pt-3 border-t border-slate-800 animate-fade-in",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-slate-500 mb-2 block uppercase font-bold",children:"Jenis Referensi"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>k("jurnal"),className:`flex-1 py-1.5 text-xs rounded border transition-all relative ${p==="jurnal"?"bg-emerald-500/20 border-emerald-500/50 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:"Jurnal"}),u.jsx("button",{onClick:()=>k("buku"),className:`flex-1 py-1.5 text-xs rounded border transition-all ${p==="buku"?"bg-emerald-500/20 border-emerald-500/50 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:"Buku"}),u.jsx("button",{onClick:()=>k("website"),className:`flex-1 py-1.5 text-xs rounded border transition-all ${p==="website"?"bg-emerald-500/20 border-emerald-500/50 text-emerald-400":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:"Web"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-[10px] text-slate-500 mb-2 block uppercase font-bold",children:"Cakupan"}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>O("nasional"),className:`flex-1 py-1.5 text-xs rounded border transition-all ${j==="nasional"?"bg-blue-500/20 border-blue-500/50 text-blue-400":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:"Nasional"}),u.jsx("button",{onClick:()=>O("internasional"),className:`flex-1 py-1.5 text-xs rounded border transition-all ${j==="internasional"?"bg-blue-500/20 border-blue-500/50 text-blue-400":"bg-slate-800 border-slate-700 text-slate-400 hover:bg-slate-700"}`,children:"Internasional"})]})]})]})]})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase block flex items-center gap-2",children:[u.jsx(mi,{size:14})," Instruksi Tambahan"]}),u.jsx("textarea",{rows:3,placeholder:a?"Jelaskan lebih detail bagian ini, tambahkan data statistik...":"Contoh: Fokuskan pada aspek ekonomi...",value:F,onChange:P=>G(P.target.value),className:"w-full p-3 bg-slate-900 border border-slate-800 rounded-xl text-sm text-white focus:ring-1 focus:ring-blue-500 focus:border-blue-500 outline-none resize-none placeholder:text-slate-600"})]})]}),x==="informasi"&&u.jsx("div",{className:"space-y-6 animate-fade-in",children:u.jsxs("div",{className:"bg-slate-900 border border-slate-800 rounded-xl overflow-hidden",children:[u.jsxs("div",{className:"bg-slate-800/50 px-4 py-2 border-b border-slate-800 flex items-center gap-2",children:[u.jsx(ci,{size:14,className:"text-blue-400"}),u.jsx("h4",{className:"text-xs font-bold text-slate-300 uppercase tracking-wide",children:"Konteks Naskah"})]}),u.jsxs("div",{className:"p-4 space-y-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-500 font-bold flex items-center gap-1.5",children:[u.jsx(hn,{size:12})," Judul Skripsi"]}),u.jsx("p",{className:"text-sm font-medium text-white leading-relaxed",children:l.title||"-"})]}),u.jsx("div",{className:"h-px bg-slate-800 w-full"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-500 font-bold flex items-center gap-1.5",children:[u.jsx(Hs,{size:12})," Metode"]}),u.jsx("p",{className:"text-xs text-slate-300",children:l.methodology||"-"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-500 font-bold flex items-center gap-1.5",children:[u.jsx(Ns,{size:12})," Subjek"]}),u.jsx("p",{className:"text-xs text-slate-300",children:l.researchSubject||"-"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-500 font-bold flex items-center gap-1.5",children:[u.jsx($s,{size:12})," Objek"]}),u.jsx("p",{className:"text-xs text-slate-300",children:l.researchObject||"-"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsxs("label",{className:"text-[10px] uppercase text-slate-500 font-bold flex items-center gap-1.5",children:[u.jsx(Ss,{size:12})," Wilayah"]}),u.jsx("p",{className:"text-xs text-slate-300",children:l.scope||"-"})]})]})]})]})}),x==="hasil"&&u.jsxs("div",{className:"h-full flex flex-col gap-6 animate-fade-in relative",children:[!N&&!X&&u.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center text-slate-500 opacity-60 min-h-[200px]",children:[u.jsx(Mt,{size:48,className:"mb-4 text-slate-600"}),u.jsx("p",{className:"text-sm",children:'Klik "Mulai Proses" untuk melihat hasil.'})]}),X&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative flex-1 space-y-2",children:[u.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Hasil Teks"}),u.jsx("textarea",{value:X,onChange:P=>_(P.target.value),className:"w-full h-full min-h-[200px] bg-slate-900 border border-slate-800 rounded-xl p-4 text-sm leading-relaxed text-slate-200 outline-none focus:border-blue-500/50 resize-none font-academic no-scrollbar"})]}),Y.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-[10px] font-bold text-emerald-500 uppercase tracking-wider flex items-center gap-1",children:[u.jsx(nr,{size:12})," Daftar Pustaka Baru"]}),u.jsx("div",{className:"bg-slate-900 border border-emerald-900/30 rounded-xl p-3 max-h-[150px] overflow-y-auto scroll-dark",children:Y.map((P,C)=>u.jsx("div",{className:"text-xs text-slate-300 font-academic pl-4 -indent-4 mb-2",children:P},C))})]})]})]})]})}),!N&&u.jsxs("div",{className:"p-4 border-t border-slate-800 bg-slate-900 flex justify-between items-center shrink-0",children:[u.jsx("div",{className:"text-[10px] text-slate-500 hidden md:block",children:x==="informasi"?"Pastikan data sesuai.":x==="parameter"?"Sesuaikan konfigurasi.":"Review sebelum diterapkan."}),u.jsx("div",{className:"flex gap-3 ml-auto",children:x!=="hasil"?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:e,className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Batal"}),u.jsxs("button",{onClick:z,className:"px-6 py-2.5 bg-blue-600 hover:bg-blue-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-blue-900/20 flex items-center gap-2 group",children:[u.jsx(Mt,{size:14,className:"group-hover:animate-pulse"})," ",a?"Mulai Expand":"Mulai Tulis"]})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>v("parameter"),className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Ubah Parameter"}),u.jsxs("button",{onClick:g,disabled:!X,className:"px-6 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-green-900/20 flex items-center gap-2 disabled:opacity-50",children:[u.jsx(bt,{size:16})," Terapkan Hasil"]})]})})]})]})})},to={minimal:{ngramChance:.6,expandChance:.5,synonymChance:.5,passiveChance:.1},restructure:{ngramChance:.95,expandChance:.9,synonymChance:.9,passiveChance:.6},creative:{ngramChance:1,expandChance:1,synonymChance:1,passiveChance:.8}},ro={analisa:"analisis",diagnosa:"diagnosis",hipotesa:"hipotesis",metoda:"metode",teori:"teori",konsep:"konsep",resiko:"risiko",obyek:"objek",subyek:"subjek",praktek:"praktik",standarisasi:"standardisasi",kwalitas:"kualitas",kreatifitas:"kreativitas",efektifitas:"efektivitas",kapasitas:"kapasitas",validitas:"validitas",reliabilitas:"reliabilitas",aktifitas:"aktivitas",produktifitas:"produktivitas",sportifitas:"sportivitas",kompleksitas:"kompleksitas",apotik:"apotek",atmosfir:"atmosfer",ekstrim:"ekstrem",faham:"paham",frekwensi:"frekuensi",hakekat:"hakikat",himbau:"imbau",ijin:"izin",isteri:"istri",jadual:"jadwal",jaman:"zaman",jendral:"jenderal",justeru:"justru",karir:"karier",komplit:"komplet",konkrit:"konkret",lobang:"lubang",milyar:"miliar",moderen:"modern",nasehat:"nasihat",negri:"negeri",nomer:"nomor",propinsi:"provinsi",sistim:"sistem",tekhnik:"teknik",teknolgi:"teknologi",telor:"telur",syah:"sah",jenasah:"jenazah",gubug:"gubuk",hafal:"hafal",hapal:"hafal",hutang:"utang",rubah:"ubah",tampak:"tampak",nampak:"tampak",merubah:"mengubah",berfikir:"berpikir",mengkomparasi:"membandingkan",mengaplikasikan:"menerapkan",menganalisa:"menganalisis",mensosialisasikan:"menyosialisasikan",mengenyampingkan:"mengesampingkan",menterjemahkan:"menerjemahkan",mempesona:"memesona",mempengaruhi:"memengaruhi",mengkreasi:"mengkreasikan",belom:"belum",cuman:"cuma",banget:"sangat",gak:"tidak",nggak:"tidak",ga:"tidak",dapet:"dapat",udah:"sudah",sampe:"sampai",gimana:"bagaimana",kenapa:"mengapa",bikin:"membuat",pake:"pakai",kalo:"kalau",cape:"capai",ngerjain:"mengerjakan",ngaruh:"berpengaruh",ngumpulin:"mengumpulkan",bilang:"mengatakan",kasih:"memberi",liat:"lihat",tau:"tahu",mau:"ingin",implementasi:"implementasi",komunikasi:"komunikasi",informasi:"informasi",organisasi:"organisasi",evaluasi:"evaluasi",identifikasi:"identifikasi",observasi:"observasi",dokumentasi:"dokumentasi",standard:"standar",management:"manajemen",manager:"manajer",survey:"survei",sample:"sampel",theoretical:"teoretis",method:"metode",dimana:"di mana",yangmana:"yang mana",diantaranya:"di antaranya",kedalam:"ke dalam",keluar:"ke luar",kedepan:"ke depan",kesamping:"ke samping",didalam:"di dalam",diluar:"di luar",disana:"di sana",disini:"di sini",keatas:"ke atas",kebawah:"ke bawah",diproses:"diproses",dianalisa:"dianalisis",diolah:"diolah",dilakukan:"dilakukan",disaat:"di saat",ditempat:"di tempat",kwalifikasi:"kualifikasi",sekedar:"sekadar",azas:"asas",antri:"antre",respon:"respons",sekertaris:"sekretaris",kwitansi:"kuitansi",prakiraan:"perkiraan",responden:"responden",presentase:"persentase",prosentase:"persentase",sumberdaya:"sumber daya",bertanggungjawab:"bertanggung jawab",kerjasama:"kerja sama",pertanggungjawaban:"pertanggungjawaban",terimakasih:"terima kasih",tandatangan:"tanda tangan"},no={"oleh karena itu":["sebagai konsekuensi logisnya","mengacu pada implikasi tersebut","berdasarkan premis di atas","dengan demikian dapat disimpulkan bahwa","maka dari itu secara rasional","sebagai hasil dari pertimbangan tersebut","oleh sebab itu dapat dipahami bahwa","konsekuensinya dapat dirumuskan bahwa","berangkat dari hal tersebut"],"akan tetapi":["kendati demikian","meskipun begitu","namun dalam konteks berbeda","di sisi lain","walaupun demikian","sebaliknya","meskipun terdapat perbedaan pandangan","namun demikian dalam praktiknya","kendatipun begitu"],"selain itu":["di samping aspek tersebut","sebagai elaborasi lebih lanjut","paralel dengan hal itu","sebagai tambahan argumentasi","lebih jauh lagi","tidak hanya itu","sebagai penguatan pembahasan","dalam konteks tambahan lainnya","selaras dengan hal tersebut"],"pada saat ini":["dalam lanskap kontemporer","pada era kekinian","dewasa ini","dalam perkembangan mutakhir","pada kondisi aktual saat ini","dalam dinamika masa kini","dalam konteks temporal sekarang","pada fase perkembangan terkini","saat ini"],"sangat penting":["memiliki urgensi fundamental","memegang peranan krusial","bersifat esensial","menjadi aspek yang sangat menentukan","memiliki signifikansi tinggi","menjadi faktor kunci utama","bersifat vital dalam konteks ini","tidak dapat diabaikan signifikansinya","krusial"],"tidak bisa":["tidak memiliki kapabilitas untuk","mengalami keterbatasan dalam","tidak memungkinkan untuk","tidak dapat direalisasikan guna","menghadapi kendala dalam upaya","tidak mampu secara struktural untuk","tidak memenuhi prasyarat untuk","nihil kemampuan untuk"],"hal ini":["fenomena tersebut","kondisi empiris ini","realitas tersebut","keadaan yang dimaksud","situasi yang diamati","aspek ini","temuan tersebut","kondisi faktual yang terjadi","perkara ini"],"contohnya adalah":["salah satu representasinya yaitu","dapat diejemlifikasikan melalui","sebagai ilustrasi konkret","dapat dicontohkan melalui","sebagai gambaran nyata","salah satu manifestasinya adalah","sebagai bentuk implementatif","dapat ditunjukkan melalui contoh berikut","misalnya"],"bertujuan untuk":["memiliki orientasi untuk","diformulasikan guna","diarahkan dalam rangka","dimaksudkan sebagai upaya untuk","dirancang dengan tujuan untuk","ditujukan guna mencapai","berorientasi pada upaya untuk","difokuskan untuk menghasilkan","dimaksudkan untuk"],"berdampak pada":["berimplikasi signifikan terhadap","memberikan konsekuensi pada","mempengaruhi secara langsung terhadap","berkontribusi terhadap perubahan pada","menimbulkan efek terhadap","berpengaruh terhadap dinamika","menghasilkan implikasi pada","memicu konsekuensi lanjutan pada"],"berhubungan dengan":["berkorelasi secara linier dengan","memiliki asosiasi erat dengan","terkait secara konseptual dengan","berkaitan langsung dengan","memiliki relasi signifikan dengan","terhubung dalam kerangka","bersinggungan dengan aspek","memiliki keterkaitan struktural dengan"],"salah satu":["satu dari sekian elemen","salah satu komponen dari","bagian integral dari","elemen utama dalam","salah satu aspek penting dari","salah satu variabel kunci dalam","salah satu indikator utama dari"],"banyak orang":["sebagian besar masyarakat","mayoritas individu","khalayak luas","sebagian besar populasi","mayoritas responden","publik secara umum","masyarakat pada umumnya","kelompok individu secara luas","mayoritas orang"],"lebih baik":["lebih optimal","menunjukkan superioritas","lebih memadai","menunjukkan efektivitas yang lebih tinggi","lebih unggul secara fungsional","memberikan hasil yang lebih signifikan","lebih efisien dalam implementasi","menawarkan performa yang lebih baik"],"kurang baik":["kurang optimal","menunjukkan defisiensi","belum memadai","memiliki keterbatasan signifikan","menunjukkan kinerja yang rendah","kurang efektif dalam penerapan","belum menunjukkan hasil maksimal","masih berada pada tingkat suboptimal"],"seperti yang kita tahu":["sebagaimana dipahami secara umum","berdasarkan konsensus umum","sebagaimana telah diketahui bersama","sebagaimana telah banyak dibahas","sebagaimana tercermin dalam literatur","sebagaimana lazim dipahami","berdasarkan pemahaman kolektif","sesuai dengan pandangan umum"],"dari hasil":["berdasarkan temuan data","mengacu pada hasil analisis","merujuk pada luaran penelitian","berdasarkan hasil pengolahan data","mengacu pada temuan empiris","berdasarkan output yang diperoleh","merujuk pada hasil evaluasi","berdasarkan hasil kajian yang dilakukan"],"pertama-tama":["sebagai langkah awal","pada tahap inisiasi","mengawali pembahasan","sebagai prioritas utama","pada permulaan"],"pada akhirnya":["sebagai konklusi akhir","pada tahap finalisasi","sebagai hasil akhir","pada ujungnya","sebagai penutup"],"dengan kata lain":["secara lebih spesifik","dalam terminologi lain","dapat dipahami juga sebagai","artinya secara implisit","atau dapat dimaknai"],"berdasarkan hal tersebut":["mengacu pada premis tersebut","merujuk pada kondisi di atas","bertolak dari hal itu","atas dasar pemikiran tersebut"]},ao={menggunakan:["mengimplementasikan instrumen","mendayagunakan sumber daya","mengaplikasikan metode","memanfaatkan perangkat yang tersedia","mengoperasionalkan pendekatan tertentu","mengadopsi teknik yang relevan","mengintegrasikan sistem pendukung","mempergunakan sarana yang telah disiapkan","mengoptimalkan pemakaian alat","mengaktifkan fungsi dari perangkat","mengombinasikan metode yang sesuai","menggunakan pendekatan berbasis data","menerapkan prinsip kerja melalui","mengimplementasikan mekanisme operasional","memanfaatkan kerangka kerja yang ada","mengadaptasi teknologi pendukung","mengoperasikan instrumen penelitian","menerapkan strategi berbasis metode","mengaktifkan prosedur teknis","mengintegrasikan pendekatan metodologis"],membuat:["melakukan proses perancangan","menginisiasi pembentukan","memformulasikan kerangka","mengonstruksi rancangan awal","mengembangkan struktur konseptual","merancang dan merealisasikan","menyusun kerangka kerja sistematis","membangun model konseptual","menghasilkan bentuk rancangan","menciptakan susunan terstruktur","mewujudkan desain operasional","merekayasa struktur awal","menyusun formulasi konsep","mengkreasi kerangka analitis","menghasilkan bentuk implementatif","menginisiasi rancangan fungsional","menyusun desain metodologis","membangun konstruksi sistem","mengembangkan format operasional","menciptakan pola kerja terstruktur"],meneliti:["melakukan investigasi mendalam terhadap","melaksanakan studi empiris mengenai","mengkaji fenomena pada","menyelenggarakan penelitian sistematis terhadap","melakukan eksplorasi akademik mengenai","mengobservasi secara ilmiah aspek","melaksanakan pengkajian komprehensif terhadap","menelusuri dinamika yang terjadi pada","menginvestigasi variabel yang berkaitan dengan","melakukan analisis ilmiah terhadap","mengkaji secara kritis fenomena","melakukan telaah metodologis terhadap","mengadakan studi analitis mengenai","melakukan pendekatan riset terhadap","menyelidiki keterkaitan antar variabel pada","mengobservasi pola yang muncul dalam","melakukan penelitian berbasis data terhadap","menginvestigasi fenomena empiris pada","mengkaji kondisi aktual yang terjadi pada","melaksanakan riset terstruktur mengenai"],menjelaskan:["memberikan pemaparan komprehensif mengenai","menguraikan secara detail aspek","mendeskripsikan karakteristik","menyajikan penjelasan terperinci terkait","memaparkan konsep secara sistematis","mengelaborasi aspek-aspek utama dari","menjelaskan secara konseptual mengenai","memberikan penjabaran mendalam tentang","menguraikan hubungan antar komponen dalam","menyampaikan penjelasan analitis mengenai","menjabarkan landasan teoritis dari","memaparkan struktur dan mekanisme","menggambarkan kondisi secara objektif","menjelaskan latar belakang konseptual dari","memberikan ilustrasi konseptual mengenai","menguraikan kerangka berpikir dari","menyajikan penjelasan berbasis data tentang","mendeskripsikan dinamika yang terjadi pada","memaparkan hubungan sebab akibat dalam","menguraikan fenomena secara argumentatif"],menyimpulkan:["menarik benang merah konklusi","merumuskan kesimpulan akhir","menyusun simpulan berdasarkan temuan","menghasilkan kesimpulan yang merujuk pada data","merangkum hasil analisis menjadi simpulan","menyimpulkan temuan utama penelitian","menarik kesimpulan logis dari hasil kajian","merumuskan simpulan berdasarkan pembahasan","mengintegrasikan hasil analisis ke dalam simpulan","menyajikan simpulan akhir penelitian","menarik inferensi berdasarkan hasil penelitian","menyimpulkan keterkaitan antar variabel","merumuskan pernyataan akhir berdasarkan data","menarik kesimpulan konseptual dari analisis","menyimpulkan hasil kajian secara sistematis","menyajikan simpulan berbasis evidensi","merangkum keseluruhan temuan penelitian","menarik kesimpulan akademik dari pembahasan","menyimpulkan hasil studi secara menyeluruh","merumuskan konklusi final penelitian"],penting:["memiliki tingkat urgensi tinggi","memegang peranan strategis","bersifat krusial dalam konteks penelitian","menjadi aspek fundamental dalam kajian","memiliki signifikansi akademik yang tinggi","berperan penting dalam mendukung analisis","menjadi faktor penentu dalam penelitian","memiliki nilai strategis yang signifikan","berfungsi sebagai elemen kunci","menjadi landasan utama dalam pembahasan","memiliki relevansi teoritis yang kuat","berperan sentral dalam kerangka penelitian","menjadi komponen esensial dalam kajian","memiliki urgensi metodologis yang tinggi","bernilai penting dalam proses analisis","menjadi fondasi konseptual penelitian","berpengaruh signifikan terhadap hasil kajian","memegang posisi vital dalam penelitian","menjadi aspek utama yang perlu diperhatikan","memiliki peran dominan dalam pembahasan"],sulit:["memiliki kompleksitas tinggi","menghadirkan tantangan tersendiri","menuntut tingkat analisis yang mendalam","memerlukan pendekatan khusus","mengandung kerumitan konseptual","menjadi tantangan metodologis","memerlukan pemahaman yang komprehensif","menghadirkan kesulitan analitis","memiliki tingkat kesulitan yang signifikan","menuntut ketelitian tinggi dalam analisis","menjadi hambatan dalam proses penelitian","memerlukan strategi penyelesaian khusus","menjadi permasalahan kompleks dalam kajian","memiliki tingkat kerumitan tinggi","menuntut pendekatan analisis mendalam"],masalah:["permasalahan yang menjadi fokus","hambatan serta tantangan","fenomena problematik","isu utama yang menjadi perhatian","kendala yang dihadapi dalam penelitian","persoalan mendasar yang muncul","permasalahan konseptual yang terjadi","tantangan metodologis dalam kajian","isu krusial yang perlu dikaji","hambatan struktural yang ditemukan","masalah utama yang memerlukan solusi","fenomena kompleks yang dihadapi","persoalan akademik yang muncul","kendala signifikan dalam proses penelitian","isu strategis dalam kajian"],dampak:["implikasi langsung maupun tidak langsung","konsekuensi logis yang timbul","pengaruh signifikan yang dihasilkan","efek yang ditimbulkan terhadap","implikasi konseptual terhadap","konsekuensi empiris yang muncul","pengaruh sistemik yang terjadi","dampak berkelanjutan terhadap","implikasi jangka panjang terhadap","efek kumulatif yang dihasilkan","pengaruh signifikan dalam konteks","implikasi akademik yang ditimbulkan","konsekuensi strategis terhadap","pengaruh langsung terhadap variabel","dampak metodologis dalam penelitian"],meningkatkan:["mengoptimalisasi level","mengakselerasi pertumbuhan","meningkatkan kapasitas secara signifikan","memaksimalkan potensi dari","mendorong peningkatan kualitas","mengerek tingkat efisiensi","menambah nilai tambah pada","memperkuat aspek-aspek"],menurunkan:["meminimalisir tingkat","mereduksi potensi","menekan angka","mengurangi intensitas","menurunkan signifikansi","memitigasi risiko","memperkecil kemungkinan","mengeliminasi faktor"]},io={cara:["metode","mekanisme","teknik","pendekatan","strategi","prosedur","tata cara","pola pelaksanaan","skema","model operasional","kerangka kerja","sistem kerja","langkah-langkah"],bagian:["komponen","elemen","segmen","sektor","aspek","dimensi","unsur","subbagian","bagian integral","konstituen","parameter","variabel","unit"],alasan:["latar belakang","dasar pemikiran","argumentasi","premis","rasionalisasi","pertimbangan","justifikasi","fondasi konseptual","dasar argumentatif","motif","faktor pendorong","landasan teoritis"],tujuan:["objektif","sasaran","target","orientasi","intensi","arah pencapaian","maksud","cita-cita","tujuan akhir","goal","outcome yang diharapkan"],hasil:["temuan","luaran","output","resultan","konsekuensi","pencapaian","hasil akhir","capaian","produk penelitian","implikasi","respon"],alat:["instrumen","perangkat","sarana","fasilitas","media","alat bantu","tool","perlengkapan","sistem pendukung","perangkat operasional"],data:["informasi","fakta","statistik","evidensi","bukti empiris","dataset","rekaman data","temuan lapangan","hasil observasi","bahan empiris"],tempat:["lokasi","area","wilayah","zona","lingkungan","kawasan","setting","ruang","daerah penelitian","area kajian"],waktu:["periode","durasi","masa","kurun waktu","interval","rentang waktu","fase","tahapan waktu","jangka waktu","momentum"],orang:["individu","subjek","personel","sumber daya manusia","partisipan","responden","aktor","pelaku","pihak terkait"],kelompok:["golongan","kluster","kategori","komunitas","himpunan","kelompok sosial","unit kolektif","segmen populasi","kelompok sasaran"],beda:["berlainan","kontras","heterogen","bervariasi","divergen","tidak seragam","berbeda karakteristik","tidak identik","diskrepansi"],sama:["identik","serupa","homogen","ekuivalen","setara","sepadan","memiliki kesamaan","tidak berbeda","selaras"],melihat:["meninjau","mengobservasi","mengamati","menganalisis","memeriksa","mengkaji","menelaah","mengevaluasi","menginspeksi"],mencari:["menelusuri","mengeksplorasi","menginvestigasi","melacak","mengidentifikasi","menggali","menemukan","menyisir"],mendapatkan:["memperoleh","meraih","menghimpun","mengakuisisi","mengumpulkan","menyerap","mencapai","menghasilkan"],memberikan:["menyediakan","memfasilitasi","menawarkan","mendistribusikan","menyampaikan","mengalokasikan","menyalurkan","menyerahkan"],menunjukkan:["mengindikasikan","merefleksikan","memperlihatkan","mendemonstrasikan","menampilkan","menegaskan","menggambarkan"],tapi:["namun","akan tetapi","sedangkan","sebaliknya","meskipun demikian","walaupun demikian","kendati demikian"],dan:["serta","beserta","sekaligus","maupun","ditambah dengan","bersamaan dengan","serentak dengan"],karena:["disebabkan oleh","dikarenakan","berlandaskan pada","dipicu oleh","sebagai akibat dari","berpangkal pada","dipengaruhi oleh"],jadi:["maka dari itu","dengan demikian","akibatnya","oleh sebab itu","sehingga","berimplikasi pada","menghasilkan"],untuk:["guna","bagi","demi","dalam rangka","bertujuan untuk","sebagai upaya","diperuntukkan bagi"],banyak:["sejumlah besar","beragam","variatif","melimpah","kuantitas tinggi","majemuk","multi"],sedikit:["minim","terbatas","segelintir","kuantitas rendah","kurang memadai","minoritas"],besar:["signifikan","masif","luas","substansial","mayor","dominan","agung"],kecil:["minor","sempit","terbatas","mikro","tidak signifikan","marginal"]},so={menggunakan:"digunakan",melakukan:"dilakukan",membuat:"dibuat",menulis:"ditulis",membaca:"dibaca",mengambil:"diambil",menganalisis:"dianalisis",menerapkan:"diterapkan",meneliti:"diteliti",membahas:"dibahas",menjelaskan:"dijelaskan",mengukur:"diukur",menghitung:"dihitung",menemukan:"ditemukan",mengumpulkan:"dikumpulkan",mengolah:"diolah",menyajikan:"disajikan",merancang:"dirancang",memperbaiki:"diperbaiki",mempengaruhi:"dipengaruhi",menyebabkan:"disebabkan",mengembangkan:"dikembangkan",mengidentifikasi:"diidentifikasi",menentukan:"ditentukan",meningkatkan:"ditingkatkan",menurunkan:"diturunkan",menghasilkan:"dihasilkan",menggambarkan:"digambarkan",menyimpulkan:"disimpulkan",mendefinisikan:"didefinisikan",menginterpretasikan:"diinterpretasikan",mengevaluasi:"dievaluasi",menilai:"dinilai",mengamati:"diamati",meninjau:"ditinjau",mengkaji:"dikaji",menelaah:"ditelaah",mengobservasi:"diobservasi",mengonfirmasi:"dikonfirmasi",memverifikasi:"diverifikasi",mengvalidasi:"divalidasi",menguji:"diuji",mencatat:"dicatat",merumuskan:"dirumuskan"},oo=Object.entries(no).sort((t,e)=>e[0].length-t[0].length),lo=Object.entries(ro).sort((t,e)=>e[0].length-t[0].length),uo=Object.entries(ao).sort((t,e)=>e[0].length-t[0].length),co=Object.entries(io).sort((t,e)=>e[0].length-t[0].length),fo=Object.entries(so).sort((t,e)=>e[0].length-t[0].length),Ft=t=>t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),wr=t=>t[Math.floor(Math.random()*t.length)],Ot=(t,e)=>t.charAt(0)===t.charAt(0).toUpperCase()&&t.charAt(0).match(/[A-Z]/)?e.charAt(0).toUpperCase()+e.slice(1):e;function Zn(t,e="restructure"){if(!t)return"";let r=t;const l=to[e];for(const[d,o]of oo){const s=new RegExp(`\\b${Ft(d)}\\b`,"gi");r=r.replace(s,a=>Math.random()<l.ngramChance?Ot(a,wr(o)):a)}for(const[d,o]of lo){const s=new RegExp(`\\b${Ft(d)}\\b`,"gi");r=r.replace(s,a=>Ot(a,o))}for(const[d,o]of uo){const s=new RegExp(`\\b${Ft(d)}\\b`,"gi");r=r.replace(s,a=>Math.random()<l.expandChance?Ot(a,wr(o)):a)}for(const[d,o]of co){const s=new RegExp(`\\b${Ft(d)}\\b`,"gi");r=r.replace(s,a=>Math.random()<l.synonymChance?Ot(a,wr(o)):a)}for(const[d,o]of fo){const s=new RegExp(`\\b${Ft(d)}\\b`,"gi");r=r.replace(s,a=>Math.random()<l.passiveChance?Ot(a,o):a)}return r}const Yn=["Menganalisis pola kalimat...","Substitusi terminologi akademik...","Restrukturisasi sintaksis...","Menambah variasi kata penghubung...","Finalisasi naskah anti-plagiasi..."],ho=(t,e)=>{if(!t||!e)return null;const r=t.toLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"").split(/\s+/),l=e.toLowerCase().replace(/[.,/#!$%^&*;:{}=\-_`~()]/g,"").split(/\s+/),d=[],o=[],s=[],a=new Set(r),c=new Set(l);r.forEach(v=>{!c.has(v)&&v.length>2&&d.push(v)}),l.forEach(v=>{!a.has(v)&&v.length>2&&o.push(v)});const x=Math.min(d.length,o.length);for(let v=0;v<x;v++)s.push({from:d[v],to:o[v]});return{deleted:d.slice(x),added:o.slice(x),replaced:s}},po=({isOpen:t,onClose:e,onConfirm:r,metadata:l,sectionTitle:d,textScope:o})=>{const[s,a]=me.useState(!1),[c,x]=me.useState(""),[v,S]=me.useState(0),[T,w]=me.useState("restructure"),E=me.useRef(null);me.useEffect(()=>{t&&(x(""),a(!1),S(0),w("restructure"))},[t]),me.useEffect(()=>{let k;return s&&(S(0),k=setInterval(()=>{S(j=>(j+1)%Yn.length)},1500)),()=>clearInterval(k)},[s]);const y=async()=>{var k,j,O;if(o!=null&&o.text){a(!0),x(""),E.current=new AbortController;try{if(T==="creative"){const F=await li({tool:"paraphrase",text:o.text,metadata:l,sectionTitle:d,config:{instruction:"Ubah struktur kalimat secara signifikan (aktif/pasif), tambah kata penghubung, dan ganti kosa kata. TAPI JANGAN UBAH SITASI."}});for await(const G of F){if((k=E.current)!=null&&k.signal.aborted)break;G.text&&x(W=>W+G.text)}}else{if(await new Promise(G=>setTimeout(G,1500)),(j=E.current)!=null&&j.signal.aborted)return;let F=Zn(o.text,T);T==="restructure"&&(F=Zn(F,"minimal")),x(F)}}catch{(O=E.current)!=null&&O.signal.aborted||x("Terjadi kesalahan saat memproses. Silakan coba lagi.")}finally{a(!1),E.current=null}}},A=()=>{E.current&&E.current.abort(),a(!1)},p=me.useMemo(()=>ho((o==null?void 0:o.text)||"",c),[o,c]);return t?u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-md animate-fade-in",children:u.jsxs("div",{className:"bg-slate-950 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden border border-slate-800 flex flex-col max-h-[90vh]",children:[!s&&u.jsxs("div",{className:"bg-slate-900 border-b border-slate-800 p-4 shrink-0 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-slate-800 rounded-lg border border-slate-700",children:u.jsx(fn,{size:20,className:"text-purple-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-base text-white",children:"Auto Parafrase"}),u.jsx("p",{className:"text-[10px] text-slate-400",children:"Anti-Plagiasi Engine (Local & AI)"})]})]}),u.jsx("button",{onClick:e,className:"text-slate-500 hover:text-white transition-colors",children:u.jsx(it,{size:20})})]}),u.jsx("div",{className:`flex-1 overflow-y-auto ${s?"p-0 flex items-center justify-center":"p-6"} scroll-dark min-h-[400px]`,children:s?u.jsxs("div",{className:"flex flex-col items-center justify-center text-center space-y-8 p-10 w-full h-full bg-slate-950 relative overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 z-0",children:u.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-purple-600/10 rounded-full blur-[80px] animate-pulse"})}),u.jsxs("div",{className:"relative z-10 flex flex-col items-center animate-fade-in-up",children:[u.jsx("div",{className:"p-4 bg-slate-900/50 rounded-2xl border border-slate-800 shadow-xl mb-4",children:u.jsx(ht,{className:"w-16 h-16 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-white tracking-tight",children:"Skripsi Labs Engine"}),u.jsx("p",{className:"text-xs text-blue-300 uppercase tracking-[0.2em] font-medium mt-1",children:"Deep Paraphrasing..."})]}),u.jsxs("div",{className:"relative z-10 w-full max-w-sm",children:[u.jsxs("div",{className:"flex items-center justify-center gap-3 text-slate-300 mb-6",children:[u.jsx(Tn,{className:"animate-spin text-purple-500",size:24}),u.jsx("span",{className:"text-sm font-mono animate-pulse min-w-[200px] text-center",children:Yn[v]})]}),u.jsx("div",{className:"h-1 w-full bg-slate-900 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-purple-600 to-pink-600 w-1/2 animate-progress-indeterminate rounded-full"})})]}),u.jsx("button",{onClick:A,className:"relative z-10 px-6 py-2 rounded-full border border-slate-800 text-slate-500 text-xs hover:text-white hover:border-red-500/50 hover:bg-red-500/10 transition-colors mt-8",children:"Batalkan Proses"})]}):u.jsxs(u.Fragment,{children:[!c&&u.jsxs("div",{className:"space-y-6 animate-fade-in",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-2",children:[u.jsx(hi,{size:14})," Teks Asli"]}),u.jsx("div",{className:"bg-slate-900 p-3 rounded-lg border border-slate-800 text-xs text-slate-300 font-mono max-h-48 overflow-y-auto scroll-dark leading-relaxed no-scrollbar",children:o==null?void 0:o.text})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-bold text-slate-400 uppercase block mb-3",children:"Pilih Tingkat Perubahan"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[u.jsxs("button",{onClick:()=>w("minimal"),className:`p-3 rounded-xl border transition-all text-left group ${T==="minimal"?"bg-blue-600/10 border-blue-500/50 shadow-lg shadow-blue-500/10":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[u.jsx("div",{className:`mb-2 p-2 w-fit rounded-lg ${T==="minimal"?"bg-blue-500 text-white":"bg-slate-800 text-slate-400"}`,children:u.jsx(js,{size:16})}),u.jsx("div",{className:"font-bold text-sm text-white mb-1",children:"Cepat (Offline)"}),u.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:"Perbaikan ejaan, sinonim dasar, & kata baku."})]}),u.jsxs("button",{onClick:()=>w("restructure"),className:`p-3 rounded-xl border transition-all text-left group ${T==="restructure"?"bg-purple-600/10 border-purple-500/50 shadow-lg shadow-purple-500/10":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[u.jsx("div",{className:`mb-2 p-2 w-fit rounded-lg ${T==="restructure"?"bg-purple-500 text-white":"bg-slate-800 text-slate-400"}`,children:u.jsx(Us,{size:16})}),u.jsx("div",{className:"font-bold text-sm text-white mb-1",children:"Standar (Offline)"}),u.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:"Ubah struktur kalimat & frasa akademik."})]}),u.jsxs("button",{onClick:()=>w("creative"),className:`p-3 rounded-xl border transition-all text-left group ${T==="creative"?"bg-orange-600/10 border-orange-500/50 shadow-lg shadow-orange-500/10":"bg-slate-900 border-slate-800 hover:border-slate-700"}`,children:[u.jsx("div",{className:`mb-2 p-2 w-fit rounded-lg ${T==="creative"?"bg-orange-500 text-white":"bg-slate-800 text-slate-400"}`,children:u.jsx(Mt,{size:16})}),u.jsx("div",{className:"font-bold text-sm text-white mb-1",children:"Mendalam (AI)"}),u.jsx("div",{className:"text-[10px] text-slate-400 leading-tight",children:"Perombakan total (Tambah/Hapus/Ubah) Anti-Turnitin."})]})]})]})]}),c&&u.jsxs("div",{className:"h-full flex flex-col gap-6 animate-fade-in relative",children:[u.jsxs("div",{className:"relative flex-1 space-y-2",children:[u.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Hasil Parafrase"}),u.jsx("textarea",{value:c,onChange:k=>x(k.target.value),className:"w-full h-40 bg-slate-900 border border-slate-800 rounded-xl p-4 text-sm leading-relaxed text-slate-200 outline-none focus:border-purple-500/50 resize-none font-academic no-scrollbar"})]}),p&&u.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden",children:[u.jsxs("div",{className:"bg-slate-800/50 px-4 py-2 border-b border-slate-800 flex items-center gap-2",children:[u.jsx(fn,{size:14,className:"text-purple-400"}),u.jsx("h4",{className:"text-xs font-bold text-slate-300 uppercase tracking-wide",children:"Analisis Perubahan"})]}),u.jsxs("div",{className:"p-4 grid grid-cols-1 md:grid-cols-3 gap-4 text-xs",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("div",{className:"flex items-center gap-2 text-red-400 font-bold mb-1",children:[u.jsx(Sn,{size:12})," Dihapus"]}),u.jsx("div",{className:"flex flex-wrap gap-1.5",children:p.deleted.slice(0,8).map((k,j)=>u.jsx("span",{className:"bg-red-900/20 text-red-300 px-1.5 py-0.5 rounded border border-red-500/10 line-through decoration-red-500/50",children:k},j))})]}),u.jsxs("div",{className:"space-y-2 border-t md:border-t-0 md:border-l border-slate-800 pt-4 md:pt-0 md:pl-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-blue-400 font-bold mb-1",children:[u.jsx(xs,{size:12})," Diganti"]}),u.jsx("div",{className:"space-y-1",children:p.replaced.slice(0,4).map((k,j)=>u.jsxs("div",{className:"flex items-center gap-1.5 opacity-80",children:[u.jsx("span",{className:"text-red-300 line-through decoration-red-500/30",children:k.from}),u.jsx(fi,{size:10,className:"text-slate-500"}),u.jsx("span",{className:"text-blue-300 font-medium",children:k.to})]},j))})]}),u.jsxs("div",{className:"space-y-2 border-t md:border-t-0 md:border-l border-slate-800 pt-4 md:pt-0 md:pl-4",children:[u.jsxs("div",{className:"flex items-center gap-2 text-green-400 font-bold mb-1",children:[u.jsx(Ls,{size:12})," Ditambahkan"]}),u.jsx("div",{className:"flex flex-wrap gap-1.5",children:p.added.slice(0,8).map((k,j)=>u.jsx("span",{className:"bg-green-900/20 text-green-300 px-1.5 py-0.5 rounded border border-green-500/10",children:k},j))})]})]})]})]})]})}),!s&&u.jsx("div",{className:"p-4 border-t border-slate-800 bg-slate-900 flex justify-end items-center gap-3 shrink-0",children:c?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>x(""),className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Ulangi"}),u.jsxs("button",{onClick:()=>r(c),className:"px-6 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-green-900/20 flex items-center gap-2",children:[u.jsx(bt,{size:16})," Terapkan Hasil"]})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:e,className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Batal"}),u.jsxs("button",{onClick:y,className:"px-6 py-2.5 bg-purple-600 hover:bg-purple-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-purple-900/20 flex items-center gap-2 group",children:[u.jsx(Mt,{size:14,className:"group-hover:animate-pulse"})," Mulai Proses"]})]})})]})}):null},Jn=["Memindai kesalahan ejaan ...","Memvalidasi aturan PUEBI ...","Memperbaiki tanda baca & kapitalisasi ...","Mengecek koherensi kalimat ...","Finalisasi koreksi ..."],mo=({isOpen:t,onClose:e,onConfirm:r,metadata:l,sectionTitle:d,textScope:o})=>{const[s,a]=me.useState(""),[c,x]=me.useState(!1),[v,S]=me.useState(""),[T,w]=me.useState(0),E=me.useRef(null);me.useEffect(()=>{t&&(a(""),S(""),x(!1),w(0))},[t]),me.useEffect(()=>{let p;return c&&(w(0),p=setInterval(()=>{w(k=>(k+1)%Jn.length)},2e3)),()=>clearInterval(p)},[c]);const y=async()=>{var p,k;if(o!=null&&o.text){x(!0),S(""),E.current=new AbortController;try{const j={instruction:s},O=await li({tool:"fix",text:o.text,metadata:l,sectionTitle:d,config:j});for await(const F of O){if((p=E.current)!=null&&p.signal.aborted)break;F.text&&S(G=>G+F.text)}}catch{(k=E.current)!=null&&k.signal.aborted||S("Terjadi kesalahan saat memproses. Silakan coba lagi.")}finally{x(!1),E.current=null}}},A=()=>{E.current&&E.current.abort(),x(!1)};return t?u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-md animate-fade-in",children:u.jsxs("div",{className:"bg-slate-950 rounded-2xl shadow-2xl w-full max-w-2xl overflow-hidden border border-slate-800 flex flex-col max-h-[90vh]",children:[!c&&u.jsxs("div",{className:"bg-slate-900 border-b border-slate-800 p-4 shrink-0 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-slate-800 rounded-lg border border-slate-700",children:u.jsx(bt,{size:20,className:"text-orange-400"})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-base text-white",children:"Koreksi Ejaan"}),u.jsx("p",{className:"text-[10px] text-slate-400",children:"Perbaikan Typo & PUEBI"})]})]}),u.jsx("button",{onClick:e,className:"text-slate-500 hover:text-white transition-colors",children:u.jsx(it,{size:20})})]}),u.jsx("div",{className:`flex-1 overflow-y-auto ${c?"p-0 flex items-center justify-center":"p-6"} scroll-dark min-h-[400px]`,children:c?u.jsxs("div",{className:"flex flex-col items-center justify-center text-center space-y-8 p-10 w-full h-full bg-slate-950 relative overflow-hidden",children:[u.jsx("div",{className:"absolute inset-0 z-0",children:u.jsx("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-64 h-64 bg-orange-600/10 rounded-full blur-[80px] animate-pulse"})}),u.jsxs("div",{className:"relative z-10 flex flex-col items-center animate-fade-in-up",children:[u.jsx("div",{className:"p-4 bg-slate-900/50 rounded-2xl border border-slate-800 shadow-xl mb-4",children:u.jsx(ht,{className:"w-16 h-16 text-white"})}),u.jsx("h2",{className:"text-2xl font-bold text-white tracking-tight",children:"Skripsi Labs"}),u.jsx("p",{className:"text-xs text-blue-300 uppercase tracking-[0.2em] font-medium mt-1",children:"Artificial Intellegent Laboratoriums"})]}),u.jsxs("div",{className:"relative z-10 w-full max-w-sm",children:[u.jsxs("div",{className:"flex items-center justify-center gap-3 text-slate-300 mb-6",children:[u.jsx(Tn,{className:"animate-spin text-orange-500",size:24}),u.jsx("span",{className:"text-sm font-mono animate-pulse min-w-[200px] text-center",children:Jn[T]})]}),u.jsx("div",{className:"h-1 w-full bg-slate-900 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-orange-600 to-yellow-600 w-1/2 animate-progress-indeterminate rounded-full"})})]}),u.jsx("button",{onClick:A,className:"relative z-10 px-6 py-2 rounded-full border border-slate-800 text-slate-500 text-xs hover:text-white hover:border-red-500/50 hover:bg-red-500/10 transition-colors mt-8",children:"Batalkan Proses"})]}):u.jsxs(u.Fragment,{children:[!v&&u.jsxs("div",{className:"space-y-6 animate-fade-in",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase flex items-center gap-2",children:[u.jsx(hi,{size:14})," Teks Asli"]}),u.jsx("div",{className:"bg-slate-900 p-3 rounded-lg border border-slate-800 text-xs text-slate-300 font-mono max-h-32 overflow-y-auto scroll-dark leading-relaxed no-scrollbar",children:o==null?void 0:o.text})]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("label",{className:"text-xs font-bold text-slate-400 uppercase block flex items-center gap-2",children:[u.jsx(mi,{size:14})," Instruksi Khusus (Opsional)"]}),u.jsx("textarea",{rows:3,placeholder:"Contoh: Perhatikan penggunaan huruf miring pada istilah asing...",value:s,onChange:p=>a(p.target.value),className:"w-full p-3 bg-slate-900 border border-slate-800 rounded-xl text-sm text-white focus:ring-1 focus:ring-orange-500 focus:border-orange-500 outline-none resize-none placeholder:text-slate-600"})]})]}),v&&u.jsxs("div",{className:"h-full flex flex-col gap-6 animate-fade-in relative",children:[u.jsxs("div",{className:"relative flex-1 space-y-2",children:[u.jsx("label",{className:"text-[10px] font-bold text-slate-500 uppercase tracking-wider",children:"Hasil Koreksi"}),u.jsx("textarea",{value:v,onChange:p=>S(p.target.value),className:"w-full h-64 bg-slate-900 border border-slate-800 rounded-xl p-4 text-sm leading-relaxed text-slate-200 outline-none focus:border-orange-500/50 resize-none font-academic no-scrollbar"})]}),u.jsxs("div",{className:"bg-slate-900 rounded-xl border border-slate-800 overflow-hidden",children:[u.jsxs("div",{className:"bg-slate-800/50 px-4 py-2 border-b border-slate-800 flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(bt,{size:14,className:"text-orange-400"}),u.jsx("h4",{className:"text-xs font-bold text-slate-300 uppercase tracking-wide",children:"Status"})]}),u.jsxs("div",{className:"flex items-center gap-1 text-[10px] text-green-400 bg-green-400/10 px-2 py-0.5 rounded-full border border-green-400/20",children:[u.jsx(Cs,{size:10})," Verified"]})]}),u.jsx("div",{className:"p-4 text-xs text-slate-400 leading-relaxed text-center",children:"Teks telah diperiksa. Pastikan makna kalimat tidak berubah sebelum menerapkan."})]})]})]})}),!c&&u.jsx("div",{className:"p-4 border-t border-slate-800 bg-slate-900 flex justify-end items-center gap-3 shrink-0",children:v?u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>S(""),className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Ulangi"}),u.jsxs("button",{onClick:()=>r(v),className:"px-6 py-2.5 bg-green-600 hover:bg-green-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-green-900/20 flex items-center gap-2",children:[u.jsx(bt,{size:16})," Terapkan Hasil"]})]}):u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:e,className:"px-4 py-2.5 text-slate-400 hover:text-white hover:bg-slate-800 rounded-xl text-xs font-bold transition-colors",children:"Batal"}),u.jsxs("button",{onClick:y,className:"px-6 py-2.5 bg-orange-600 hover:bg-orange-500 text-white rounded-xl text-xs font-bold shadow-lg shadow-orange-900/20 flex items-center gap-2 group",children:[u.jsx(Mt,{size:14,className:"group-hover:animate-pulse"})," Mulai Koreksi"]})]})})]})}):null},Qn=["Menginisialisasi mesin deteksi...","Memindai database jurnal terbuka...","Menganalisis pola N-Gram...","Mengecek struktur kalimat AI...","Menghitung skor similaritas..."],go=({isOpen:t,onClose:e,textScope:r})=>{const[l,d]=me.useState("confirm"),[o,s]=me.useState(0),[a,c]=me.useState(0),[x,v]=me.useState(0),[S,T]=me.useState(""),[w,E]=me.useState(""),[y,A]=me.useState(""),[p,k]=me.useState(""),j=me.useRef(null);me.useEffect(()=>{t&&(d("confirm"),s(0),c(0),k(""),v(0),T(""),E(""),A(""))},[t]),me.useEffect(()=>{if(l==="result"&&p)try{const G=p.match(/SCORE:\s*(\d+)/i);G&&v(parseInt(G[1]));const W=p.match(/RISK:\s*([^\n]+)/i);W&&T(W[1].trim());const $=p.match(/ANALYSIS:([\s\S]*?)RECOMMENDATION:/i);$&&E($[1].trim());const N=p.match(/RECOMMENDATION:([\s\S]*)/i);N&&A(N[1].trim())}catch(G){console.error("Failed to parse plagiarism result",G)}},[p,l]);const O=async()=>{var $;if(!(r!=null&&r.text))return;d("scanning"),s(0);const G=setInterval(()=>{c(N=>(N+1)%Qn.length)},1500),W=setInterval(()=>{s(N=>N>=95?N:N+Math.random()*5)},300);j.current=new AbortController;try{const N=await ys({text:r.text});let ne="";for await(const se of N){if(($=j.current)!=null&&$.signal.aborted)break;se.text&&(ne+=se.text)}k(ne),clearInterval(G),clearInterval(W),s(100),setTimeout(()=>{d("result")},800)}catch{clearInterval(G),clearInterval(W),alert("Gagal melakukan pengecekan. Coba lagi."),d("confirm")}};if(!t)return null;const F=G=>G<25?"text-green-500 border-green-500":G<50?"text-yellow-500 border-yellow-500":"text-red-500 border-red-500";return u.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-slate-900/80 backdrop-blur-md animate-fade-in",children:u.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-full max-w-2xl overflow-hidden flex flex-col max-h-[90vh] relative",children:[u.jsx("button",{onClick:e,className:"absolute top-4 right-4 p-2 bg-slate-100 hover:bg-slate-200 rounded-full transition-colors z-20",children:u.jsx(it,{size:20,className:"text-slate-500"})}),l==="confirm"&&u.jsxs("div",{className:"p-8 flex flex-col items-center text-center space-y-6 animate-scale-in",children:[u.jsx("div",{className:"w-20 h-20 bg-blue-50 rounded-full flex items-center justify-center mb-2",children:u.jsx(Vs,{size:40,className:"text-blue-600"})}),u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Simulasi Pengecekan Plagiasi"}),u.jsxs("p",{className:"text-slate-500 text-sm max-w-md mx-auto leading-relaxed",children:["AI akan menganalisis teks Anda untuk mencari indikasi kemiripan dengan pola umum di internet dan database akademik.",u.jsx("br",{}),u.jsx("br",{}),u.jsx("span",{className:"bg-yellow-50 text-yellow-700 px-2 py-1 rounded border border-yellow-200 text-xs font-bold",children:"Disclaimer: Hasil ini adalah estimasi AI, bukan laporan resmi Turnitin."})]})]}),u.jsxs("div",{className:"w-full bg-slate-50 p-4 rounded-xl border border-slate-200 text-left",children:[u.jsxs("div",{className:"flex items-center gap-2 mb-2 text-xs font-bold text-slate-400 uppercase",children:[u.jsx(ar,{size:14})," Teks yang akan dicek"]}),u.jsx("p",{className:"text-xs text-slate-600 font-mono line-clamp-4 leading-relaxed",children:r==null?void 0:r.text})]}),u.jsxs("button",{onClick:O,className:"w-full py-4 bg-[#0A1A2E] hover:bg-slate-800 text-white rounded-xl font-bold flex items-center justify-center gap-2 transition-all shadow-lg hover:shadow-xl active:scale-[0.98]",children:[u.jsx($n,{size:20})," Mulai Pengecekan"]})]}),l==="scanning"&&u.jsxs("div",{className:"p-12 flex flex-col items-center justify-center text-center space-y-8 h-[500px]",children:[u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-0 bg-blue-500/20 rounded-full animate-ping blur-xl"}),u.jsx("div",{className:"relative z-10 w-24 h-24 bg-white rounded-full flex items-center justify-center shadow-2xl border-4 border-blue-50",children:u.jsx(ht,{className:"w-12 h-12 text-blue-600 animate-pulse"})})]}),u.jsxs("div",{className:"space-y-2 w-full max-w-xs",children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800 animate-pulse",children:Qn[a]}),u.jsx("div",{className:"h-2 w-full bg-slate-100 rounded-full overflow-hidden",children:u.jsx("div",{className:"h-full bg-gradient-to-r from-blue-500 to-cyan-400 transition-all duration-300 ease-out",style:{width:`${o}%`}})}),u.jsxs("p",{className:"text-xs text-slate-400 font-mono",children:[Math.round(o),"%"]})]})]}),l==="result"&&u.jsxs("div",{className:"flex flex-col h-full animate-fade-in",children:[u.jsxs("div",{className:"p-6 bg-slate-50 border-b border-slate-200 flex items-center gap-6",children:[u.jsxs("div",{className:`w-24 h-24 rounded-full border-[6px] flex flex-col items-center justify-center bg-white shadow-sm ${F(x)}`,children:[u.jsxs("span",{className:"text-2xl font-bold",children:[x,"%"]}),u.jsx("span",{className:"text-[9px] uppercase font-bold text-slate-400",children:"Similarity"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-bold text-slate-800",children:"Laporan Analisis"}),u.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold border mt-1 ${S==="Low"?"bg-green-100 text-green-700 border-green-200":S==="Medium"?"bg-yellow-100 text-yellow-700 border-yellow-200":"bg-red-100 text-red-700 border-red-200"}`,children:[S==="Low"?u.jsx(di,{size:14}):u.jsx(Rs,{size:14}),"Risk Level: ",S||"Unknown"]})]})]}),u.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6 scroll-light",children:[u.jsxs("div",{className:"space-y-2",children:[u.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[u.jsx($n,{size:16,className:"text-blue-500"})," Dasar Penilaian"]}),u.jsx("div",{className:"bg-blue-50/50 p-4 rounded-xl border border-blue-100 text-sm text-slate-700 leading-relaxed whitespace-pre-wrap",children:w||"Tidak ada analisis detail."})]}),u.jsxs("div",{className:"space-y-2",children:[u.jsxs("h4",{className:"text-sm font-bold text-slate-700 flex items-center gap-2",children:[u.jsx(ci,{size:16,className:"text-purple-500"})," Rekomendasi Solusi"]}),u.jsx("div",{className:"bg-purple-50/50 p-4 rounded-xl border border-purple-100 text-sm text-slate-700 leading-relaxed whitespace-pre-wrap",children:y||"Tidak ada rekomendasi spesifik."})]})]}),u.jsx("div",{className:"p-4 border-t border-slate-200 bg-white shrink-0 flex justify-end",children:u.jsxs("button",{onClick:e,className:"px-6 py-2.5 bg-slate-900 text-white rounded-xl text-sm font-bold hover:bg-slate-800 transition-colors flex items-center gap-2",children:["Selesai ",u.jsx(fi,{size:16})]})})]})]})})},br={authors:"",year:"",title:"",source:"",details:"",type:"journal"},wo=({bibliography:t,setBibliography:e,onClose:r,onDragStartAction:l,currentContent:d=""})=>{const[o,s]=me.useState("current"),[a,c]=me.useState(!1),[x,v]=me.useState(br),S=F=>{v({...x,[F.target.name]:F.target.value})},T=()=>{const{authors:F,year:G,title:W,source:$,details:N,type:ne}=x;if(!F||!G||!W)return"";let se=`${F} (${G}). `;return ne==="journal"?(se+=`${W}. ${$}`,N&&(se+=`, ${N}`)):ne==="book"?se+=`${W}. ${$}`:se+=`${W}. ${$}. ${N}`,se.endsWith("..")&&(se=se.slice(0,-1)),se.endsWith(".")||(se+="."),se},w=()=>{const F=T();if(F){const G=[...t,F].sort();e(G),v(br),c(!1)}else alert("Mohon lengkapi minimal Penulis, Tahun, dan Judul.")},E=F=>{if(confirm("Hapus referensi ini?")){const G=t.filter((W,$)=>$!==F);e(G)}},y=F=>{navigator.clipboard.writeText(F),alert("Disalin!")},A=()=>{t.length!==0&&(navigator.clipboard.writeText(t.join(`

`)),alert("Semua referensi disalin!"))},p=F=>{try{const G=F.match(/\((\d{4}[a-z]?)\)/),W=G?G[1]:"n.d.",N=F.split(G?G[0]:"(")[0].trim(),ne=N.split(",")[0].trim();if(N.includes("&")||N.toLowerCase().includes(" dan ")){const se=N.split("&").map(B=>B.trim().split(",")[0]);if(se.length===2)return`(${se[0]} & ${se[1]}, ${W})`}return(N.match(/,/g)||[]).length>2?`(${ne} et al., ${W})`:`(${ne}, ${W})`}catch{return"(Sumber, Tahun)"}},k=(F,G)=>{const W=p(G);F.dataTransfer.setData("text/plain",W),F.dataTransfer.effectAllowed="copy";const $=document.createElement("div");$.innerText=W,$.style.background="white",$.style.padding="5px",$.style.border="1px solid #3EC1FF",$.style.color="#0A1A2E",$.style.borderRadius="4px",$.style.position="absolute",$.style.top="-1000px",$.style.fontWeight="bold",document.body.appendChild($),F.dataTransfer.setDragImage($,0,0),l?setTimeout(()=>{l(),document.body.removeChild($)},10):setTimeout(()=>document.body.removeChild($),0)},O=o==="all"?t:t.filter(F=>{const G=p(F),$=G.replace(/[()]/g,"").split(",")[0];return d.includes(G)||d.includes($)});return u.jsxs("div",{className:"flex flex-col h-full bg-slate-50 relative animate-fade-in",children:[u.jsxs("div",{className:"p-4 bg-white border-b border-slate-200 flex flex-col gap-3 shrink-0 shadow-sm z-20",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(hn,{size:18,className:"text-[#3EC1FF]"}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-[#0A1A2E] text-sm",children:"Daftar Pustaka"}),u.jsx("p",{className:"text-[10px] text-slate-400",children:"Drag ke editor untuk sitasi (APA 7)"})]})]}),r&&u.jsx("button",{onClick:r,className:"p-1 rounded hover:bg-slate-100 text-slate-400",children:u.jsx(it,{size:18})})]}),u.jsxs("div",{className:"flex bg-slate-100 p-1 rounded-lg",children:[u.jsxs("button",{onClick:()=>s("current"),className:`flex-1 py-1.5 text-xs font-bold rounded-md flex items-center justify-center gap-1.5 transition-all ${o==="current"?"bg-[#3EC1FF] text-white shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[u.jsx(ar,{size:12})," Halaman Ini"]}),u.jsxs("button",{onClick:()=>s("all"),className:`flex-1 py-1.5 text-xs font-bold rounded-md flex items-center justify-center gap-1.5 transition-all ${o==="all"?"bg-[#3EC1FF] text-white shadow-sm":"text-slate-500 hover:text-slate-700"}`,children:[u.jsx(Is,{size:12})," Semua"]})]})]}),u.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 scroll-light relative z-10",children:O.length===0?u.jsx("div",{className:"text-center py-10 text-slate-400 text-xs italic",children:o==="current"?"Tidak ada referensi yang terdeteksi di halaman ini.":"Belum ada referensi tersimpan."}):O.map((F,G)=>u.jsxs("div",{draggable:!0,onDragStart:W=>k(W,F),className:"bg-white p-3 rounded-xl border border-slate-200 shadow-sm hover:shadow-md hover:border-[#3EC1FF] transition-all group relative cursor-grab active:cursor-grabbing flex gap-2",children:[u.jsx("div",{className:"shrink-0 flex items-start pt-1 text-slate-300 group-hover:text-[#3EC1FF]",children:u.jsx(vs,{size:14})}),u.jsx("div",{className:"flex-1 min-w-0",children:u.jsx("p",{className:"text-xs text-[#0A1A2E] leading-relaxed font-academic break-words",children:F})}),u.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 backdrop-blur-sm rounded-lg p-1 shadow-sm border border-slate-100",children:[u.jsx("button",{onClick:()=>y(F),className:"p-1 hover:bg-blue-50 text-slate-400 hover:text-[#3EC1FF] rounded",title:"Salin",children:u.jsx(pn,{size:12})}),u.jsx("button",{onClick:()=>E(t.indexOf(F)),className:"p-1 hover:bg-red-50 text-slate-400 hover:text-red-600 rounded",title:"Hapus",children:u.jsx(Sn,{size:12})})]})]},G))}),u.jsx("div",{className:"bg-white border-t border-slate-200 shrink-0 transition-all duration-300 shadow-[0_-5px_15px_rgba(0,0,0,0.05)] z-20 h-auto",children:a?u.jsxs("div",{className:"flex flex-col h-auto max-h-[350px]",children:[u.jsxs("div",{className:"p-3 bg-slate-100 border-b border-slate-200 flex justify-between items-center",children:[u.jsx("span",{className:"text-xs font-bold text-slate-600",children:"Input Data Referensi (APA 7)"}),u.jsx("button",{onClick:()=>c(!1),className:"p-1 text-slate-400 hover:text-slate-700 bg-white rounded-md border border-slate-200",children:u.jsx(Fs,{size:14})})]}),u.jsxs("div",{className:"p-4 space-y-3 overflow-y-auto scroll-light",children:[u.jsxs("div",{className:"flex gap-2",children:[u.jsxs("select",{name:"type",value:x.type,onChange:S,className:"w-1/3 p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs font-bold outline-none focus:border-[#3EC1FF]",children:[u.jsx("option",{value:"journal",children:"Jurnal"}),u.jsx("option",{value:"book",children:"Buku"}),u.jsx("option",{value:"web",children:"Website"})]}),u.jsx("input",{name:"year",value:x.year,onChange:S,placeholder:"Tahun (Contoh: 2023)",className:"w-2/3 p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-[#3EC1FF]"})]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx("input",{name:"authors",value:x.authors,onChange:S,placeholder:"Penulis (Format: Santoso, B. A.)",className:"w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-[#3EC1FF]"}),u.jsx("p",{className:"text-[9px] text-slate-400 italic px-1",children:"Gunakan koma untuk pemisah jika banyak. Contoh: Santoso, B., & Wijaya, A."})]}),u.jsx("input",{name:"title",value:x.title,onChange:S,placeholder:"Judul Artikel / Buku / Halaman Web",className:"w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-[#3EC1FF]"}),u.jsx("input",{name:"source",value:x.source,onChange:S,placeholder:x.type==="journal"?"Nama Jurnal":x.type==="book"?"Penerbit":"Nama Website",className:"w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-[#3EC1FF]"}),u.jsx("input",{name:"details",value:x.details,onChange:S,placeholder:x.type==="journal"?"Vol(No), Halaman (Opsional)":x.type==="web"?"URL Lengkap":"Kota Terbit (Opsional)",className:"w-full p-2 bg-slate-50 border border-slate-200 rounded-lg text-xs outline-none focus:border-[#3EC1FF]"})]}),u.jsxs("div",{className:"p-3 border-t border-slate-200 bg-slate-50 flex gap-2",children:[u.jsx("button",{onClick:()=>v(br),className:"p-2 text-slate-500 hover:text-slate-700 bg-white border border-slate-200 rounded-lg",title:"Reset Form",children:u.jsx(Es,{size:16})}),u.jsxs("button",{onClick:w,className:"flex-1 bg-[#3EC1FF] hover:bg-[#32a6db] text-white py-2 rounded-lg text-xs font-bold flex items-center justify-center gap-2 shadow-sm transition-all",children:[u.jsx(Os,{size:14})," Simpan ke Daftar"]})]})]}):u.jsxs("div",{className:"p-4 space-y-3",children:[u.jsxs("button",{onClick:()=>c(!0),className:"w-full bg-[#0A1A2E] hover:bg-[#0A1A2E]/90 text-white py-2.5 rounded-xl text-xs font-bold flex items-center justify-center gap-2 transition-all shadow-sm group",children:[u.jsx(En,{size:14,className:"group-hover:rotate-90 transition-transform"})," Tambah Referensi Manual"]}),u.jsxs("button",{onClick:A,disabled:t.length===0,className:"w-full bg-slate-100 hover:bg-slate-200 text-slate-600 py-2.5 rounded-xl text-xs font-bold flex items-center justify-center gap-2 disabled:opacity-50 transition-colors border border-slate-200",children:[u.jsx(pn,{size:14})," Salin Semua Referensi"]})]})})]})},bo=({isVisible:t,onCancel:e})=>t?u.jsxs("div",{className:"fixed inset-0 z-[70] flex flex-col items-center justify-center bg-[#0A1A2E]/90 backdrop-blur-md animate-fade-in transition-all",children:[u.jsxs("div",{className:"relative mb-8",children:[u.jsx("div",{className:"absolute inset-0 bg-[#3EC1FF]/20 rounded-full animate-ping blur-xl"}),u.jsx("div",{className:"absolute inset-0 bg-purple-500/10 rounded-full animate-pulse delay-75 blur-lg"}),u.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-4",children:[u.jsx(ht,{className:"w-20 h-20 text-[#3EC1FF] animate-pulse"}),u.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[u.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.3s]"}),u.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce [animation-delay:-0.15s]"}),u.jsx("div",{className:"w-2 h-2 bg-white rounded-full animate-bounce"})]})]})]}),u.jsxs("div",{className:"text-center space-y-2 mb-8",children:[u.jsx("h3",{className:"text-2xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-blue-200 via-white to-blue-200 animate-shimmer",children:"Sedang Menulis..."}),u.jsx("p",{className:"text-slate-400 text-sm animate-pulse",children:"Menganalisis konteks, menyusun argumen, dan merangkai kata."})]}),e&&u.jsxs("button",{onClick:e,className:"group flex items-center gap-2 px-5 py-2.5 rounded-full bg-slate-900 border border-slate-800 text-slate-400 hover:text-white hover:border-red-500/50 hover:bg-red-950/30 transition-all text-sm font-medium",children:[u.jsx(Ds,{size:16,className:"group-hover:text-red-500 transition-colors"}),"Batalkan"]})]}):null;var yo=Object.defineProperty,xo=Object.defineProperties,vo=Object.getOwnPropertyDescriptors,ea=Object.getOwnPropertySymbols,ko=Object.prototype.hasOwnProperty,_o=Object.prototype.propertyIsEnumerable,mn=(t,e,r)=>e in t?yo(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,Ee=(t,e)=>{for(var r in e||(e={}))ko.call(e,r)&&mn(t,r,e[r]);if(ea)for(var r of ea(e))_o.call(e,r)&&mn(t,r,e[r]);return t},zt=(t,e)=>xo(t,vo(e)),ie=(t,e,r)=>(mn(t,typeof e!="symbol"?e+"":e,r),r),Kt=(t,e,r)=>new Promise((l,d)=>{var o=c=>{try{a(r.next(c))}catch(x){d(x)}},s=c=>{try{a(r.throw(c))}catch(x){d(x)}},a=c=>c.done?l(c.value):Promise.resolve(c.value).then(o,s);a((r=r.apply(t,e)).next())});class ir{constructor(e){ie(this,"rootKey"),this.rootKey=e}}const Eo=Object.seal({});class oe extends ir{constructor(e){super(e),ie(this,"root"),this.root=new Array}prepForXml(e){var r;e.stack.push(this);const l=this.root.map(d=>d instanceof ir?d.prepForXml(e):d).filter(d=>d!==void 0);return e.stack.pop(),{[this.rootKey]:l.length?l.length===1&&((r=l[0])!=null&&r._attr)?l[0]:l:Eo}}addChildElement(e){return this.root.push(e),this}}class ur extends oe{prepForXml(e){const r=super.prepForXml(e);if(r&&(typeof r[this.rootKey]!="object"||Object.keys(r[this.rootKey]).length))return r}}class xe extends ir{constructor(e){super("_attr"),ie(this,"xmlKeys"),this.root=e}prepForXml(e){const r={};return Object.keys(this.root).forEach(l=>{const d=this.root[l];if(d!==void 0){const o=this.xmlKeys&&this.xmlKeys[l]||l;r[o]=d}}),{_attr:r}}}class Wt extends ir{constructor(e){super("_attr"),this.root=e}prepForXml(e){return{_attr:Object.values(this.root).filter(({value:l})=>l!==void 0).reduce((l,{key:d,value:o})=>zt(Ee({},l),{[d]:o}),{})}}}class Fe extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val",color:"w:color",fill:"w:fill",space:"w:space",sz:"w:sz",type:"w:type",rsidR:"w:rsidR",rsidRPr:"w:rsidRPr",rsidSect:"w:rsidSect",w:"w:w",h:"w:h",top:"w:top",right:"w:right",bottom:"w:bottom",left:"w:left",header:"w:header",footer:"w:footer",gutter:"w:gutter",linePitch:"w:linePitch",pos:"w:pos"})}}var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bi(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var yi={},An={exports:{}},yt=typeof Reflect=="object"?Reflect:null,ta=yt&&typeof yt.apply=="function"?yt.apply:function(e,r,l){return Function.prototype.apply.call(e,r,l)},tr;yt&&typeof yt.ownKeys=="function"?tr=yt.ownKeys:Object.getOwnPropertySymbols?tr=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:tr=function(e){return Object.getOwnPropertyNames(e)};function So(t){console&&console.warn&&console.warn(t)}var xi=Number.isNaN||function(e){return e!==e};function Te(){Te.init.call(this)}An.exports=Te;An.exports.once=jo;Te.EventEmitter=Te;Te.prototype._events=void 0;Te.prototype._eventsCount=0;Te.prototype._maxListeners=void 0;var ra=10;function cr(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Te,"defaultMaxListeners",{enumerable:!0,get:function(){return ra},set:function(t){if(typeof t!="number"||t<0||xi(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");ra=t}});Te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Te.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||xi(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function vi(t){return t._maxListeners===void 0?Te.defaultMaxListeners:t._maxListeners}Te.prototype.getMaxListeners=function(){return vi(this)};Te.prototype.emit=function(e){for(var r=[],l=1;l<arguments.length;l++)r.push(arguments[l]);var d=e==="error",o=this._events;if(o!==void 0)d=d&&o.error===void 0;else if(!d)return!1;if(d){var s;if(r.length>0&&(s=r[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")ta(c,this,r);else for(var x=c.length,v=Ti(c,x),l=0;l<x;++l)ta(v[l],this,r);return!0};function ki(t,e,r,l){var d,o,s;if(cr(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),s===void 0)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=l?[r,s]:[s,r]:l?s.unshift(r):s.push(r),d=vi(t),d>0&&s.length>d&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,So(a)}return t}Te.prototype.addListener=function(e,r){return ki(this,e,r,!1)};Te.prototype.on=Te.prototype.addListener;Te.prototype.prependListener=function(e,r){return ki(this,e,r,!0)};function To(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _i(t,e,r){var l={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},d=To.bind(l);return d.listener=r,l.wrapFn=d,d}Te.prototype.once=function(e,r){return cr(r),this.on(e,_i(this,e,r)),this};Te.prototype.prependOnceListener=function(e,r){return cr(r),this.prependListener(e,_i(this,e,r)),this};Te.prototype.removeListener=function(e,r){var l,d,o,s,a;if(cr(r),d=this._events,d===void 0)return this;if(l=d[e],l===void 0)return this;if(l===r||l.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete d[e],d.removeListener&&this.emit("removeListener",e,l.listener||r));else if(typeof l!="function"){for(o=-1,s=l.length-1;s>=0;s--)if(l[s]===r||l[s].listener===r){a=l[s].listener,o=s;break}if(o<0)return this;o===0?l.shift():Ao(l,o),l.length===1&&(d[e]=l[0]),d.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};Te.prototype.off=Te.prototype.removeListener;Te.prototype.removeAllListeners=function(e){var r,l,d;if(l=this._events,l===void 0)return this;if(l.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):l[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete l[e]),this;if(arguments.length===0){var o=Object.keys(l),s;for(d=0;d<o.length;++d)s=o[d],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=l[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(d=r.length-1;d>=0;d--)this.removeListener(e,r[d]);return this};function Ei(t,e,r){var l=t._events;if(l===void 0)return[];var d=l[e];return d===void 0?[]:typeof d=="function"?r?[d.listener||d]:[d]:r?No(d):Ti(d,d.length)}Te.prototype.listeners=function(e){return Ei(this,e,!0)};Te.prototype.rawListeners=function(e){return Ei(this,e,!1)};Te.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):Si.call(t,e)};Te.prototype.listenerCount=Si;function Si(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Te.prototype.eventNames=function(){return this._eventsCount>0?tr(this._events):[]};function Ti(t,e){for(var r=new Array(e),l=0;l<e;++l)r[l]=t[l];return r}function Ao(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function No(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function jo(t,e){return new Promise(function(r,l){function d(s){t.removeListener(e,o),l(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",d),r([].slice.call(arguments))}Ai(t,e,o,{once:!0}),e!=="error"&&Co(t,d,{once:!0})})}function Co(t,e,r){typeof t.on=="function"&&Ai(t,"error",e,r)}function Ai(t,e,r,l){if(typeof t.on=="function")l.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function d(o){l.once&&t.removeEventListener(e,d),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var Nn=An.exports,gn={exports:{}};typeof Object.create=="function"?gn.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:gn.exports=function(e,r){if(r){e.super_=r;var l=function(){};l.prototype=r.prototype,e.prototype=new l,e.prototype.constructor=e}};var pt=gn.exports;function Ro(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Ni={exports:{}},Oe=Ni.exports={},Ze,Ye;function wn(){throw new Error("setTimeout has not been defined")}function bn(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ze=setTimeout:Ze=wn}catch{Ze=wn}try{typeof clearTimeout=="function"?Ye=clearTimeout:Ye=bn}catch{Ye=bn}})();function ji(t){if(Ze===setTimeout)return setTimeout(t,0);if((Ze===wn||!Ze)&&setTimeout)return Ze=setTimeout,setTimeout(t,0);try{return Ze(t,0)}catch{try{return Ze.call(null,t,0)}catch{return Ze.call(this,t,0)}}}function Io(t){if(Ye===clearTimeout)return clearTimeout(t);if((Ye===bn||!Ye)&&clearTimeout)return Ye=clearTimeout,clearTimeout(t);try{return Ye(t)}catch{try{return Ye.call(null,t)}catch{return Ye.call(this,t)}}}var rt=[],xt=!1,dt,rr=-1;function Fo(){!xt||!dt||(xt=!1,dt.length?rt=dt.concat(rt):rr=-1,rt.length&&Ci())}function Ci(){if(!xt){var t=ji(Fo);xt=!0;for(var e=rt.length;e;){for(dt=rt,rt=[];++rr<e;)dt&&dt[rr].run();rr=-1,e=rt.length}dt=null,xt=!1,Io(t)}}Oe.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];rt.push(new Ri(t,e)),rt.length===1&&!xt&&ji(Ci)};function Ri(t,e){this.fun=t,this.array=e}Ri.prototype.run=function(){this.fun.apply(null,this.array)};Oe.title="browser";Oe.browser=!0;Oe.env={};Oe.argv=[];Oe.version="";Oe.versions={};function nt(){}Oe.on=nt;Oe.addListener=nt;Oe.once=nt;Oe.off=nt;Oe.removeListener=nt;Oe.removeAllListeners=nt;Oe.emit=nt;Oe.prependListener=nt;Oe.prependOnceListener=nt;Oe.listeners=function(t){return[]};Oe.binding=function(t){throw new Error("process.binding is not supported")};Oe.cwd=function(){return"/"};Oe.chdir=function(t){throw new Error("process.chdir is not supported")};Oe.umask=function(){return 0};var Oo=Ni.exports;const ke=Ro(Oo);var yr,na;function Ii(){return na||(na=1,yr=Nn.EventEmitter),yr}var xr={},Pt={},aa;function Po(){if(aa)return Pt;aa=1,Pt.byteLength=a,Pt.toByteArray=x,Pt.fromByteArray=T;for(var t=[],e=[],r=typeof Uint8Array<"u"?Uint8Array:Array,l="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",d=0,o=l.length;d<o;++d)t[d]=l[d],e[l.charCodeAt(d)]=d;e[45]=62,e[95]=63;function s(w){var E=w.length;if(E%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=w.indexOf("=");y===-1&&(y=E);var A=y===E?0:4-y%4;return[y,A]}function a(w){var E=s(w),y=E[0],A=E[1];return(y+A)*3/4-A}function c(w,E,y){return(E+y)*3/4-y}function x(w){var E,y=s(w),A=y[0],p=y[1],k=new r(c(w,A,p)),j=0,O=p>0?A-4:A,F;for(F=0;F<O;F+=4)E=e[w.charCodeAt(F)]<<18|e[w.charCodeAt(F+1)]<<12|e[w.charCodeAt(F+2)]<<6|e[w.charCodeAt(F+3)],k[j++]=E>>16&255,k[j++]=E>>8&255,k[j++]=E&255;return p===2&&(E=e[w.charCodeAt(F)]<<2|e[w.charCodeAt(F+1)]>>4,k[j++]=E&255),p===1&&(E=e[w.charCodeAt(F)]<<10|e[w.charCodeAt(F+1)]<<4|e[w.charCodeAt(F+2)]>>2,k[j++]=E>>8&255,k[j++]=E&255),k}function v(w){return t[w>>18&63]+t[w>>12&63]+t[w>>6&63]+t[w&63]}function S(w,E,y){for(var A,p=[],k=E;k<y;k+=3)A=(w[k]<<16&16711680)+(w[k+1]<<8&65280)+(w[k+2]&255),p.push(v(A));return p.join("")}function T(w){for(var E,y=w.length,A=y%3,p=[],k=16383,j=0,O=y-A;j<O;j+=k)p.push(S(w,j,j+k>O?O:j+k));return A===1?(E=w[y-1],p.push(t[E>>2]+t[E<<4&63]+"==")):A===2&&(E=(w[y-2]<<8)+w[y-1],p.push(t[E>>10]+t[E>>4&63]+t[E<<2&63]+"=")),p.join("")}return Pt}var qt={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var ia;function Do(){return ia||(ia=1,qt.read=function(t,e,r,l,d){var o,s,a=d*8-l-1,c=(1<<a)-1,x=c>>1,v=-7,S=r?d-1:0,T=r?-1:1,w=t[e+S];for(S+=T,o=w&(1<<-v)-1,w>>=-v,v+=a;v>0;o=o*256+t[e+S],S+=T,v-=8);for(s=o&(1<<-v)-1,o>>=-v,v+=l;v>0;s=s*256+t[e+S],S+=T,v-=8);if(o===0)o=1-x;else{if(o===c)return s?NaN:(w?-1:1)*(1/0);s=s+Math.pow(2,l),o=o-x}return(w?-1:1)*s*Math.pow(2,o-l)},qt.write=function(t,e,r,l,d,o){var s,a,c,x=o*8-d-1,v=(1<<x)-1,S=v>>1,T=d===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=l?0:o-1,E=l?1:-1,y=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=v):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+S>=1?e+=T/c:e+=T*Math.pow(2,1-S),e*c>=2&&(s++,c/=2),s+S>=v?(a=0,s=v):s+S>=1?(a=(e*c-1)*Math.pow(2,d),s=s+S):(a=e*Math.pow(2,S-1)*Math.pow(2,d),s=0));d>=8;t[r+w]=a&255,w+=E,a/=256,d-=8);for(s=s<<d|a,x+=d;x>0;t[r+w]=s&255,w+=E,s/=256,x-=8);t[r+w-E]|=y*128}),qt}/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var sa;function dr(){return sa||(sa=1,function(t){var e=Po(),r=Do(),l=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=a,t.SlowBuffer=k,t.INSPECT_MAX_BYTES=50;var d=2147483647;t.kMaxLength=d,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{var b=new Uint8Array(1),n={foo:function(){return 42}};return Object.setPrototypeOf(n,Uint8Array.prototype),Object.setPrototypeOf(b,n),b.foo()===42}catch{return!1}}Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.buffer}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){if(a.isBuffer(this))return this.byteOffset}});function s(b){if(b>d)throw new RangeError('The value "'+b+'" is invalid for option "size"');var n=new Uint8Array(b);return Object.setPrototypeOf(n,a.prototype),n}function a(b,n,i){if(typeof b=="number"){if(typeof n=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return S(b)}return c(b,n,i)}a.poolSize=8192;function c(b,n,i){if(typeof b=="string")return T(b,n);if(ArrayBuffer.isView(b))return E(b);if(b==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b);if(J(b,ArrayBuffer)||b&&J(b.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(J(b,SharedArrayBuffer)||b&&J(b.buffer,SharedArrayBuffer)))return y(b,n,i);if(typeof b=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var f=b.valueOf&&b.valueOf();if(f!=null&&f!==b)return a.from(f,n,i);var D=A(b);if(D)return D;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof b[Symbol.toPrimitive]=="function")return a.from(b[Symbol.toPrimitive]("string"),n,i);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof b)}a.from=function(b,n,i){return c(b,n,i)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function x(b){if(typeof b!="number")throw new TypeError('"size" argument must be of type number');if(b<0)throw new RangeError('The value "'+b+'" is invalid for option "size"')}function v(b,n,i){return x(b),b<=0?s(b):n!==void 0?typeof i=="string"?s(b).fill(n,i):s(b).fill(n):s(b)}a.alloc=function(b,n,i){return v(b,n,i)};function S(b){return x(b),s(b<0?0:p(b)|0)}a.allocUnsafe=function(b){return S(b)},a.allocUnsafeSlow=function(b){return S(b)};function T(b,n){if((typeof n!="string"||n==="")&&(n="utf8"),!a.isEncoding(n))throw new TypeError("Unknown encoding: "+n);var i=j(b,n)|0,f=s(i),D=f.write(b,n);return D!==i&&(f=f.slice(0,D)),f}function w(b){for(var n=b.length<0?0:p(b.length)|0,i=s(n),f=0;f<n;f+=1)i[f]=b[f]&255;return i}function E(b){if(J(b,Uint8Array)){var n=new Uint8Array(b);return y(n.buffer,n.byteOffset,n.byteLength)}return w(b)}function y(b,n,i){if(n<0||b.byteLength<n)throw new RangeError('"offset" is outside of buffer bounds');if(b.byteLength<n+(i||0))throw new RangeError('"length" is outside of buffer bounds');var f;return n===void 0&&i===void 0?f=new Uint8Array(b):i===void 0?f=new Uint8Array(b,n):f=new Uint8Array(b,n,i),Object.setPrototypeOf(f,a.prototype),f}function A(b){if(a.isBuffer(b)){var n=p(b.length)|0,i=s(n);return i.length===0||b.copy(i,0,0,n),i}if(b.length!==void 0)return typeof b.length!="number"||h(b.length)?s(0):w(b);if(b.type==="Buffer"&&Array.isArray(b.data))return w(b.data)}function p(b){if(b>=d)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d.toString(16)+" bytes");return b|0}function k(b){return+b!=b&&(b=0),a.alloc(+b)}a.isBuffer=function(n){return n!=null&&n._isBuffer===!0&&n!==a.prototype},a.compare=function(n,i){if(J(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),J(i,Uint8Array)&&(i=a.from(i,i.offset,i.byteLength)),!a.isBuffer(n)||!a.isBuffer(i))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(n===i)return 0;for(var f=n.length,D=i.length,U=0,L=Math.min(f,D);U<L;++U)if(n[U]!==i[U]){f=n[U],D=i[U];break}return f<D?-1:D<f?1:0},a.isEncoding=function(n){switch(String(n).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},a.concat=function(n,i){if(!Array.isArray(n))throw new TypeError('"list" argument must be an Array of Buffers');if(n.length===0)return a.alloc(0);var f;if(i===void 0)for(i=0,f=0;f<n.length;++f)i+=n[f].length;var D=a.allocUnsafe(i),U=0;for(f=0;f<n.length;++f){var L=n[f];if(J(L,Uint8Array))U+L.length>D.length?a.from(L).copy(D,U):Uint8Array.prototype.set.call(D,L,U);else if(a.isBuffer(L))L.copy(D,U);else throw new TypeError('"list" argument must be an Array of Buffers');U+=L.length}return D};function j(b,n){if(a.isBuffer(b))return b.length;if(ArrayBuffer.isView(b)||J(b,ArrayBuffer))return b.byteLength;if(typeof b!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof b);var i=b.length,f=arguments.length>2&&arguments[2]===!0;if(!f&&i===0)return 0;for(var D=!1;;)switch(n){case"ascii":case"latin1":case"binary":return i;case"utf8":case"utf-8":return m(b).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return i*2;case"hex":return i>>>1;case"base64":return C(b).length;default:if(D)return f?-1:m(b).length;n=(""+n).toLowerCase(),D=!0}}a.byteLength=j;function O(b,n,i){var f=!1;if((n===void 0||n<0)&&(n=0),n>this.length||((i===void 0||i>this.length)&&(i=this.length),i<=0)||(i>>>=0,n>>>=0,i<=n))return"";for(b||(b="utf8");;)switch(b){case"hex":return te(this,n,i);case"utf8":case"utf-8":return _(this,n,i);case"ascii":return Q(this,n,i);case"latin1":case"binary":return pe(this,n,i);case"base64":return X(this,n,i);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return fe(this,n,i);default:if(f)throw new TypeError("Unknown encoding: "+b);b=(b+"").toLowerCase(),f=!0}}a.prototype._isBuffer=!0;function F(b,n,i){var f=b[n];b[n]=b[i],b[i]=f}a.prototype.swap16=function(){var n=this.length;if(n%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var i=0;i<n;i+=2)F(this,i,i+1);return this},a.prototype.swap32=function(){var n=this.length;if(n%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var i=0;i<n;i+=4)F(this,i,i+3),F(this,i+1,i+2);return this},a.prototype.swap64=function(){var n=this.length;if(n%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var i=0;i<n;i+=8)F(this,i,i+7),F(this,i+1,i+6),F(this,i+2,i+5),F(this,i+3,i+4);return this},a.prototype.toString=function(){var n=this.length;return n===0?"":arguments.length===0?_(this,0,n):O.apply(this,arguments)},a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=function(n){if(!a.isBuffer(n))throw new TypeError("Argument must be a Buffer");return this===n?!0:a.compare(this,n)===0},a.prototype.inspect=function(){var n="",i=t.INSPECT_MAX_BYTES;return n=this.toString("hex",0,i).replace(/(.{2})/g,"$1 ").trim(),this.length>i&&(n+=" ... "),"<Buffer "+n+">"},l&&(a.prototype[l]=a.prototype.inspect),a.prototype.compare=function(n,i,f,D,U){if(J(n,Uint8Array)&&(n=a.from(n,n.offset,n.byteLength)),!a.isBuffer(n))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof n);if(i===void 0&&(i=0),f===void 0&&(f=n?n.length:0),D===void 0&&(D=0),U===void 0&&(U=this.length),i<0||f>n.length||D<0||U>this.length)throw new RangeError("out of range index");if(D>=U&&i>=f)return 0;if(D>=U)return-1;if(i>=f)return 1;if(i>>>=0,f>>>=0,D>>>=0,U>>>=0,this===n)return 0;for(var L=U-D,re=f-i,le=Math.min(L,re),ae=this.slice(D,U),he=n.slice(i,f),ge=0;ge<le;++ge)if(ae[ge]!==he[ge]){L=ae[ge],re=he[ge];break}return L<re?-1:re<L?1:0};function G(b,n,i,f,D){if(b.length===0)return-1;if(typeof i=="string"?(f=i,i=0):i>2147483647?i=2147483647:i<-2147483648&&(i=-2147483648),i=+i,h(i)&&(i=D?0:b.length-1),i<0&&(i=b.length+i),i>=b.length){if(D)return-1;i=b.length-1}else if(i<0)if(D)i=0;else return-1;if(typeof n=="string"&&(n=a.from(n,f)),a.isBuffer(n))return n.length===0?-1:W(b,n,i,f,D);if(typeof n=="number")return n=n&255,typeof Uint8Array.prototype.indexOf=="function"?D?Uint8Array.prototype.indexOf.call(b,n,i):Uint8Array.prototype.lastIndexOf.call(b,n,i):W(b,[n],i,f,D);throw new TypeError("val must be string, number or Buffer")}function W(b,n,i,f,D){var U=1,L=b.length,re=n.length;if(f!==void 0&&(f=String(f).toLowerCase(),f==="ucs2"||f==="ucs-2"||f==="utf16le"||f==="utf-16le")){if(b.length<2||n.length<2)return-1;U=2,L/=2,re/=2,i/=2}function le(Be,ce){return U===1?Be[ce]:Be.readUInt16BE(ce*U)}var ae;if(D){var he=-1;for(ae=i;ae<L;ae++)if(le(b,ae)===le(n,he===-1?0:ae-he)){if(he===-1&&(he=ae),ae-he+1===re)return he*U}else he!==-1&&(ae-=ae-he),he=-1}else for(i+re>L&&(i=L-re),ae=i;ae>=0;ae--){for(var ge=!0,ye=0;ye<re;ye++)if(le(b,ae+ye)!==le(n,ye)){ge=!1;break}if(ge)return ae}return-1}a.prototype.includes=function(n,i,f){return this.indexOf(n,i,f)!==-1},a.prototype.indexOf=function(n,i,f){return G(this,n,i,f,!0)},a.prototype.lastIndexOf=function(n,i,f){return G(this,n,i,f,!1)};function $(b,n,i,f){i=Number(i)||0;var D=b.length-i;f?(f=Number(f),f>D&&(f=D)):f=D;var U=n.length;f>U/2&&(f=U/2);for(var L=0;L<f;++L){var re=parseInt(n.substr(L*2,2),16);if(h(re))return L;b[i+L]=re}return L}function N(b,n,i,f){return I(m(n,b.length-i),b,i,f)}function ne(b,n,i,f){return I(M(n),b,i,f)}function se(b,n,i,f){return I(C(n),b,i,f)}function B(b,n,i,f){return I(P(n,b.length-i),b,i,f)}a.prototype.write=function(n,i,f,D){if(i===void 0)D="utf8",f=this.length,i=0;else if(f===void 0&&typeof i=="string")D=i,f=this.length,i=0;else if(isFinite(i))i=i>>>0,isFinite(f)?(f=f>>>0,D===void 0&&(D="utf8")):(D=f,f=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var U=this.length-i;if((f===void 0||f>U)&&(f=U),n.length>0&&(f<0||i<0)||i>this.length)throw new RangeError("Attempt to write outside buffer bounds");D||(D="utf8");for(var L=!1;;)switch(D){case"hex":return $(this,n,i,f);case"utf8":case"utf-8":return N(this,n,i,f);case"ascii":case"latin1":case"binary":return ne(this,n,i,f);case"base64":return se(this,n,i,f);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return B(this,n,i,f);default:if(L)throw new TypeError("Unknown encoding: "+D);D=(""+D).toLowerCase(),L=!0}},a.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function X(b,n,i){return n===0&&i===b.length?e.fromByteArray(b):e.fromByteArray(b.slice(n,i))}function _(b,n,i){i=Math.min(b.length,i);for(var f=[],D=n;D<i;){var U=b[D],L=null,re=U>239?4:U>223?3:U>191?2:1;if(D+re<=i){var le,ae,he,ge;switch(re){case 1:U<128&&(L=U);break;case 2:le=b[D+1],(le&192)===128&&(ge=(U&31)<<6|le&63,ge>127&&(L=ge));break;case 3:le=b[D+1],ae=b[D+2],(le&192)===128&&(ae&192)===128&&(ge=(U&15)<<12|(le&63)<<6|ae&63,ge>2047&&(ge<55296||ge>57343)&&(L=ge));break;case 4:le=b[D+1],ae=b[D+2],he=b[D+3],(le&192)===128&&(ae&192)===128&&(he&192)===128&&(ge=(U&15)<<18|(le&63)<<12|(ae&63)<<6|he&63,ge>65535&&ge<1114112&&(L=ge))}}L===null?(L=65533,re=1):L>65535&&(L-=65536,f.push(L>>>10&1023|55296),L=56320|L&1023),f.push(L),D+=re}return de(f)}var Y=4096;function de(b){var n=b.length;if(n<=Y)return String.fromCharCode.apply(String,b);for(var i="",f=0;f<n;)i+=String.fromCharCode.apply(String,b.slice(f,f+=Y));return i}function Q(b,n,i){var f="";i=Math.min(b.length,i);for(var D=n;D<i;++D)f+=String.fromCharCode(b[D]&127);return f}function pe(b,n,i){var f="";i=Math.min(b.length,i);for(var D=n;D<i;++D)f+=String.fromCharCode(b[D]);return f}function te(b,n,i){var f=b.length;(!n||n<0)&&(n=0),(!i||i<0||i>f)&&(i=f);for(var D="",U=n;U<i;++U)D+=Z[b[U]];return D}function fe(b,n,i){for(var f=b.slice(n,i),D="",U=0;U<f.length-1;U+=2)D+=String.fromCharCode(f[U]+f[U+1]*256);return D}a.prototype.slice=function(n,i){var f=this.length;n=~~n,i=i===void 0?f:~~i,n<0?(n+=f,n<0&&(n=0)):n>f&&(n=f),i<0?(i+=f,i<0&&(i=0)):i>f&&(i=f),i<n&&(i=n);var D=this.subarray(n,i);return Object.setPrototypeOf(D,a.prototype),D};function H(b,n,i){if(b%1!==0||b<0)throw new RangeError("offset is not uint");if(b+n>i)throw new RangeError("Trying to access beyond buffer length")}a.prototype.readUintLE=a.prototype.readUIntLE=function(n,i,f){n=n>>>0,i=i>>>0,f||H(n,i,this.length);for(var D=this[n],U=1,L=0;++L<i&&(U*=256);)D+=this[n+L]*U;return D},a.prototype.readUintBE=a.prototype.readUIntBE=function(n,i,f){n=n>>>0,i=i>>>0,f||H(n,i,this.length);for(var D=this[n+--i],U=1;i>0&&(U*=256);)D+=this[n+--i]*U;return D},a.prototype.readUint8=a.prototype.readUInt8=function(n,i){return n=n>>>0,i||H(n,1,this.length),this[n]},a.prototype.readUint16LE=a.prototype.readUInt16LE=function(n,i){return n=n>>>0,i||H(n,2,this.length),this[n]|this[n+1]<<8},a.prototype.readUint16BE=a.prototype.readUInt16BE=function(n,i){return n=n>>>0,i||H(n,2,this.length),this[n]<<8|this[n+1]},a.prototype.readUint32LE=a.prototype.readUInt32LE=function(n,i){return n=n>>>0,i||H(n,4,this.length),(this[n]|this[n+1]<<8|this[n+2]<<16)+this[n+3]*16777216},a.prototype.readUint32BE=a.prototype.readUInt32BE=function(n,i){return n=n>>>0,i||H(n,4,this.length),this[n]*16777216+(this[n+1]<<16|this[n+2]<<8|this[n+3])},a.prototype.readIntLE=function(n,i,f){n=n>>>0,i=i>>>0,f||H(n,i,this.length);for(var D=this[n],U=1,L=0;++L<i&&(U*=256);)D+=this[n+L]*U;return U*=128,D>=U&&(D-=Math.pow(2,8*i)),D},a.prototype.readIntBE=function(n,i,f){n=n>>>0,i=i>>>0,f||H(n,i,this.length);for(var D=i,U=1,L=this[n+--D];D>0&&(U*=256);)L+=this[n+--D]*U;return U*=128,L>=U&&(L-=Math.pow(2,8*i)),L},a.prototype.readInt8=function(n,i){return n=n>>>0,i||H(n,1,this.length),this[n]&128?(255-this[n]+1)*-1:this[n]},a.prototype.readInt16LE=function(n,i){n=n>>>0,i||H(n,2,this.length);var f=this[n]|this[n+1]<<8;return f&32768?f|4294901760:f},a.prototype.readInt16BE=function(n,i){n=n>>>0,i||H(n,2,this.length);var f=this[n+1]|this[n]<<8;return f&32768?f|4294901760:f},a.prototype.readInt32LE=function(n,i){return n=n>>>0,i||H(n,4,this.length),this[n]|this[n+1]<<8|this[n+2]<<16|this[n+3]<<24},a.prototype.readInt32BE=function(n,i){return n=n>>>0,i||H(n,4,this.length),this[n]<<24|this[n+1]<<16|this[n+2]<<8|this[n+3]},a.prototype.readFloatLE=function(n,i){return n=n>>>0,i||H(n,4,this.length),r.read(this,n,!0,23,4)},a.prototype.readFloatBE=function(n,i){return n=n>>>0,i||H(n,4,this.length),r.read(this,n,!1,23,4)},a.prototype.readDoubleLE=function(n,i){return n=n>>>0,i||H(n,8,this.length),r.read(this,n,!0,52,8)},a.prototype.readDoubleBE=function(n,i){return n=n>>>0,i||H(n,8,this.length),r.read(this,n,!1,52,8)};function R(b,n,i,f,D,U){if(!a.isBuffer(b))throw new TypeError('"buffer" argument must be a Buffer instance');if(n>D||n<U)throw new RangeError('"value" argument is out of bounds');if(i+f>b.length)throw new RangeError("Index out of range")}a.prototype.writeUintLE=a.prototype.writeUIntLE=function(n,i,f,D){if(n=+n,i=i>>>0,f=f>>>0,!D){var U=Math.pow(2,8*f)-1;R(this,n,i,f,U,0)}var L=1,re=0;for(this[i]=n&255;++re<f&&(L*=256);)this[i+re]=n/L&255;return i+f},a.prototype.writeUintBE=a.prototype.writeUIntBE=function(n,i,f,D){if(n=+n,i=i>>>0,f=f>>>0,!D){var U=Math.pow(2,8*f)-1;R(this,n,i,f,U,0)}var L=f-1,re=1;for(this[i+L]=n&255;--L>=0&&(re*=256);)this[i+L]=n/re&255;return i+f},a.prototype.writeUint8=a.prototype.writeUInt8=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,1,255,0),this[i]=n&255,i+1},a.prototype.writeUint16LE=a.prototype.writeUInt16LE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,2,65535,0),this[i]=n&255,this[i+1]=n>>>8,i+2},a.prototype.writeUint16BE=a.prototype.writeUInt16BE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,2,65535,0),this[i]=n>>>8,this[i+1]=n&255,i+2},a.prototype.writeUint32LE=a.prototype.writeUInt32LE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,4,4294967295,0),this[i+3]=n>>>24,this[i+2]=n>>>16,this[i+1]=n>>>8,this[i]=n&255,i+4},a.prototype.writeUint32BE=a.prototype.writeUInt32BE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,4,4294967295,0),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4},a.prototype.writeIntLE=function(n,i,f,D){if(n=+n,i=i>>>0,!D){var U=Math.pow(2,8*f-1);R(this,n,i,f,U-1,-U)}var L=0,re=1,le=0;for(this[i]=n&255;++L<f&&(re*=256);)n<0&&le===0&&this[i+L-1]!==0&&(le=1),this[i+L]=(n/re>>0)-le&255;return i+f},a.prototype.writeIntBE=function(n,i,f,D){if(n=+n,i=i>>>0,!D){var U=Math.pow(2,8*f-1);R(this,n,i,f,U-1,-U)}var L=f-1,re=1,le=0;for(this[i+L]=n&255;--L>=0&&(re*=256);)n<0&&le===0&&this[i+L+1]!==0&&(le=1),this[i+L]=(n/re>>0)-le&255;return i+f},a.prototype.writeInt8=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,1,127,-128),n<0&&(n=255+n+1),this[i]=n&255,i+1},a.prototype.writeInt16LE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,2,32767,-32768),this[i]=n&255,this[i+1]=n>>>8,i+2},a.prototype.writeInt16BE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,2,32767,-32768),this[i]=n>>>8,this[i+1]=n&255,i+2},a.prototype.writeInt32LE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,4,2147483647,-2147483648),this[i]=n&255,this[i+1]=n>>>8,this[i+2]=n>>>16,this[i+3]=n>>>24,i+4},a.prototype.writeInt32BE=function(n,i,f){return n=+n,i=i>>>0,f||R(this,n,i,4,2147483647,-2147483648),n<0&&(n=4294967295+n+1),this[i]=n>>>24,this[i+1]=n>>>16,this[i+2]=n>>>8,this[i+3]=n&255,i+4};function q(b,n,i,f,D,U){if(i+f>b.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("Index out of range")}function K(b,n,i,f,D){return n=+n,i=i>>>0,D||q(b,n,i,4),r.write(b,n,i,f,23,4),i+4}a.prototype.writeFloatLE=function(n,i,f){return K(this,n,i,!0,f)},a.prototype.writeFloatBE=function(n,i,f){return K(this,n,i,!1,f)};function V(b,n,i,f,D){return n=+n,i=i>>>0,D||q(b,n,i,8),r.write(b,n,i,f,52,8),i+8}a.prototype.writeDoubleLE=function(n,i,f){return V(this,n,i,!0,f)},a.prototype.writeDoubleBE=function(n,i,f){return V(this,n,i,!1,f)},a.prototype.copy=function(n,i,f,D){if(!a.isBuffer(n))throw new TypeError("argument should be a Buffer");if(f||(f=0),!D&&D!==0&&(D=this.length),i>=n.length&&(i=n.length),i||(i=0),D>0&&D<f&&(D=f),D===f||n.length===0||this.length===0)return 0;if(i<0)throw new RangeError("targetStart out of bounds");if(f<0||f>=this.length)throw new RangeError("Index out of range");if(D<0)throw new RangeError("sourceEnd out of bounds");D>this.length&&(D=this.length),n.length-i<D-f&&(D=n.length-i+f);var U=D-f;return this===n&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(i,f,D):Uint8Array.prototype.set.call(n,this.subarray(f,D),i),U},a.prototype.fill=function(n,i,f,D){if(typeof n=="string"){if(typeof i=="string"?(D=i,i=0,f=this.length):typeof f=="string"&&(D=f,f=this.length),D!==void 0&&typeof D!="string")throw new TypeError("encoding must be a string");if(typeof D=="string"&&!a.isEncoding(D))throw new TypeError("Unknown encoding: "+D);if(n.length===1){var U=n.charCodeAt(0);(D==="utf8"&&U<128||D==="latin1")&&(n=U)}}else typeof n=="number"?n=n&255:typeof n=="boolean"&&(n=Number(n));if(i<0||this.length<i||this.length<f)throw new RangeError("Out of range index");if(f<=i)return this;i=i>>>0,f=f===void 0?this.length:f>>>0,n||(n=0);var L;if(typeof n=="number")for(L=i;L<f;++L)this[L]=n;else{var re=a.isBuffer(n)?n:a.from(n,D),le=re.length;if(le===0)throw new TypeError('The value "'+n+'" is invalid for argument "value"');for(L=0;L<f-i;++L)this[L+i]=re[L%le]}return this};var z=/[^+/0-9A-Za-z-_]/g;function g(b){if(b=b.split("=")[0],b=b.trim().replace(z,""),b.length<2)return"";for(;b.length%4!==0;)b=b+"=";return b}function m(b,n){n=n||1/0;for(var i,f=b.length,D=null,U=[],L=0;L<f;++L){if(i=b.charCodeAt(L),i>55295&&i<57344){if(!D){if(i>56319){(n-=3)>-1&&U.push(239,191,189);continue}else if(L+1===f){(n-=3)>-1&&U.push(239,191,189);continue}D=i;continue}if(i<56320){(n-=3)>-1&&U.push(239,191,189),D=i;continue}i=(D-55296<<10|i-56320)+65536}else D&&(n-=3)>-1&&U.push(239,191,189);if(D=null,i<128){if((n-=1)<0)break;U.push(i)}else if(i<2048){if((n-=2)<0)break;U.push(i>>6|192,i&63|128)}else if(i<65536){if((n-=3)<0)break;U.push(i>>12|224,i>>6&63|128,i&63|128)}else if(i<1114112){if((n-=4)<0)break;U.push(i>>18|240,i>>12&63|128,i>>6&63|128,i&63|128)}else throw new Error("Invalid code point")}return U}function M(b){for(var n=[],i=0;i<b.length;++i)n.push(b.charCodeAt(i)&255);return n}function P(b,n){for(var i,f,D,U=[],L=0;L<b.length&&!((n-=2)<0);++L)i=b.charCodeAt(L),f=i>>8,D=i%256,U.push(D),U.push(f);return U}function C(b){return e.toByteArray(g(b))}function I(b,n,i,f){for(var D=0;D<f&&!(D+i>=n.length||D>=b.length);++D)n[D+i]=b[D];return D}function J(b,n){return b instanceof n||b!=null&&b.constructor!=null&&b.constructor.name!=null&&b.constructor.name===n.name}function h(b){return b!==b}var Z=function(){for(var b="0123456789abcdef",n=new Array(256),i=0;i<16;++i)for(var f=i*16,D=0;D<16;++D)n[f+D]=b[i]+b[D];return n}()}(xr)),xr}var vr={},kr={},_r,oa;function Fi(){return oa||(oa=1,_r=function(){if(typeof Symbol!="function"||typeof Object.getOwnPropertySymbols!="function")return!1;if(typeof Symbol.iterator=="symbol")return!0;var e={},r=Symbol("test"),l=Object(r);if(typeof r=="string"||Object.prototype.toString.call(r)!=="[object Symbol]"||Object.prototype.toString.call(l)!=="[object Symbol]")return!1;var d=42;e[r]=d;for(r in e)return!1;if(typeof Object.keys=="function"&&Object.keys(e).length!==0||typeof Object.getOwnPropertyNames=="function"&&Object.getOwnPropertyNames(e).length!==0)return!1;var o=Object.getOwnPropertySymbols(e);if(o.length!==1||o[0]!==r||!Object.prototype.propertyIsEnumerable.call(e,r))return!1;if(typeof Object.getOwnPropertyDescriptor=="function"){var s=Object.getOwnPropertyDescriptor(e,r);if(s.value!==d||s.enumerable!==!0)return!1}return!0}),_r}var Er,la;function jn(){if(la)return Er;la=1;var t=Fi();return Er=function(){return t()&&!!Symbol.toStringTag},Er}var Sr,ua;function Bo(){if(ua)return Sr;ua=1;var t=typeof Symbol<"u"&&Symbol,e=Fi();return Sr=function(){return typeof t!="function"||typeof Symbol!="function"||typeof t("foo")!="symbol"||typeof Symbol("bar")!="symbol"?!1:e()},Sr}var Tr,ca;function Lo(){if(ca)return Tr;ca=1;var t={foo:{}},e=Object;return Tr=function(){return{__proto__:t}.foo===t.foo&&!({__proto__:null}instanceof e)},Tr}var Ar,da;function Mo(){if(da)return Ar;da=1;var t="Function.prototype.bind called on incompatible ",e=Object.prototype.toString,r=Math.max,l="[object Function]",d=function(c,x){for(var v=[],S=0;S<c.length;S+=1)v[S]=c[S];for(var T=0;T<x.length;T+=1)v[T+c.length]=x[T];return v},o=function(c,x){for(var v=[],S=x,T=0;S<c.length;S+=1,T+=1)v[T]=c[S];return v},s=function(a,c){for(var x="",v=0;v<a.length;v+=1)x+=a[v],v+1<a.length&&(x+=c);return x};return Ar=function(c){var x=this;if(typeof x!="function"||e.apply(x)!==l)throw new TypeError(t+x);for(var v=o(arguments,1),S,T=function(){if(this instanceof S){var p=x.apply(this,d(v,arguments));return Object(p)===p?p:this}return x.apply(c,d(v,arguments))},w=r(0,x.length-v.length),E=[],y=0;y<w;y++)E[y]="$"+y;if(S=Function("binder","return function ("+s(E,",")+"){ return binder.apply(this,arguments); }")(T),x.prototype){var A=function(){};A.prototype=x.prototype,S.prototype=new A,A.prototype=null}return S},Ar}var Nr,fa;function Cn(){if(fa)return Nr;fa=1;var t=Mo();return Nr=Function.prototype.bind||t,Nr}var jr,ha;function zo(){if(ha)return jr;ha=1;var t=Function.prototype.call,e=Object.prototype.hasOwnProperty,r=Cn();return jr=r.call(t,e),jr}var Cr,pa;function jt(){if(pa)return Cr;pa=1;var t,e=SyntaxError,r=Function,l=TypeError,d=function(B){try{return r('"use strict"; return ('+B+").constructor;")()}catch{}},o=Object.getOwnPropertyDescriptor;if(o)try{o({},"")}catch{o=null}var s=function(){throw new l},a=o?function(){try{return arguments.callee,s}catch{try{return o(arguments,"callee").get}catch{return s}}}():s,c=Bo()(),x=Lo()(),v=Object.getPrototypeOf||(x?function(B){return B.__proto__}:null),S={},T=typeof Uint8Array>"u"||!v?t:v(Uint8Array),w={"%AggregateError%":typeof AggregateError>"u"?t:AggregateError,"%Array%":Array,"%ArrayBuffer%":typeof ArrayBuffer>"u"?t:ArrayBuffer,"%ArrayIteratorPrototype%":c&&v?v([][Symbol.iterator]()):t,"%AsyncFromSyncIteratorPrototype%":t,"%AsyncFunction%":S,"%AsyncGenerator%":S,"%AsyncGeneratorFunction%":S,"%AsyncIteratorPrototype%":S,"%Atomics%":typeof Atomics>"u"?t:Atomics,"%BigInt%":typeof BigInt>"u"?t:BigInt,"%BigInt64Array%":typeof BigInt64Array>"u"?t:BigInt64Array,"%BigUint64Array%":typeof BigUint64Array>"u"?t:BigUint64Array,"%Boolean%":Boolean,"%DataView%":typeof DataView>"u"?t:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":typeof Float32Array>"u"?t:Float32Array,"%Float64Array%":typeof Float64Array>"u"?t:Float64Array,"%FinalizationRegistry%":typeof FinalizationRegistry>"u"?t:FinalizationRegistry,"%Function%":r,"%GeneratorFunction%":S,"%Int8Array%":typeof Int8Array>"u"?t:Int8Array,"%Int16Array%":typeof Int16Array>"u"?t:Int16Array,"%Int32Array%":typeof Int32Array>"u"?t:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":c&&v?v(v([][Symbol.iterator]())):t,"%JSON%":typeof JSON=="object"?JSON:t,"%Map%":typeof Map>"u"?t:Map,"%MapIteratorPrototype%":typeof Map>"u"||!c||!v?t:v(new Map()[Symbol.iterator]()),"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":typeof Promise>"u"?t:Promise,"%Proxy%":typeof Proxy>"u"?t:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":typeof Reflect>"u"?t:Reflect,"%RegExp%":RegExp,"%Set%":typeof Set>"u"?t:Set,"%SetIteratorPrototype%":typeof Set>"u"||!c||!v?t:v(new Set()[Symbol.iterator]()),"%SharedArrayBuffer%":typeof SharedArrayBuffer>"u"?t:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":c&&v?v(""[Symbol.iterator]()):t,"%Symbol%":c?Symbol:t,"%SyntaxError%":e,"%ThrowTypeError%":a,"%TypedArray%":T,"%TypeError%":l,"%Uint8Array%":typeof Uint8Array>"u"?t:Uint8Array,"%Uint8ClampedArray%":typeof Uint8ClampedArray>"u"?t:Uint8ClampedArray,"%Uint16Array%":typeof Uint16Array>"u"?t:Uint16Array,"%Uint32Array%":typeof Uint32Array>"u"?t:Uint32Array,"%URIError%":URIError,"%WeakMap%":typeof WeakMap>"u"?t:WeakMap,"%WeakRef%":typeof WeakRef>"u"?t:WeakRef,"%WeakSet%":typeof WeakSet>"u"?t:WeakSet};if(v)try{null.error}catch(B){var E=v(v(B));w["%Error.prototype%"]=E}var y=function B(X){var _;if(X==="%AsyncFunction%")_=d("async function () {}");else if(X==="%GeneratorFunction%")_=d("function* () {}");else if(X==="%AsyncGeneratorFunction%")_=d("async function* () {}");else if(X==="%AsyncGenerator%"){var Y=B("%AsyncGeneratorFunction%");Y&&(_=Y.prototype)}else if(X==="%AsyncIteratorPrototype%"){var de=B("%AsyncGenerator%");de&&v&&(_=v(de.prototype))}return w[X]=_,_},A={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},p=Cn(),k=zo(),j=p.call(Function.call,Array.prototype.concat),O=p.call(Function.apply,Array.prototype.splice),F=p.call(Function.call,String.prototype.replace),G=p.call(Function.call,String.prototype.slice),W=p.call(Function.call,RegExp.prototype.exec),$=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,N=/\\(\\)?/g,ne=function(X){var _=G(X,0,1),Y=G(X,-1);if(_==="%"&&Y!=="%")throw new e("invalid intrinsic syntax, expected closing `%`");if(Y==="%"&&_!=="%")throw new e("invalid intrinsic syntax, expected opening `%`");var de=[];return F(X,$,function(Q,pe,te,fe){de[de.length]=te?F(fe,N,"$1"):pe||Q}),de},se=function(X,_){var Y=X,de;if(k(A,Y)&&(de=A[Y],Y="%"+de[0]+"%"),k(w,Y)){var Q=w[Y];if(Q===S&&(Q=y(Y)),typeof Q>"u"&&!_)throw new l("intrinsic "+X+" exists, but is not available. Please file an issue!");return{alias:de,name:Y,value:Q}}throw new e("intrinsic "+X+" does not exist!")};return Cr=function(X,_){if(typeof X!="string"||X.length===0)throw new l("intrinsic name must be a non-empty string");if(arguments.length>1&&typeof _!="boolean")throw new l('"allowMissing" argument must be a boolean');if(W(/^%?[^%]*%?$/,X)===null)throw new e("`%` may not be present anywhere but at the beginning and end of the intrinsic name");var Y=ne(X),de=Y.length>0?Y[0]:"",Q=se("%"+de+"%",_),pe=Q.name,te=Q.value,fe=!1,H=Q.alias;H&&(de=H[0],O(Y,j([0,1],H)));for(var R=1,q=!0;R<Y.length;R+=1){var K=Y[R],V=G(K,0,1),z=G(K,-1);if((V==='"'||V==="'"||V==="`"||z==='"'||z==="'"||z==="`")&&V!==z)throw new e("property names with quotes must have matching quotes");if((K==="constructor"||!q)&&(fe=!0),de+="."+K,pe="%"+de+"%",k(w,pe))te=w[pe];else if(te!=null){if(!(K in te)){if(!_)throw new l("base intrinsic for "+X+" exists, but the property is not available.");return}if(o&&R+1>=Y.length){var g=o(te,K);q=!!g,q&&"get"in g&&!("originalValue"in g.get)?te=g.get:te=te[K]}else q=k(te,K),te=te[K];q&&!fe&&(w[pe]=te)}}return te},Cr}var Rr={exports:{}},Ir,ma;function Oi(){if(ma)return Ir;ma=1;var t=jt(),e=t("%Object.defineProperty%",!0),r=function(){if(e)try{return e({},"a",{value:1}),!0}catch{return!1}return!1};return r.hasArrayLengthDefineBug=function(){if(!r())return null;try{return e([],"length",{value:1}).length!==1}catch{return!0}},Ir=r,Ir}var Fr,ga;function Rn(){if(ga)return Fr;ga=1;var t=jt(),e=t("%Object.getOwnPropertyDescriptor%",!0);if(e)try{e([],"length")}catch{e=null}return Fr=e,Fr}var Or,wa;function Uo(){if(wa)return Or;wa=1;var t=Oi()(),e=jt(),r=t&&e("%Object.defineProperty%",!0);if(r)try{r({},"a",{value:1})}catch{r=!1}var l=e("%SyntaxError%"),d=e("%TypeError%"),o=Rn();return Or=function(a,c,x){if(!a||typeof a!="object"&&typeof a!="function")throw new d("`obj` must be an object or a function`");if(typeof c!="string"&&typeof c!="symbol")throw new d("`property` must be a string or a symbol`");if(arguments.length>3&&typeof arguments[3]!="boolean"&&arguments[3]!==null)throw new d("`nonEnumerable`, if provided, must be a boolean or null");if(arguments.length>4&&typeof arguments[4]!="boolean"&&arguments[4]!==null)throw new d("`nonWritable`, if provided, must be a boolean or null");if(arguments.length>5&&typeof arguments[5]!="boolean"&&arguments[5]!==null)throw new d("`nonConfigurable`, if provided, must be a boolean or null");if(arguments.length>6&&typeof arguments[6]!="boolean")throw new d("`loose`, if provided, must be a boolean");var v=arguments.length>3?arguments[3]:null,S=arguments.length>4?arguments[4]:null,T=arguments.length>5?arguments[5]:null,w=arguments.length>6?arguments[6]:!1,E=!!o&&o(a,c);if(r)r(a,c,{configurable:T===null&&E?E.configurable:!T,enumerable:v===null&&E?E.enumerable:!v,value:x,writable:S===null&&E?E.writable:!S});else if(w||!v&&!S&&!T)a[c]=x;else throw new l("This environment does not support defining a property as non-configurable, non-writable, or non-enumerable.")},Or}var Pr,ba;function Wo(){if(ba)return Pr;ba=1;var t=jt(),e=Uo(),r=Oi()(),l=Rn(),d=t("%TypeError%"),o=t("%Math.floor%");return Pr=function(a,c){if(typeof a!="function")throw new d("`fn` is not a function");if(typeof c!="number"||c<0||c>4294967295||o(c)!==c)throw new d("`length` must be a positive 32-bit integer");var x=arguments.length>2&&!!arguments[2],v=!0,S=!0;if("length"in a&&l){var T=l(a,"length");T&&!T.configurable&&(v=!1),T&&!T.writable&&(S=!1)}return(v||S||!x)&&(r?e(a,"length",c,!0,!0):e(a,"length",c)),a},Pr}var ya;function Pi(){return ya||(ya=1,function(t){var e=Cn(),r=jt(),l=Wo(),d=r("%TypeError%"),o=r("%Function.prototype.apply%"),s=r("%Function.prototype.call%"),a=r("%Reflect.apply%",!0)||e.call(s,o),c=r("%Object.defineProperty%",!0),x=r("%Math.max%");if(c)try{c({},"a",{value:1})}catch{c=null}t.exports=function(T){if(typeof T!="function")throw new d("a function is required");var w=a(e,s,arguments);return l(w,1+x(0,T.length-(arguments.length-1)),!0)};var v=function(){return a(e,o,arguments)};c?c(t.exports,"apply",{value:v}):t.exports.apply=v}(Rr)),Rr.exports}var Dr,xa;function Di(){if(xa)return Dr;xa=1;var t=jt(),e=Pi(),r=e(t("String.prototype.indexOf"));return Dr=function(d,o){var s=t(d,!!o);return typeof s=="function"&&r(d,".prototype.")>-1?e(s):s},Dr}var Br,va;function Ho(){if(va)return Br;va=1;var t=jn()(),e=Di(),r=e("Object.prototype.toString"),l=function(a){return t&&a&&typeof a=="object"&&Symbol.toStringTag in a?!1:r(a)==="[object Arguments]"},d=function(a){return l(a)?!0:a!==null&&typeof a=="object"&&typeof a.length=="number"&&a.length>=0&&r(a)!=="[object Array]"&&r(a.callee)==="[object Function]"},o=function(){return l(arguments)}();return l.isLegacyArguments=d,Br=o?l:d,Br}var Lr,ka;function Go(){if(ka)return Lr;ka=1;var t=Object.prototype.toString,e=Function.prototype.toString,r=/^\s*(?:function)?\*/,l=jn()(),d=Object.getPrototypeOf,o=function(){if(!l)return!1;try{return Function("return function*() {}")()}catch{}},s;return Lr=function(c){if(typeof c!="function")return!1;if(r.test(e.call(c)))return!0;if(!l){var x=t.call(c);return x==="[object GeneratorFunction]"}if(!d)return!1;if(typeof s>"u"){var v=o();s=v?d(v):!1}return d(c)===s},Lr}var Mr,_a;function Ko(){if(_a)return Mr;_a=1;var t=Function.prototype.toString,e=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,r,l;if(typeof e=="function"&&typeof Object.defineProperty=="function")try{r=Object.defineProperty({},"length",{get:function(){throw l}}),l={},e(function(){throw 42},null,r)}catch(k){k!==l&&(e=null)}else e=null;var d=/^\s*class\b/,o=function(j){try{var O=t.call(j);return d.test(O)}catch{return!1}},s=function(j){try{return o(j)?!1:(t.call(j),!0)}catch{return!1}},a=Object.prototype.toString,c="[object Object]",x="[object Function]",v="[object GeneratorFunction]",S="[object HTMLAllCollection]",T="[object HTML document.all class]",w="[object HTMLCollection]",E=typeof Symbol=="function"&&!!Symbol.toStringTag,y=!(0 in[,]),A=function(){return!1};if(typeof document=="object"){var p=document.all;a.call(p)===a.call(document.all)&&(A=function(j){if((y||!j)&&(typeof j>"u"||typeof j=="object"))try{var O=a.call(j);return(O===S||O===T||O===w||O===c)&&j("")==null}catch{}return!1})}return Mr=e?function(j){if(A(j))return!0;if(!j||typeof j!="function"&&typeof j!="object")return!1;try{e(j,null,r)}catch(O){if(O!==l)return!1}return!o(j)&&s(j)}:function(j){if(A(j))return!0;if(!j||typeof j!="function"&&typeof j!="object")return!1;if(E)return s(j);if(o(j))return!1;var O=a.call(j);return O!==x&&O!==v&&!/^\[object HTML/.test(O)?!1:s(j)},Mr}var zr,Ea;function qo(){if(Ea)return zr;Ea=1;var t=Ko(),e=Object.prototype.toString,r=Object.prototype.hasOwnProperty,l=function(c,x,v){for(var S=0,T=c.length;S<T;S++)r.call(c,S)&&(v==null?x(c[S],S,c):x.call(v,c[S],S,c))},d=function(c,x,v){for(var S=0,T=c.length;S<T;S++)v==null?x(c.charAt(S),S,c):x.call(v,c.charAt(S),S,c)},o=function(c,x,v){for(var S in c)r.call(c,S)&&(v==null?x(c[S],S,c):x.call(v,c[S],S,c))},s=function(c,x,v){if(!t(x))throw new TypeError("iterator must be a function");var S;arguments.length>=3&&(S=v),e.call(c)==="[object Array]"?l(c,x,S):typeof c=="string"?d(c,x,S):o(c,x,S)};return zr=s,zr}var Ur,Sa;function Vo(){if(Sa)return Ur;Sa=1;var t=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],e=typeof globalThis>"u"?Qe:globalThis;return Ur=function(){for(var l=[],d=0;d<t.length;d++)typeof e[t[d]]=="function"&&(l[l.length]=t[d]);return l},Ur}var Wr,Ta;function Bi(){if(Ta)return Wr;Ta=1;var t=qo(),e=Vo(),r=Pi(),l=Di(),d=Rn(),o=l("Object.prototype.toString"),s=jn()(),a=typeof globalThis>"u"?Qe:globalThis,c=e(),x=l("String.prototype.slice"),v=Object.getPrototypeOf,S=l("Array.prototype.indexOf",!0)||function(A,p){for(var k=0;k<A.length;k+=1)if(A[k]===p)return k;return-1},T={__proto__:null};s&&d&&v?t(c,function(y){var A=new a[y];if(Symbol.toStringTag in A){var p=v(A),k=d(p,Symbol.toStringTag);if(!k){var j=v(p);k=d(j,Symbol.toStringTag)}T["$"+y]=r(k.get)}}):t(c,function(y){var A=new a[y],p=A.slice||A.set;p&&(T["$"+y]=r(p))});var w=function(A){var p=!1;return t(T,function(k,j){if(!p)try{"$"+k(A)===j&&(p=x(j,1))}catch{}}),p},E=function(A){var p=!1;return t(T,function(k,j){if(!p)try{k(A),p=x(j,1)}catch{}}),p};return Wr=function(A){if(!A||typeof A!="object")return!1;if(!s){var p=x(o(A),8,-1);return S(c,p)>-1?p:p!=="Object"?!1:E(A)}return d?w(A):null},Wr}var Hr,Aa;function $o(){if(Aa)return Hr;Aa=1;var t=Bi();return Hr=function(r){return!!t(r)},Hr}var Na;function Xo(){return Na||(Na=1,function(t){var e=Ho(),r=Go(),l=Bi(),d=$o();function o(f){return f.call.bind(f)}var s=typeof BigInt<"u",a=typeof Symbol<"u",c=o(Object.prototype.toString),x=o(Number.prototype.valueOf),v=o(String.prototype.valueOf),S=o(Boolean.prototype.valueOf);if(s)var T=o(BigInt.prototype.valueOf);if(a)var w=o(Symbol.prototype.valueOf);function E(f,D){if(typeof f!="object")return!1;try{return D(f),!0}catch{return!1}}t.isArgumentsObject=e,t.isGeneratorFunction=r,t.isTypedArray=d;function y(f){return typeof Promise<"u"&&f instanceof Promise||f!==null&&typeof f=="object"&&typeof f.then=="function"&&typeof f.catch=="function"}t.isPromise=y;function A(f){return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?ArrayBuffer.isView(f):d(f)||q(f)}t.isArrayBufferView=A;function p(f){return l(f)==="Uint8Array"}t.isUint8Array=p;function k(f){return l(f)==="Uint8ClampedArray"}t.isUint8ClampedArray=k;function j(f){return l(f)==="Uint16Array"}t.isUint16Array=j;function O(f){return l(f)==="Uint32Array"}t.isUint32Array=O;function F(f){return l(f)==="Int8Array"}t.isInt8Array=F;function G(f){return l(f)==="Int16Array"}t.isInt16Array=G;function W(f){return l(f)==="Int32Array"}t.isInt32Array=W;function $(f){return l(f)==="Float32Array"}t.isFloat32Array=$;function N(f){return l(f)==="Float64Array"}t.isFloat64Array=N;function ne(f){return l(f)==="BigInt64Array"}t.isBigInt64Array=ne;function se(f){return l(f)==="BigUint64Array"}t.isBigUint64Array=se;function B(f){return c(f)==="[object Map]"}B.working=typeof Map<"u"&&B(new Map);function X(f){return typeof Map>"u"?!1:B.working?B(f):f instanceof Map}t.isMap=X;function _(f){return c(f)==="[object Set]"}_.working=typeof Set<"u"&&_(new Set);function Y(f){return typeof Set>"u"?!1:_.working?_(f):f instanceof Set}t.isSet=Y;function de(f){return c(f)==="[object WeakMap]"}de.working=typeof WeakMap<"u"&&de(new WeakMap);function Q(f){return typeof WeakMap>"u"?!1:de.working?de(f):f instanceof WeakMap}t.isWeakMap=Q;function pe(f){return c(f)==="[object WeakSet]"}pe.working=typeof WeakSet<"u"&&pe(new WeakSet);function te(f){return pe(f)}t.isWeakSet=te;function fe(f){return c(f)==="[object ArrayBuffer]"}fe.working=typeof ArrayBuffer<"u"&&fe(new ArrayBuffer);function H(f){return typeof ArrayBuffer>"u"?!1:fe.working?fe(f):f instanceof ArrayBuffer}t.isArrayBuffer=H;function R(f){return c(f)==="[object DataView]"}R.working=typeof ArrayBuffer<"u"&&typeof DataView<"u"&&R(new DataView(new ArrayBuffer(1),0,1));function q(f){return typeof DataView>"u"?!1:R.working?R(f):f instanceof DataView}t.isDataView=q;var K=typeof SharedArrayBuffer<"u"?SharedArrayBuffer:void 0;function V(f){return c(f)==="[object SharedArrayBuffer]"}function z(f){return typeof K>"u"?!1:(typeof V.working>"u"&&(V.working=V(new K)),V.working?V(f):f instanceof K)}t.isSharedArrayBuffer=z;function g(f){return c(f)==="[object AsyncFunction]"}t.isAsyncFunction=g;function m(f){return c(f)==="[object Map Iterator]"}t.isMapIterator=m;function M(f){return c(f)==="[object Set Iterator]"}t.isSetIterator=M;function P(f){return c(f)==="[object Generator]"}t.isGeneratorObject=P;function C(f){return c(f)==="[object WebAssembly.Module]"}t.isWebAssemblyCompiledModule=C;function I(f){return E(f,x)}t.isNumberObject=I;function J(f){return E(f,v)}t.isStringObject=J;function h(f){return E(f,S)}t.isBooleanObject=h;function Z(f){return s&&E(f,T)}t.isBigIntObject=Z;function b(f){return a&&E(f,w)}t.isSymbolObject=b;function n(f){return I(f)||J(f)||h(f)||Z(f)||b(f)}t.isBoxedPrimitive=n;function i(f){return typeof Uint8Array<"u"&&(H(f)||z(f))}t.isAnyArrayBuffer=i,["isProxy","isExternal","isModuleNamespaceObject"].forEach(function(f){Object.defineProperty(t,f,{enumerable:!1,value:function(){throw new Error(f+" is not supported in userland")}})})}(kr)),kr}var Gr,ja;function Zo(){return ja||(ja=1,Gr=function(e){return e&&typeof e=="object"&&typeof e.copy=="function"&&typeof e.fill=="function"&&typeof e.readUInt8=="function"}),Gr}var Ca;function Li(){return Ca||(Ca=1,function(t){var e=Object.getOwnPropertyDescriptors||function(q){for(var K=Object.keys(q),V={},z=0;z<K.length;z++)V[K[z]]=Object.getOwnPropertyDescriptor(q,K[z]);return V},r=/%[sdj%]/g;t.format=function(R){if(!F(R)){for(var q=[],K=0;K<arguments.length;K++)q.push(s(arguments[K]));return q.join(" ")}for(var K=1,V=arguments,z=V.length,g=String(R).replace(r,function(M){if(M==="%%")return"%";if(K>=z)return M;switch(M){case"%s":return String(V[K++]);case"%d":return Number(V[K++]);case"%j":try{return JSON.stringify(V[K++])}catch{return"[Circular]"}default:return M}}),m=V[K];K<z;m=V[++K])k(m)||!N(m)?g+=" "+m:g+=" "+s(m);return g},t.deprecate=function(R,q){if(typeof ke<"u"&&ke.noDeprecation===!0)return R;if(typeof ke>"u")return function(){return t.deprecate(R,q).apply(this,arguments)};var K=!1;function V(){if(!K){if(ke.throwDeprecation)throw new Error(q);ke.traceDeprecation?console.trace(q):console.error(q),K=!0}return R.apply(this,arguments)}return V};var l={},d=/^$/;if(ke.env.NODE_DEBUG){var o=ke.env.NODE_DEBUG;o=o.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),d=new RegExp("^"+o+"$","i")}t.debuglog=function(R){if(R=R.toUpperCase(),!l[R])if(d.test(R)){var q=ke.pid;l[R]=function(){var K=t.format.apply(t,arguments);console.error("%s %d: %s",R,q,K)}}else l[R]=function(){};return l[R]};function s(R,q){var K={seen:[],stylize:c};return arguments.length>=3&&(K.depth=arguments[2]),arguments.length>=4&&(K.colors=arguments[3]),p(q)?K.showHidden=q:q&&t._extend(K,q),W(K.showHidden)&&(K.showHidden=!1),W(K.depth)&&(K.depth=2),W(K.colors)&&(K.colors=!1),W(K.customInspect)&&(K.customInspect=!0),K.colors&&(K.stylize=a),v(K,R,K.depth)}t.inspect=s,s.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},s.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function a(R,q){var K=s.styles[q];return K?"\x1B["+s.colors[K][0]+"m"+R+"\x1B["+s.colors[K][1]+"m":R}function c(R,q){return R}function x(R){var q={};return R.forEach(function(K,V){q[K]=!0}),q}function v(R,q,K){if(R.customInspect&&q&&B(q.inspect)&&q.inspect!==t.inspect&&!(q.constructor&&q.constructor.prototype===q)){var V=q.inspect(K,R);return F(V)||(V=v(R,V,K)),V}var z=S(R,q);if(z)return z;var g=Object.keys(q),m=x(g);if(R.showHidden&&(g=Object.getOwnPropertyNames(q)),se(q)&&(g.indexOf("message")>=0||g.indexOf("description")>=0))return T(q);if(g.length===0){if(B(q)){var M=q.name?": "+q.name:"";return R.stylize("[Function"+M+"]","special")}if($(q))return R.stylize(RegExp.prototype.toString.call(q),"regexp");if(ne(q))return R.stylize(Date.prototype.toString.call(q),"date");if(se(q))return T(q)}var P="",C=!1,I=["{","}"];if(A(q)&&(C=!0,I=["[","]"]),B(q)){var J=q.name?": "+q.name:"";P=" [Function"+J+"]"}if($(q)&&(P=" "+RegExp.prototype.toString.call(q)),ne(q)&&(P=" "+Date.prototype.toUTCString.call(q)),se(q)&&(P=" "+T(q)),g.length===0&&(!C||q.length==0))return I[0]+P+I[1];if(K<0)return $(q)?R.stylize(RegExp.prototype.toString.call(q),"regexp"):R.stylize("[Object]","special");R.seen.push(q);var h;return C?h=w(R,q,K,m,g):h=g.map(function(Z){return E(R,q,K,m,Z,C)}),R.seen.pop(),y(h,P,I)}function S(R,q){if(W(q))return R.stylize("undefined","undefined");if(F(q)){var K="'"+JSON.stringify(q).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return R.stylize(K,"string")}if(O(q))return R.stylize(""+q,"number");if(p(q))return R.stylize(""+q,"boolean");if(k(q))return R.stylize("null","null")}function T(R){return"["+Error.prototype.toString.call(R)+"]"}function w(R,q,K,V,z){for(var g=[],m=0,M=q.length;m<M;++m)pe(q,String(m))?g.push(E(R,q,K,V,String(m),!0)):g.push("");return z.forEach(function(P){P.match(/^\d+$/)||g.push(E(R,q,K,V,P,!0))}),g}function E(R,q,K,V,z,g){var m,M,P;if(P=Object.getOwnPropertyDescriptor(q,z)||{value:q[z]},P.get?P.set?M=R.stylize("[Getter/Setter]","special"):M=R.stylize("[Getter]","special"):P.set&&(M=R.stylize("[Setter]","special")),pe(V,z)||(m="["+z+"]"),M||(R.seen.indexOf(P.value)<0?(k(K)?M=v(R,P.value,null):M=v(R,P.value,K-1),M.indexOf(`
`)>-1&&(g?M=M.split(`
`).map(function(C){return"  "+C}).join(`
`).slice(2):M=`
`+M.split(`
`).map(function(C){return"   "+C}).join(`
`))):M=R.stylize("[Circular]","special")),W(m)){if(g&&z.match(/^\d+$/))return M;m=JSON.stringify(""+z),m.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(m=m.slice(1,-1),m=R.stylize(m,"name")):(m=m.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),m=R.stylize(m,"string"))}return m+": "+M}function y(R,q,K){var V=R.reduce(function(z,g){return g.indexOf(`
`)>=0,z+g.replace(/\u001b\[\d\d?m/g,"").length+1},0);return V>60?K[0]+(q===""?"":q+`
 `)+" "+R.join(`,
  `)+" "+K[1]:K[0]+q+" "+R.join(", ")+" "+K[1]}t.types=Xo();function A(R){return Array.isArray(R)}t.isArray=A;function p(R){return typeof R=="boolean"}t.isBoolean=p;function k(R){return R===null}t.isNull=k;function j(R){return R==null}t.isNullOrUndefined=j;function O(R){return typeof R=="number"}t.isNumber=O;function F(R){return typeof R=="string"}t.isString=F;function G(R){return typeof R=="symbol"}t.isSymbol=G;function W(R){return R===void 0}t.isUndefined=W;function $(R){return N(R)&&_(R)==="[object RegExp]"}t.isRegExp=$,t.types.isRegExp=$;function N(R){return typeof R=="object"&&R!==null}t.isObject=N;function ne(R){return N(R)&&_(R)==="[object Date]"}t.isDate=ne,t.types.isDate=ne;function se(R){return N(R)&&(_(R)==="[object Error]"||R instanceof Error)}t.isError=se,t.types.isNativeError=se;function B(R){return typeof R=="function"}t.isFunction=B;function X(R){return R===null||typeof R=="boolean"||typeof R=="number"||typeof R=="string"||typeof R=="symbol"||typeof R>"u"}t.isPrimitive=X,t.isBuffer=Zo();function _(R){return Object.prototype.toString.call(R)}function Y(R){return R<10?"0"+R.toString(10):R.toString(10)}var de=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function Q(){var R=new Date,q=[Y(R.getHours()),Y(R.getMinutes()),Y(R.getSeconds())].join(":");return[R.getDate(),de[R.getMonth()],q].join(" ")}t.log=function(){console.log("%s - %s",Q(),t.format.apply(t,arguments))},t.inherits=pt,t._extend=function(R,q){if(!q||!N(q))return R;for(var K=Object.keys(q),V=K.length;V--;)R[K[V]]=q[K[V]];return R};function pe(R,q){return Object.prototype.hasOwnProperty.call(R,q)}var te=typeof Symbol<"u"?Symbol("util.promisify.custom"):void 0;t.promisify=function(q){if(typeof q!="function")throw new TypeError('The "original" argument must be of type Function');if(te&&q[te]){var K=q[te];if(typeof K!="function")throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(K,te,{value:K,enumerable:!1,writable:!1,configurable:!0}),K}function K(){for(var V,z,g=new Promise(function(P,C){V=P,z=C}),m=[],M=0;M<arguments.length;M++)m.push(arguments[M]);m.push(function(P,C){P?z(P):V(C)});try{q.apply(this,m)}catch(P){z(P)}return g}return Object.setPrototypeOf(K,Object.getPrototypeOf(q)),te&&Object.defineProperty(K,te,{value:K,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(K,e(q))},t.promisify.custom=te;function fe(R,q){if(!R){var K=new Error("Promise was rejected with a falsy value");K.reason=R,R=K}return q(R)}function H(R){if(typeof R!="function")throw new TypeError('The "original" argument must be of type Function');function q(){for(var K=[],V=0;V<arguments.length;V++)K.push(arguments[V]);var z=K.pop();if(typeof z!="function")throw new TypeError("The last argument must be of type Function");var g=this,m=function(){return z.apply(g,arguments)};R.apply(this,K).then(function(M){ke.nextTick(m.bind(null,null,M))},function(M){ke.nextTick(fe.bind(null,M,m))})}return Object.setPrototypeOf(q,Object.getPrototypeOf(R)),Object.defineProperties(q,e(R)),q}t.callbackify=H}(vr)),vr}var Kr,Ra;function Yo(){if(Ra)return Kr;Ra=1;function t(T,w){var E=Object.keys(T);if(Object.getOwnPropertySymbols){var y=Object.getOwnPropertySymbols(T);w&&(y=y.filter(function(A){return Object.getOwnPropertyDescriptor(T,A).enumerable})),E.push.apply(E,y)}return E}function e(T){for(var w=1;w<arguments.length;w++){var E=arguments[w]!=null?arguments[w]:{};w%2?t(Object(E),!0).forEach(function(y){r(T,y,E[y])}):Object.getOwnPropertyDescriptors?Object.defineProperties(T,Object.getOwnPropertyDescriptors(E)):t(Object(E)).forEach(function(y){Object.defineProperty(T,y,Object.getOwnPropertyDescriptor(E,y))})}return T}function r(T,w,E){return w in T?Object.defineProperty(T,w,{value:E,enumerable:!0,configurable:!0,writable:!0}):T[w]=E,T}function l(T,w){if(!(T instanceof w))throw new TypeError("Cannot call a class as a function")}function d(T,w){for(var E=0;E<w.length;E++){var y=w[E];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(T,y.key,y)}}function o(T,w,E){return w&&d(T.prototype,w),T}var s=dr(),a=s.Buffer,c=Li(),x=c.inspect,v=x&&x.custom||"inspect";function S(T,w,E){a.prototype.copy.call(T,w,E)}return Kr=function(){function T(){l(this,T),this.head=null,this.tail=null,this.length=0}return o(T,[{key:"push",value:function(E){var y={data:E,next:null};this.length>0?this.tail.next=y:this.head=y,this.tail=y,++this.length}},{key:"unshift",value:function(E){var y={data:E,next:this.head};this.length===0&&(this.tail=y),this.head=y,++this.length}},{key:"shift",value:function(){if(this.length!==0){var E=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,E}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(E){if(this.length===0)return"";for(var y=this.head,A=""+y.data;y=y.next;)A+=E+y.data;return A}},{key:"concat",value:function(E){if(this.length===0)return a.alloc(0);for(var y=a.allocUnsafe(E>>>0),A=this.head,p=0;A;)S(A.data,y,p),p+=A.data.length,A=A.next;return y}},{key:"consume",value:function(E,y){var A;return E<this.head.data.length?(A=this.head.data.slice(0,E),this.head.data=this.head.data.slice(E)):E===this.head.data.length?A=this.shift():A=y?this._getString(E):this._getBuffer(E),A}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(E){var y=this.head,A=1,p=y.data;for(E-=p.length;y=y.next;){var k=y.data,j=E>k.length?k.length:E;if(j===k.length?p+=k:p+=k.slice(0,E),E-=j,E===0){j===k.length?(++A,y.next?this.head=y.next:this.head=this.tail=null):(this.head=y,y.data=k.slice(j));break}++A}return this.length-=A,p}},{key:"_getBuffer",value:function(E){var y=a.allocUnsafe(E),A=this.head,p=1;for(A.data.copy(y),E-=A.data.length;A=A.next;){var k=A.data,j=E>k.length?k.length:E;if(k.copy(y,y.length-E,0,j),E-=j,E===0){j===k.length?(++p,A.next?this.head=A.next:this.head=this.tail=null):(this.head=A,A.data=k.slice(j));break}++p}return this.length-=p,y}},{key:v,value:function(E,y){return x(this,e({},y,{depth:0,customInspect:!1}))}}]),T}(),Kr}var qr,Ia;function Mi(){if(Ia)return qr;Ia=1;function t(s,a){var c=this,x=this._readableState&&this._readableState.destroyed,v=this._writableState&&this._writableState.destroyed;return x||v?(a?a(s):s&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,ke.nextTick(d,this,s)):ke.nextTick(d,this,s)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(s||null,function(S){!a&&S?c._writableState?c._writableState.errorEmitted?ke.nextTick(r,c):(c._writableState.errorEmitted=!0,ke.nextTick(e,c,S)):ke.nextTick(e,c,S):a?(ke.nextTick(r,c),a(S)):ke.nextTick(r,c)}),this)}function e(s,a){d(s,a),r(s)}function r(s){s._writableState&&!s._writableState.emitClose||s._readableState&&!s._readableState.emitClose||s.emit("close")}function l(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function d(s,a){s.emit("error",a)}function o(s,a){var c=s._readableState,x=s._writableState;c&&c.autoDestroy||x&&x.autoDestroy?s.destroy(a):s.emit("error",a)}return qr={destroy:t,undestroy:l,errorOrDestroy:o},qr}var Vr={},Fa;function Ct(){if(Fa)return Vr;Fa=1;function t(a,c){a.prototype=Object.create(c.prototype),a.prototype.constructor=a,a.__proto__=c}var e={};function r(a,c,x){x||(x=Error);function v(T,w,E){return typeof c=="string"?c:c(T,w,E)}var S=function(T){t(w,T);function w(E,y,A){return T.call(this,v(E,y,A))||this}return w}(x);S.prototype.name=x.name,S.prototype.code=a,e[a]=S}function l(a,c){if(Array.isArray(a)){var x=a.length;return a=a.map(function(v){return String(v)}),x>2?"one of ".concat(c," ").concat(a.slice(0,x-1).join(", "),", or ")+a[x-1]:x===2?"one of ".concat(c," ").concat(a[0]," or ").concat(a[1]):"of ".concat(c," ").concat(a[0])}else return"of ".concat(c," ").concat(String(a))}function d(a,c,x){return a.substr(0,c.length)===c}function o(a,c,x){return(x===void 0||x>a.length)&&(x=a.length),a.substring(x-c.length,x)===c}function s(a,c,x){return typeof x!="number"&&(x=0),x+c.length>a.length?!1:a.indexOf(c,x)!==-1}return r("ERR_INVALID_OPT_VALUE",function(a,c){return'The value "'+c+'" is invalid for option "'+a+'"'},TypeError),r("ERR_INVALID_ARG_TYPE",function(a,c,x){var v;typeof c=="string"&&d(c,"not ")?(v="must not be",c=c.replace(/^not /,"")):v="must be";var S;if(o(a," argument"))S="The ".concat(a," ").concat(v," ").concat(l(c,"type"));else{var T=s(a,".")?"property":"argument";S='The "'.concat(a,'" ').concat(T," ").concat(v," ").concat(l(c,"type"))}return S+=". Received type ".concat(typeof x),S},TypeError),r("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),r("ERR_METHOD_NOT_IMPLEMENTED",function(a){return"The "+a+" method is not implemented"}),r("ERR_STREAM_PREMATURE_CLOSE","Premature close"),r("ERR_STREAM_DESTROYED",function(a){return"Cannot call "+a+" after a stream was destroyed"}),r("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),r("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),r("ERR_STREAM_WRITE_AFTER_END","write after end"),r("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),r("ERR_UNKNOWN_ENCODING",function(a){return"Unknown encoding: "+a},TypeError),r("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),Vr.codes=e,Vr}var $r,Oa;function zi(){if(Oa)return $r;Oa=1;var t=Ct().codes.ERR_INVALID_OPT_VALUE;function e(l,d,o){return l.highWaterMark!=null?l.highWaterMark:d?l[o]:null}function r(l,d,o,s){var a=e(d,s,o);if(a!=null){if(!(isFinite(a)&&Math.floor(a)===a)||a<0){var c=s?o:"highWaterMark";throw new t(c,a)}return Math.floor(a)}return l.objectMode?16:16*1024}return $r={getHighWaterMark:r},$r}var Xr,Pa;function Jo(){if(Pa)return Xr;Pa=1,Xr=t;function t(r,l){if(e("noDeprecation"))return r;var d=!1;function o(){if(!d){if(e("throwDeprecation"))throw new Error(l);e("traceDeprecation")?console.trace(l):console.warn(l),d=!0}return r.apply(this,arguments)}return o}function e(r){try{if(!Qe.localStorage)return!1}catch{return!1}var l=Qe.localStorage[r];return l==null?!1:String(l).toLowerCase()==="true"}return Xr}var Zr,Da;function Ui(){if(Da)return Zr;Da=1,Zr=$;function t(z){var g=this;this.next=null,this.entry=null,this.finish=function(){V(g,z)}}var e;$.WritableState=G;var r={deprecate:Jo()},l=Ii(),d=dr().Buffer,o=Qe.Uint8Array||function(){};function s(z){return d.from(z)}function a(z){return d.isBuffer(z)||z instanceof o}var c=Mi(),x=zi(),v=x.getHighWaterMark,S=Ct().codes,T=S.ERR_INVALID_ARG_TYPE,w=S.ERR_METHOD_NOT_IMPLEMENTED,E=S.ERR_MULTIPLE_CALLBACK,y=S.ERR_STREAM_CANNOT_PIPE,A=S.ERR_STREAM_DESTROYED,p=S.ERR_STREAM_NULL_VALUES,k=S.ERR_STREAM_WRITE_AFTER_END,j=S.ERR_UNKNOWN_ENCODING,O=c.errorOrDestroy;pt($,l);function F(){}function G(z,g,m){e=e||Et(),z=z||{},typeof m!="boolean"&&(m=g instanceof e),this.objectMode=!!z.objectMode,m&&(this.objectMode=this.objectMode||!!z.writableObjectMode),this.highWaterMark=v(this,z,"writableHighWaterMark",m),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var M=z.decodeStrings===!1;this.decodeStrings=!M,this.defaultEncoding=z.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(P){de(g,P)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=z.emitClose!==!1,this.autoDestroy=!!z.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new t(this)}G.prototype.getBuffer=function(){for(var g=this.bufferedRequest,m=[];g;)m.push(g),g=g.next;return m},function(){try{Object.defineProperty(G.prototype,"buffer",{get:r.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}}();var W;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(W=Function.prototype[Symbol.hasInstance],Object.defineProperty($,Symbol.hasInstance,{value:function(g){return W.call(this,g)?!0:this!==$?!1:g&&g._writableState instanceof G}})):W=function(g){return g instanceof this};function $(z){e=e||Et();var g=this instanceof e;if(!g&&!W.call($,this))return new $(z);this._writableState=new G(z,this,g),this.writable=!0,z&&(typeof z.write=="function"&&(this._write=z.write),typeof z.writev=="function"&&(this._writev=z.writev),typeof z.destroy=="function"&&(this._destroy=z.destroy),typeof z.final=="function"&&(this._final=z.final)),l.call(this)}$.prototype.pipe=function(){O(this,new y)};function N(z,g){var m=new k;O(z,m),ke.nextTick(g,m)}function ne(z,g,m,M){var P;return m===null?P=new p:typeof m!="string"&&!g.objectMode&&(P=new T("chunk",["string","Buffer"],m)),P?(O(z,P),ke.nextTick(M,P),!1):!0}$.prototype.write=function(z,g,m){var M=this._writableState,P=!1,C=!M.objectMode&&a(z);return C&&!d.isBuffer(z)&&(z=s(z)),typeof g=="function"&&(m=g,g=null),C?g="buffer":g||(g=M.defaultEncoding),typeof m!="function"&&(m=F),M.ending?N(this,m):(C||ne(this,M,z,m))&&(M.pendingcb++,P=B(this,M,C,z,g,m)),P},$.prototype.cork=function(){this._writableState.corked++},$.prototype.uncork=function(){var z=this._writableState;z.corked&&(z.corked--,!z.writing&&!z.corked&&!z.bufferProcessing&&z.bufferedRequest&&te(this,z))},$.prototype.setDefaultEncoding=function(g){if(typeof g=="string"&&(g=g.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((g+"").toLowerCase())>-1))throw new j(g);return this._writableState.defaultEncoding=g,this},Object.defineProperty($.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function se(z,g,m){return!z.objectMode&&z.decodeStrings!==!1&&typeof g=="string"&&(g=d.from(g,m)),g}Object.defineProperty($.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function B(z,g,m,M,P,C){if(!m){var I=se(g,M,P);M!==I&&(m=!0,P="buffer",M=I)}var J=g.objectMode?1:M.length;g.length+=J;var h=g.length<g.highWaterMark;if(h||(g.needDrain=!0),g.writing||g.corked){var Z=g.lastBufferedRequest;g.lastBufferedRequest={chunk:M,encoding:P,isBuf:m,callback:C,next:null},Z?Z.next=g.lastBufferedRequest:g.bufferedRequest=g.lastBufferedRequest,g.bufferedRequestCount+=1}else X(z,g,!1,J,M,P,C);return h}function X(z,g,m,M,P,C,I){g.writelen=M,g.writecb=I,g.writing=!0,g.sync=!0,g.destroyed?g.onwrite(new A("write")):m?z._writev(P,g.onwrite):z._write(P,C,g.onwrite),g.sync=!1}function _(z,g,m,M,P){--g.pendingcb,m?(ke.nextTick(P,M),ke.nextTick(q,z,g),z._writableState.errorEmitted=!0,O(z,M)):(P(M),z._writableState.errorEmitted=!0,O(z,M),q(z,g))}function Y(z){z.writing=!1,z.writecb=null,z.length-=z.writelen,z.writelen=0}function de(z,g){var m=z._writableState,M=m.sync,P=m.writecb;if(typeof P!="function")throw new E;if(Y(m),g)_(z,m,M,g,P);else{var C=fe(m)||z.destroyed;!C&&!m.corked&&!m.bufferProcessing&&m.bufferedRequest&&te(z,m),M?ke.nextTick(Q,z,m,C,P):Q(z,m,C,P)}}function Q(z,g,m,M){m||pe(z,g),g.pendingcb--,M(),q(z,g)}function pe(z,g){g.length===0&&g.needDrain&&(g.needDrain=!1,z.emit("drain"))}function te(z,g){g.bufferProcessing=!0;var m=g.bufferedRequest;if(z._writev&&m&&m.next){var M=g.bufferedRequestCount,P=new Array(M),C=g.corkedRequestsFree;C.entry=m;for(var I=0,J=!0;m;)P[I]=m,m.isBuf||(J=!1),m=m.next,I+=1;P.allBuffers=J,X(z,g,!0,g.length,P,"",C.finish),g.pendingcb++,g.lastBufferedRequest=null,C.next?(g.corkedRequestsFree=C.next,C.next=null):g.corkedRequestsFree=new t(g),g.bufferedRequestCount=0}else{for(;m;){var h=m.chunk,Z=m.encoding,b=m.callback,n=g.objectMode?1:h.length;if(X(z,g,!1,n,h,Z,b),m=m.next,g.bufferedRequestCount--,g.writing)break}m===null&&(g.lastBufferedRequest=null)}g.bufferedRequest=m,g.bufferProcessing=!1}$.prototype._write=function(z,g,m){m(new w("_write()"))},$.prototype._writev=null,$.prototype.end=function(z,g,m){var M=this._writableState;return typeof z=="function"?(m=z,z=null,g=null):typeof g=="function"&&(m=g,g=null),z!=null&&this.write(z,g),M.corked&&(M.corked=1,this.uncork()),M.ending||K(this,M,m),this},Object.defineProperty($.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function fe(z){return z.ending&&z.length===0&&z.bufferedRequest===null&&!z.finished&&!z.writing}function H(z,g){z._final(function(m){g.pendingcb--,m&&O(z,m),g.prefinished=!0,z.emit("prefinish"),q(z,g)})}function R(z,g){!g.prefinished&&!g.finalCalled&&(typeof z._final=="function"&&!g.destroyed?(g.pendingcb++,g.finalCalled=!0,ke.nextTick(H,z,g)):(g.prefinished=!0,z.emit("prefinish")))}function q(z,g){var m=fe(g);if(m&&(R(z,g),g.pendingcb===0&&(g.finished=!0,z.emit("finish"),g.autoDestroy))){var M=z._readableState;(!M||M.autoDestroy&&M.endEmitted)&&z.destroy()}return m}function K(z,g,m){g.ending=!0,q(z,g),m&&(g.finished?ke.nextTick(m):z.once("finish",m)),g.ended=!0,z.writable=!1}function V(z,g,m){var M=z.entry;for(z.entry=null;M;){var P=M.callback;g.pendingcb--,P(m),M=M.next}g.corkedRequestsFree.next=z}return Object.defineProperty($.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(g){this._writableState&&(this._writableState.destroyed=g)}}),$.prototype.destroy=c.destroy,$.prototype._undestroy=c.undestroy,$.prototype._destroy=function(z,g){g(z)},Zr}var Yr,Ba;function Et(){if(Ba)return Yr;Ba=1;var t=Object.keys||function(x){var v=[];for(var S in x)v.push(S);return v};Yr=s;var e=Wi(),r=Ui();pt(s,e);for(var l=t(r.prototype),d=0;d<l.length;d++){var o=l[d];s.prototype[o]||(s.prototype[o]=r.prototype[o])}function s(x){if(!(this instanceof s))return new s(x);e.call(this,x),r.call(this,x),this.allowHalfOpen=!0,x&&(x.readable===!1&&(this.readable=!1),x.writable===!1&&(this.writable=!1),x.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",a)))}Object.defineProperty(s.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(s.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(s.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function a(){this._writableState.ended||ke.nextTick(c,this)}function c(x){x.end()}return Object.defineProperty(s.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(v){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=v,this._writableState.destroyed=v)}}),Yr}var Jr={},Vt={exports:{}},La;function Qo(){return La||(La=1,function(t,e){var r=dr(),l=r.Buffer;function d(s,a){for(var c in s)a[c]=s[c]}l.from&&l.alloc&&l.allocUnsafe&&l.allocUnsafeSlow?t.exports=r:(d(r,e),e.Buffer=o);function o(s,a,c){return l(s,a,c)}d(l,o),o.from=function(s,a,c){if(typeof s=="number")throw new TypeError("Argument must not be a number");return l(s,a,c)},o.alloc=function(s,a,c){if(typeof s!="number")throw new TypeError("Argument must be a number");var x=l(s);return a!==void 0?typeof c=="string"?x.fill(a,c):x.fill(a):x.fill(0),x},o.allocUnsafe=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return l(s)},o.allocUnsafeSlow=function(s){if(typeof s!="number")throw new TypeError("Argument must be a number");return r.SlowBuffer(s)}}(Vt,Vt.exports)),Vt.exports}var Ma;function yn(){if(Ma)return Jr;Ma=1;var t=Qo().Buffer,e=t.isEncoding||function(p){switch(p=""+p,p&&p.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function r(p){if(!p)return"utf8";for(var k;;)switch(p){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return p;default:if(k)return;p=(""+p).toLowerCase(),k=!0}}function l(p){var k=r(p);if(typeof k!="string"&&(t.isEncoding===e||!e(p)))throw new Error("Unknown encoding: "+p);return k||p}Jr.StringDecoder=d;function d(p){this.encoding=l(p);var k;switch(this.encoding){case"utf16le":this.text=S,this.end=T,k=4;break;case"utf8":this.fillLast=c,k=4;break;case"base64":this.text=w,this.end=E,k=3;break;default:this.write=y,this.end=A;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=t.allocUnsafe(k)}d.prototype.write=function(p){if(p.length===0)return"";var k,j;if(this.lastNeed){if(k=this.fillLast(p),k===void 0)return"";j=this.lastNeed,this.lastNeed=0}else j=0;return j<p.length?k?k+this.text(p,j):this.text(p,j):k||""},d.prototype.end=v,d.prototype.text=x,d.prototype.fillLast=function(p){if(this.lastNeed<=p.length)return p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,this.lastTotal-this.lastNeed,0,p.length),this.lastNeed-=p.length};function o(p){return p<=127?0:p>>5===6?2:p>>4===14?3:p>>3===30?4:p>>6===2?-1:-2}function s(p,k,j){var O=k.length-1;if(O<j)return 0;var F=o(k[O]);return F>=0?(F>0&&(p.lastNeed=F-1),F):--O<j||F===-2?0:(F=o(k[O]),F>=0?(F>0&&(p.lastNeed=F-2),F):--O<j||F===-2?0:(F=o(k[O]),F>=0?(F>0&&(F===2?F=0:p.lastNeed=F-3),F):0))}function a(p,k,j){if((k[0]&192)!==128)return p.lastNeed=0,"";if(p.lastNeed>1&&k.length>1){if((k[1]&192)!==128)return p.lastNeed=1,"";if(p.lastNeed>2&&k.length>2&&(k[2]&192)!==128)return p.lastNeed=2,""}}function c(p){var k=this.lastTotal-this.lastNeed,j=a(this,p);if(j!==void 0)return j;if(this.lastNeed<=p.length)return p.copy(this.lastChar,k,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);p.copy(this.lastChar,k,0,p.length),this.lastNeed-=p.length}function x(p,k){var j=s(this,p,k);if(!this.lastNeed)return p.toString("utf8",k);this.lastTotal=j;var O=p.length-(j-this.lastNeed);return p.copy(this.lastChar,0,O),p.toString("utf8",k,O)}function v(p){var k=p&&p.length?this.write(p):"";return this.lastNeed?k+"":k}function S(p,k){if((p.length-k)%2===0){var j=p.toString("utf16le",k);if(j){var O=j.charCodeAt(j.length-1);if(O>=55296&&O<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1],j.slice(0,-1)}return j}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=p[p.length-1],p.toString("utf16le",k,p.length-1)}function T(p){var k=p&&p.length?this.write(p):"";if(this.lastNeed){var j=this.lastTotal-this.lastNeed;return k+this.lastChar.toString("utf16le",0,j)}return k}function w(p,k){var j=(p.length-k)%3;return j===0?p.toString("base64",k):(this.lastNeed=3-j,this.lastTotal=3,j===1?this.lastChar[0]=p[p.length-1]:(this.lastChar[0]=p[p.length-2],this.lastChar[1]=p[p.length-1]),p.toString("base64",k,p.length-j))}function E(p){var k=p&&p.length?this.write(p):"";return this.lastNeed?k+this.lastChar.toString("base64",0,3-this.lastNeed):k}function y(p){return p.toString(this.encoding)}function A(p){return p&&p.length?this.write(p):""}return Jr}var Qr,za;function In(){if(za)return Qr;za=1;var t=Ct().codes.ERR_STREAM_PREMATURE_CLOSE;function e(o){var s=!1;return function(){if(!s){s=!0;for(var a=arguments.length,c=new Array(a),x=0;x<a;x++)c[x]=arguments[x];o.apply(this,c)}}}function r(){}function l(o){return o.setHeader&&typeof o.abort=="function"}function d(o,s,a){if(typeof s=="function")return d(o,null,s);s||(s={}),a=e(a||r);var c=s.readable||s.readable!==!1&&o.readable,x=s.writable||s.writable!==!1&&o.writable,v=function(){o.writable||T()},S=o._writableState&&o._writableState.finished,T=function(){x=!1,S=!0,c||a.call(o)},w=o._readableState&&o._readableState.endEmitted,E=function(){c=!1,w=!0,x||a.call(o)},y=function(j){a.call(o,j)},A=function(){var j;if(c&&!w)return(!o._readableState||!o._readableState.ended)&&(j=new t),a.call(o,j);if(x&&!S)return(!o._writableState||!o._writableState.ended)&&(j=new t),a.call(o,j)},p=function(){o.req.on("finish",T)};return l(o)?(o.on("complete",T),o.on("abort",A),o.req?p():o.on("request",p)):x&&!o._writableState&&(o.on("end",v),o.on("close",v)),o.on("end",E),o.on("finish",T),s.error!==!1&&o.on("error",y),o.on("close",A),function(){o.removeListener("complete",T),o.removeListener("abort",A),o.removeListener("request",p),o.req&&o.req.removeListener("finish",T),o.removeListener("end",v),o.removeListener("close",v),o.removeListener("finish",T),o.removeListener("end",E),o.removeListener("error",y),o.removeListener("close",A)}}return Qr=d,Qr}var en,Ua;function el(){if(Ua)return en;Ua=1;var t;function e(p,k,j){return k in p?Object.defineProperty(p,k,{value:j,enumerable:!0,configurable:!0,writable:!0}):p[k]=j,p}var r=In(),l=Symbol("lastResolve"),d=Symbol("lastReject"),o=Symbol("error"),s=Symbol("ended"),a=Symbol("lastPromise"),c=Symbol("handlePromise"),x=Symbol("stream");function v(p,k){return{value:p,done:k}}function S(p){var k=p[l];if(k!==null){var j=p[x].read();j!==null&&(p[a]=null,p[l]=null,p[d]=null,k(v(j,!1)))}}function T(p){ke.nextTick(S,p)}function w(p,k){return function(j,O){p.then(function(){if(k[s]){j(v(void 0,!0));return}k[c](j,O)},O)}}var E=Object.getPrototypeOf(function(){}),y=Object.setPrototypeOf((t={get stream(){return this[x]},next:function(){var k=this,j=this[o];if(j!==null)return Promise.reject(j);if(this[s])return Promise.resolve(v(void 0,!0));if(this[x].destroyed)return new Promise(function(W,$){ke.nextTick(function(){k[o]?$(k[o]):W(v(void 0,!0))})});var O=this[a],F;if(O)F=new Promise(w(O,this));else{var G=this[x].read();if(G!==null)return Promise.resolve(v(G,!1));F=new Promise(this[c])}return this[a]=F,F}},e(t,Symbol.asyncIterator,function(){return this}),e(t,"return",function(){var k=this;return new Promise(function(j,O){k[x].destroy(null,function(F){if(F){O(F);return}j(v(void 0,!0))})})}),t),E),A=function(k){var j,O=Object.create(y,(j={},e(j,x,{value:k,writable:!0}),e(j,l,{value:null,writable:!0}),e(j,d,{value:null,writable:!0}),e(j,o,{value:null,writable:!0}),e(j,s,{value:k._readableState.endEmitted,writable:!0}),e(j,c,{value:function(G,W){var $=O[x].read();$?(O[a]=null,O[l]=null,O[d]=null,G(v($,!1))):(O[l]=G,O[d]=W)},writable:!0}),j));return O[a]=null,r(k,function(F){if(F&&F.code!=="ERR_STREAM_PREMATURE_CLOSE"){var G=O[d];G!==null&&(O[a]=null,O[l]=null,O[d]=null,G(F)),O[o]=F;return}var W=O[l];W!==null&&(O[a]=null,O[l]=null,O[d]=null,W(v(void 0,!0))),O[s]=!0}),k.on("readable",T.bind(null,O)),O};return en=A,en}var tn,Wa;function tl(){return Wa||(Wa=1,tn=function(){throw new Error("Readable.from is not available in the browser")}),tn}var rn,Ha;function Wi(){if(Ha)return rn;Ha=1,rn=N;var t;N.ReadableState=$,Nn.EventEmitter;var e=function(I,J){return I.listeners(J).length},r=Ii(),l=dr().Buffer,d=Qe.Uint8Array||function(){};function o(C){return l.from(C)}function s(C){return l.isBuffer(C)||C instanceof d}var a=Li(),c;a&&a.debuglog?c=a.debuglog("stream"):c=function(){};var x=Yo(),v=Mi(),S=zi(),T=S.getHighWaterMark,w=Ct().codes,E=w.ERR_INVALID_ARG_TYPE,y=w.ERR_STREAM_PUSH_AFTER_EOF,A=w.ERR_METHOD_NOT_IMPLEMENTED,p=w.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,k,j,O;pt(N,r);var F=v.errorOrDestroy,G=["error","close","destroy","pause","resume"];function W(C,I,J){if(typeof C.prependListener=="function")return C.prependListener(I,J);!C._events||!C._events[I]?C.on(I,J):Array.isArray(C._events[I])?C._events[I].unshift(J):C._events[I]=[J,C._events[I]]}function $(C,I,J){t=t||Et(),C=C||{},typeof J!="boolean"&&(J=I instanceof t),this.objectMode=!!C.objectMode,J&&(this.objectMode=this.objectMode||!!C.readableObjectMode),this.highWaterMark=T(this,C,"readableHighWaterMark",J),this.buffer=new x,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=C.emitClose!==!1,this.autoDestroy=!!C.autoDestroy,this.destroyed=!1,this.defaultEncoding=C.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,C.encoding&&(k||(k=yn().StringDecoder),this.decoder=new k(C.encoding),this.encoding=C.encoding)}function N(C){if(t=t||Et(),!(this instanceof N))return new N(C);var I=this instanceof t;this._readableState=new $(C,this,I),this.readable=!0,C&&(typeof C.read=="function"&&(this._read=C.read),typeof C.destroy=="function"&&(this._destroy=C.destroy)),r.call(this)}Object.defineProperty(N.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(I){this._readableState&&(this._readableState.destroyed=I)}}),N.prototype.destroy=v.destroy,N.prototype._undestroy=v.undestroy,N.prototype._destroy=function(C,I){I(C)},N.prototype.push=function(C,I){var J=this._readableState,h;return J.objectMode?h=!0:typeof C=="string"&&(I=I||J.defaultEncoding,I!==J.encoding&&(C=l.from(C,I),I=""),h=!0),ne(this,C,I,!1,h)},N.prototype.unshift=function(C){return ne(this,C,null,!0,!1)};function ne(C,I,J,h,Z){c("readableAddChunk",I);var b=C._readableState;if(I===null)b.reading=!1,de(C,b);else{var n;if(Z||(n=B(b,I)),n)F(C,n);else if(b.objectMode||I&&I.length>0)if(typeof I!="string"&&!b.objectMode&&Object.getPrototypeOf(I)!==l.prototype&&(I=o(I)),h)b.endEmitted?F(C,new p):se(C,b,I,!0);else if(b.ended)F(C,new y);else{if(b.destroyed)return!1;b.reading=!1,b.decoder&&!J?(I=b.decoder.write(I),b.objectMode||I.length!==0?se(C,b,I,!1):te(C,b)):se(C,b,I,!1)}else h||(b.reading=!1,te(C,b))}return!b.ended&&(b.length<b.highWaterMark||b.length===0)}function se(C,I,J,h){I.flowing&&I.length===0&&!I.sync?(I.awaitDrain=0,C.emit("data",J)):(I.length+=I.objectMode?1:J.length,h?I.buffer.unshift(J):I.buffer.push(J),I.needReadable&&Q(C)),te(C,I)}function B(C,I){var J;return!s(I)&&typeof I!="string"&&I!==void 0&&!C.objectMode&&(J=new E("chunk",["string","Buffer","Uint8Array"],I)),J}N.prototype.isPaused=function(){return this._readableState.flowing===!1},N.prototype.setEncoding=function(C){k||(k=yn().StringDecoder);var I=new k(C);this._readableState.decoder=I,this._readableState.encoding=this._readableState.decoder.encoding;for(var J=this._readableState.buffer.head,h="";J!==null;)h+=I.write(J.data),J=J.next;return this._readableState.buffer.clear(),h!==""&&this._readableState.buffer.push(h),this._readableState.length=h.length,this};var X=1073741824;function _(C){return C>=X?C=X:(C--,C|=C>>>1,C|=C>>>2,C|=C>>>4,C|=C>>>8,C|=C>>>16,C++),C}function Y(C,I){return C<=0||I.length===0&&I.ended?0:I.objectMode?1:C!==C?I.flowing&&I.length?I.buffer.head.data.length:I.length:(C>I.highWaterMark&&(I.highWaterMark=_(C)),C<=I.length?C:I.ended?I.length:(I.needReadable=!0,0))}N.prototype.read=function(C){c("read",C),C=parseInt(C,10);var I=this._readableState,J=C;if(C!==0&&(I.emittedReadable=!1),C===0&&I.needReadable&&((I.highWaterMark!==0?I.length>=I.highWaterMark:I.length>0)||I.ended))return c("read: emitReadable",I.length,I.ended),I.length===0&&I.ended?m(this):Q(this),null;if(C=Y(C,I),C===0&&I.ended)return I.length===0&&m(this),null;var h=I.needReadable;c("need readable",h),(I.length===0||I.length-C<I.highWaterMark)&&(h=!0,c("length less than watermark",h)),I.ended||I.reading?(h=!1,c("reading or ended",h)):h&&(c("do read"),I.reading=!0,I.sync=!0,I.length===0&&(I.needReadable=!0),this._read(I.highWaterMark),I.sync=!1,I.reading||(C=Y(J,I)));var Z;return C>0?Z=g(C,I):Z=null,Z===null?(I.needReadable=I.length<=I.highWaterMark,C=0):(I.length-=C,I.awaitDrain=0),I.length===0&&(I.ended||(I.needReadable=!0),J!==C&&I.ended&&m(this)),Z!==null&&this.emit("data",Z),Z};function de(C,I){if(c("onEofChunk"),!I.ended){if(I.decoder){var J=I.decoder.end();J&&J.length&&(I.buffer.push(J),I.length+=I.objectMode?1:J.length)}I.ended=!0,I.sync?Q(C):(I.needReadable=!1,I.emittedReadable||(I.emittedReadable=!0,pe(C)))}}function Q(C){var I=C._readableState;c("emitReadable",I.needReadable,I.emittedReadable),I.needReadable=!1,I.emittedReadable||(c("emitReadable",I.flowing),I.emittedReadable=!0,ke.nextTick(pe,C))}function pe(C){var I=C._readableState;c("emitReadable_",I.destroyed,I.length,I.ended),!I.destroyed&&(I.length||I.ended)&&(C.emit("readable"),I.emittedReadable=!1),I.needReadable=!I.flowing&&!I.ended&&I.length<=I.highWaterMark,z(C)}function te(C,I){I.readingMore||(I.readingMore=!0,ke.nextTick(fe,C,I))}function fe(C,I){for(;!I.reading&&!I.ended&&(I.length<I.highWaterMark||I.flowing&&I.length===0);){var J=I.length;if(c("maybeReadMore read 0"),C.read(0),J===I.length)break}I.readingMore=!1}N.prototype._read=function(C){F(this,new A("_read()"))},N.prototype.pipe=function(C,I){var J=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=C;break;case 1:h.pipes=[h.pipes,C];break;default:h.pipes.push(C);break}h.pipesCount+=1,c("pipe count=%d opts=%j",h.pipesCount,I);var Z=(!I||I.end!==!1)&&C!==ke.stdout&&C!==ke.stderr,b=Z?i:he;h.endEmitted?ke.nextTick(b):J.once("end",b),C.on("unpipe",n);function n(ge,ye){c("onunpipe"),ge===J&&ye&&ye.hasUnpiped===!1&&(ye.hasUnpiped=!0,U())}function i(){c("onend"),C.end()}var f=H(J);C.on("drain",f);var D=!1;function U(){c("cleanup"),C.removeListener("close",le),C.removeListener("finish",ae),C.removeListener("drain",f),C.removeListener("error",re),C.removeListener("unpipe",n),J.removeListener("end",i),J.removeListener("end",he),J.removeListener("data",L),D=!0,h.awaitDrain&&(!C._writableState||C._writableState.needDrain)&&f()}J.on("data",L);function L(ge){c("ondata");var ye=C.write(ge);c("dest.write",ye),ye===!1&&((h.pipesCount===1&&h.pipes===C||h.pipesCount>1&&P(h.pipes,C)!==-1)&&!D&&(c("false write response, pause",h.awaitDrain),h.awaitDrain++),J.pause())}function re(ge){c("onerror",ge),he(),C.removeListener("error",re),e(C,"error")===0&&F(C,ge)}W(C,"error",re);function le(){C.removeListener("finish",ae),he()}C.once("close",le);function ae(){c("onfinish"),C.removeListener("close",le),he()}C.once("finish",ae);function he(){c("unpipe"),J.unpipe(C)}return C.emit("pipe",J),h.flowing||(c("pipe resume"),J.resume()),C};function H(C){return function(){var J=C._readableState;c("pipeOnDrain",J.awaitDrain),J.awaitDrain&&J.awaitDrain--,J.awaitDrain===0&&e(C,"data")&&(J.flowing=!0,z(C))}}N.prototype.unpipe=function(C){var I=this._readableState,J={hasUnpiped:!1};if(I.pipesCount===0)return this;if(I.pipesCount===1)return C&&C!==I.pipes?this:(C||(C=I.pipes),I.pipes=null,I.pipesCount=0,I.flowing=!1,C&&C.emit("unpipe",this,J),this);if(!C){var h=I.pipes,Z=I.pipesCount;I.pipes=null,I.pipesCount=0,I.flowing=!1;for(var b=0;b<Z;b++)h[b].emit("unpipe",this,{hasUnpiped:!1});return this}var n=P(I.pipes,C);return n===-1?this:(I.pipes.splice(n,1),I.pipesCount-=1,I.pipesCount===1&&(I.pipes=I.pipes[0]),C.emit("unpipe",this,J),this)},N.prototype.on=function(C,I){var J=r.prototype.on.call(this,C,I),h=this._readableState;return C==="data"?(h.readableListening=this.listenerCount("readable")>0,h.flowing!==!1&&this.resume()):C==="readable"&&!h.endEmitted&&!h.readableListening&&(h.readableListening=h.needReadable=!0,h.flowing=!1,h.emittedReadable=!1,c("on readable",h.length,h.reading),h.length?Q(this):h.reading||ke.nextTick(q,this)),J},N.prototype.addListener=N.prototype.on,N.prototype.removeListener=function(C,I){var J=r.prototype.removeListener.call(this,C,I);return C==="readable"&&ke.nextTick(R,this),J},N.prototype.removeAllListeners=function(C){var I=r.prototype.removeAllListeners.apply(this,arguments);return(C==="readable"||C===void 0)&&ke.nextTick(R,this),I};function R(C){var I=C._readableState;I.readableListening=C.listenerCount("readable")>0,I.resumeScheduled&&!I.paused?I.flowing=!0:C.listenerCount("data")>0&&C.resume()}function q(C){c("readable nexttick read 0"),C.read(0)}N.prototype.resume=function(){var C=this._readableState;return C.flowing||(c("resume"),C.flowing=!C.readableListening,K(this,C)),C.paused=!1,this};function K(C,I){I.resumeScheduled||(I.resumeScheduled=!0,ke.nextTick(V,C,I))}function V(C,I){c("resume",I.reading),I.reading||C.read(0),I.resumeScheduled=!1,C.emit("resume"),z(C),I.flowing&&!I.reading&&C.read(0)}N.prototype.pause=function(){return c("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(c("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function z(C){var I=C._readableState;for(c("flow",I.flowing);I.flowing&&C.read()!==null;);}N.prototype.wrap=function(C){var I=this,J=this._readableState,h=!1;C.on("end",function(){if(c("wrapped end"),J.decoder&&!J.ended){var n=J.decoder.end();n&&n.length&&I.push(n)}I.push(null)}),C.on("data",function(n){if(c("wrapped data"),J.decoder&&(n=J.decoder.write(n)),!(J.objectMode&&n==null)&&!(!J.objectMode&&(!n||!n.length))){var i=I.push(n);i||(h=!0,C.pause())}});for(var Z in C)this[Z]===void 0&&typeof C[Z]=="function"&&(this[Z]=function(i){return function(){return C[i].apply(C,arguments)}}(Z));for(var b=0;b<G.length;b++)C.on(G[b],this.emit.bind(this,G[b]));return this._read=function(n){c("wrapped _read",n),h&&(h=!1,C.resume())},this},typeof Symbol=="function"&&(N.prototype[Symbol.asyncIterator]=function(){return j===void 0&&(j=el()),j(this)}),Object.defineProperty(N.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(N.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(N.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(I){this._readableState&&(this._readableState.flowing=I)}}),N._fromList=g,Object.defineProperty(N.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function g(C,I){if(I.length===0)return null;var J;return I.objectMode?J=I.buffer.shift():!C||C>=I.length?(I.decoder?J=I.buffer.join(""):I.buffer.length===1?J=I.buffer.first():J=I.buffer.concat(I.length),I.buffer.clear()):J=I.buffer.consume(C,I.decoder),J}function m(C){var I=C._readableState;c("endReadable",I.endEmitted),I.endEmitted||(I.ended=!0,ke.nextTick(M,I,C))}function M(C,I){if(c("endReadableNT",C.endEmitted,C.length),!C.endEmitted&&C.length===0&&(C.endEmitted=!0,I.readable=!1,I.emit("end"),C.autoDestroy)){var J=I._writableState;(!J||J.autoDestroy&&J.finished)&&I.destroy()}}typeof Symbol=="function"&&(N.from=function(C,I){return O===void 0&&(O=tl()),O(N,C,I)});function P(C,I){for(var J=0,h=C.length;J<h;J++)if(C[J]===I)return J;return-1}return rn}var nn,Ga;function Hi(){if(Ga)return nn;Ga=1,nn=a;var t=Ct().codes,e=t.ERR_METHOD_NOT_IMPLEMENTED,r=t.ERR_MULTIPLE_CALLBACK,l=t.ERR_TRANSFORM_ALREADY_TRANSFORMING,d=t.ERR_TRANSFORM_WITH_LENGTH_0,o=Et();pt(a,o);function s(v,S){var T=this._transformState;T.transforming=!1;var w=T.writecb;if(w===null)return this.emit("error",new r);T.writechunk=null,T.writecb=null,S!=null&&this.push(S),w(v);var E=this._readableState;E.reading=!1,(E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}function a(v){if(!(this instanceof a))return new a(v);o.call(this,v),this._transformState={afterTransform:s.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,v&&(typeof v.transform=="function"&&(this._transform=v.transform),typeof v.flush=="function"&&(this._flush=v.flush)),this.on("prefinish",c)}function c(){var v=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(S,T){x(v,S,T)}):x(this,null,null)}a.prototype.push=function(v,S){return this._transformState.needTransform=!1,o.prototype.push.call(this,v,S)},a.prototype._transform=function(v,S,T){T(new e("_transform()"))},a.prototype._write=function(v,S,T){var w=this._transformState;if(w.writecb=T,w.writechunk=v,w.writeencoding=S,!w.transforming){var E=this._readableState;(w.needTransform||E.needReadable||E.length<E.highWaterMark)&&this._read(E.highWaterMark)}},a.prototype._read=function(v){var S=this._transformState;S.writechunk!==null&&!S.transforming?(S.transforming=!0,this._transform(S.writechunk,S.writeencoding,S.afterTransform)):S.needTransform=!0},a.prototype._destroy=function(v,S){o.prototype._destroy.call(this,v,function(T){S(T)})};function x(v,S,T){if(S)return v.emit("error",S);if(T!=null&&v.push(T),v._writableState.length)throw new d;if(v._transformState.transforming)throw new l;return v.push(null)}return nn}var an,Ka;function rl(){if(Ka)return an;Ka=1,an=e;var t=Hi();pt(e,t);function e(r){if(!(this instanceof e))return new e(r);t.call(this,r)}return e.prototype._transform=function(r,l,d){d(null,r)},an}var sn,qa;function nl(){if(qa)return sn;qa=1;var t;function e(T){var w=!1;return function(){w||(w=!0,T.apply(void 0,arguments))}}var r=Ct().codes,l=r.ERR_MISSING_ARGS,d=r.ERR_STREAM_DESTROYED;function o(T){if(T)throw T}function s(T){return T.setHeader&&typeof T.abort=="function"}function a(T,w,E,y){y=e(y);var A=!1;T.on("close",function(){A=!0}),t===void 0&&(t=In()),t(T,{readable:w,writable:E},function(k){if(k)return y(k);A=!0,y()});var p=!1;return function(k){if(!A&&!p){if(p=!0,s(T))return T.abort();if(typeof T.destroy=="function")return T.destroy();y(k||new d("pipe"))}}}function c(T){T()}function x(T,w){return T.pipe(w)}function v(T){return!T.length||typeof T[T.length-1]!="function"?o:T.pop()}function S(){for(var T=arguments.length,w=new Array(T),E=0;E<T;E++)w[E]=arguments[E];var y=v(w);if(Array.isArray(w[0])&&(w=w[0]),w.length<2)throw new l("streams");var A,p=w.map(function(k,j){var O=j<w.length-1,F=j>0;return a(k,O,F,function(G){A||(A=G),G&&p.forEach(c),!O&&(p.forEach(c),y(A))})});return w.reduce(x)}return sn=S,sn}var Fn=Ge,On=Nn.EventEmitter,al=pt;al(Ge,On);Ge.Readable=Wi();Ge.Writable=Ui();Ge.Duplex=Et();Ge.Transform=Hi();Ge.PassThrough=rl();Ge.finished=In();Ge.pipeline=nl();Ge.Stream=Ge;function Ge(){On.call(this)}Ge.prototype.pipe=function(t,e){var r=this;function l(v){t.writable&&t.write(v)===!1&&r.pause&&r.pause()}r.on("data",l);function d(){r.readable&&r.resume&&r.resume()}t.on("drain",d),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function c(v){if(x(),On.listenerCount(this,"error")===0)throw v}r.on("error",c),t.on("error",c);function x(){r.removeListener("data",l),t.removeListener("drain",d),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",c),t.removeListener("error",c),r.removeListener("end",x),r.removeListener("close",x),t.removeListener("close",x)}return r.on("end",x),r.on("close",x),t.on("close",x),t.emit("pipe",r),t};(function(t){(function(e){e.parser=function(g,m){return new l(g,m)},e.SAXParser=l,e.SAXStream=v,e.createStream=x,e.MAX_BUFFER_LENGTH=64*1024;var r=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];e.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"];function l(g,m){if(!(this instanceof l))return new l(g,m);var M=this;o(M),M.q=M.c="",M.bufferCheckPosition=e.MAX_BUFFER_LENGTH,M.opt=m||{},M.opt.lowercase=M.opt.lowercase||M.opt.lowercasetags,M.looseCase=M.opt.lowercase?"toLowerCase":"toUpperCase",M.tags=[],M.closed=M.closedRoot=M.sawRoot=!1,M.tag=M.error=null,M.strict=!!g,M.noscript=!!(g||M.opt.noscript),M.state=N.BEGIN,M.strictEntities=M.opt.strictEntities,M.ENTITIES=M.strictEntities?Object.create(e.XML_ENTITIES):Object.create(e.ENTITIES),M.attribList=[],M.opt.xmlns&&(M.ns=Object.create(y)),M.trackPosition=M.opt.position!==!1,M.trackPosition&&(M.position=M.line=M.column=0),se(M,"onready")}Object.create||(Object.create=function(g){function m(){}m.prototype=g;var M=new m;return M}),Object.keys||(Object.keys=function(g){var m=[];for(var M in g)g.hasOwnProperty(M)&&m.push(M);return m});function d(g){for(var m=Math.max(e.MAX_BUFFER_LENGTH,10),M=0,P=0,C=r.length;P<C;P++){var I=g[r[P]].length;if(I>m)switch(r[P]){case"textNode":X(g);break;case"cdata":B(g,"oncdata",g.cdata),g.cdata="";break;case"script":B(g,"onscript",g.script),g.script="";break;default:Y(g,"Max buffer length exceeded: "+r[P])}M=Math.max(M,I)}var J=e.MAX_BUFFER_LENGTH-M;g.bufferCheckPosition=J+g.position}function o(g){for(var m=0,M=r.length;m<M;m++)g[r[m]]=""}function s(g){X(g),g.cdata!==""&&(B(g,"oncdata",g.cdata),g.cdata=""),g.script!==""&&(B(g,"onscript",g.script),g.script="")}l.prototype={end:function(){de(this)},write:z,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){s(this)}};var a;try{a=Fn.Stream}catch{a=function(){}}var c=e.EVENTS.filter(function(g){return g!=="error"&&g!=="end"});function x(g,m){return new v(g,m)}function v(g,m){if(!(this instanceof v))return new v(g,m);a.apply(this),this._parser=new l(g,m),this.writable=!0,this.readable=!0;var M=this;this._parser.onend=function(){M.emit("end")},this._parser.onerror=function(P){M.emit("error",P),M._parser.error=null},this._decoder=null,c.forEach(function(P){Object.defineProperty(M,"on"+P,{get:function(){return M._parser["on"+P]},set:function(C){if(!C)return M.removeAllListeners(P),M._parser["on"+P]=C,C;M.on(P,C)},enumerable:!0,configurable:!1})})}v.prototype=Object.create(a.prototype,{constructor:{value:v}}),v.prototype.write=function(g){if(typeof Buffer=="function"&&typeof Buffer.isBuffer=="function"&&Buffer.isBuffer(g)){if(!this._decoder){var m=yn().StringDecoder;this._decoder=new m("utf8")}g=this._decoder.write(g)}return this._parser.write(g.toString()),this.emit("data",g),!0},v.prototype.end=function(g){return g&&g.length&&this.write(g),this._parser.end(),!0},v.prototype.on=function(g,m){var M=this;return!M._parser["on"+g]&&c.indexOf(g)!==-1&&(M._parser["on"+g]=function(){var P=arguments.length===1?[arguments[0]]:Array.apply(null,arguments);P.splice(0,0,g),M.emit.apply(M,P)}),a.prototype.on.call(M,g,m)};var S="[CDATA[",T="DOCTYPE",w="http://www.w3.org/XML/1998/namespace",E="http://www.w3.org/2000/xmlns/",y={xml:w,xmlns:E},A=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,p=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/,k=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,j=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040.\d-]/;function O(g){return g===" "||g===`
`||g==="\r"||g==="	"}function F(g){return g==='"'||g==="'"}function G(g){return g===">"||O(g)}function W(g,m){return g.test(m)}function $(g,m){return!W(g,m)}var N=0;e.STATE={BEGIN:N++,BEGIN_WHITESPACE:N++,TEXT:N++,TEXT_ENTITY:N++,OPEN_WAKA:N++,SGML_DECL:N++,SGML_DECL_QUOTED:N++,DOCTYPE:N++,DOCTYPE_QUOTED:N++,DOCTYPE_DTD:N++,DOCTYPE_DTD_QUOTED:N++,COMMENT_STARTING:N++,COMMENT:N++,COMMENT_ENDING:N++,COMMENT_ENDED:N++,CDATA:N++,CDATA_ENDING:N++,CDATA_ENDING_2:N++,PROC_INST:N++,PROC_INST_BODY:N++,PROC_INST_ENDING:N++,OPEN_TAG:N++,OPEN_TAG_SLASH:N++,ATTRIB:N++,ATTRIB_NAME:N++,ATTRIB_NAME_SAW_WHITE:N++,ATTRIB_VALUE:N++,ATTRIB_VALUE_QUOTED:N++,ATTRIB_VALUE_CLOSED:N++,ATTRIB_VALUE_UNQUOTED:N++,ATTRIB_VALUE_ENTITY_Q:N++,ATTRIB_VALUE_ENTITY_U:N++,CLOSE_TAG:N++,CLOSE_TAG_SAW_WHITE:N++,SCRIPT:N++,SCRIPT_ENDING:N++},e.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},e.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,int:8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(e.ENTITIES).forEach(function(g){var m=e.ENTITIES[g],M=typeof m=="number"?String.fromCharCode(m):m;e.ENTITIES[g]=M});for(var ne in e.STATE)e.STATE[e.STATE[ne]]=ne;N=e.STATE;function se(g,m,M){g[m]&&g[m](M)}function B(g,m,M){g.textNode&&X(g),se(g,m,M)}function X(g){g.textNode=_(g.opt,g.textNode),g.textNode&&se(g,"ontext",g.textNode),g.textNode=""}function _(g,m){return g.trim&&(m=m.trim()),g.normalize&&(m=m.replace(/\s+/g," ")),m}function Y(g,m){return X(g),g.trackPosition&&(m+=`
Line: `+g.line+`
Column: `+g.column+`
Char: `+g.c),m=new Error(m),g.error=m,se(g,"onerror",m),g}function de(g){return g.sawRoot&&!g.closedRoot&&Q(g,"Unclosed root tag"),g.state!==N.BEGIN&&g.state!==N.BEGIN_WHITESPACE&&g.state!==N.TEXT&&Y(g,"Unexpected end"),X(g),g.c="",g.closed=!0,se(g,"onend"),l.call(g,g.strict,g.opt),g}function Q(g,m){if(typeof g!="object"||!(g instanceof l))throw new Error("bad call to strictFail");g.strict&&Y(g,m)}function pe(g){g.strict||(g.tagName=g.tagName[g.looseCase]());var m=g.tags[g.tags.length-1]||g,M=g.tag={name:g.tagName,attributes:{}};g.opt.xmlns&&(M.ns=m.ns),g.attribList.length=0,B(g,"onopentagstart",M)}function te(g,m){var M=g.indexOf(":"),P=M<0?["",g]:g.split(":"),C=P[0],I=P[1];return m&&g==="xmlns"&&(C="xmlns",I=""),{prefix:C,local:I}}function fe(g){if(g.strict||(g.attribName=g.attribName[g.looseCase]()),g.attribList.indexOf(g.attribName)!==-1||g.tag.attributes.hasOwnProperty(g.attribName)){g.attribName=g.attribValue="";return}if(g.opt.xmlns){var m=te(g.attribName,!0),M=m.prefix,P=m.local;if(M==="xmlns")if(P==="xml"&&g.attribValue!==w)Q(g,"xml: prefix must be bound to "+w+`
Actual: `+g.attribValue);else if(P==="xmlns"&&g.attribValue!==E)Q(g,"xmlns: prefix must be bound to "+E+`
Actual: `+g.attribValue);else{var C=g.tag,I=g.tags[g.tags.length-1]||g;C.ns===I.ns&&(C.ns=Object.create(I.ns)),C.ns[P]=g.attribValue}g.attribList.push([g.attribName,g.attribValue])}else g.tag.attributes[g.attribName]=g.attribValue,B(g,"onattribute",{name:g.attribName,value:g.attribValue});g.attribName=g.attribValue=""}function H(g,m){if(g.opt.xmlns){var M=g.tag,P=te(g.tagName);M.prefix=P.prefix,M.local=P.local,M.uri=M.ns[P.prefix]||"",M.prefix&&!M.uri&&(Q(g,"Unbound namespace prefix: "+JSON.stringify(g.tagName)),M.uri=P.prefix);var C=g.tags[g.tags.length-1]||g;M.ns&&C.ns!==M.ns&&Object.keys(M.ns).forEach(function(L){B(g,"onopennamespace",{prefix:L,uri:M.ns[L]})});for(var I=0,J=g.attribList.length;I<J;I++){var h=g.attribList[I],Z=h[0],b=h[1],n=te(Z,!0),i=n.prefix,f=n.local,D=i===""?"":M.ns[i]||"",U={name:Z,value:b,prefix:i,local:f,uri:D};i&&i!=="xmlns"&&!D&&(Q(g,"Unbound namespace prefix: "+JSON.stringify(i)),U.uri=i),g.tag.attributes[Z]=U,B(g,"onattribute",U)}g.attribList.length=0}g.tag.isSelfClosing=!!m,g.sawRoot=!0,g.tags.push(g.tag),B(g,"onopentag",g.tag),m||(!g.noscript&&g.tagName.toLowerCase()==="script"?g.state=N.SCRIPT:g.state=N.TEXT,g.tag=null,g.tagName=""),g.attribName=g.attribValue="",g.attribList.length=0}function R(g){if(!g.tagName){Q(g,"Weird empty close tag."),g.textNode+="</>",g.state=N.TEXT;return}if(g.script){if(g.tagName!=="script"){g.script+="</"+g.tagName+">",g.tagName="",g.state=N.SCRIPT;return}B(g,"onscript",g.script),g.script=""}var m=g.tags.length,M=g.tagName;g.strict||(M=M[g.looseCase]());for(var P=M;m--;){var C=g.tags[m];if(C.name!==P)Q(g,"Unexpected close tag");else break}if(m<0){Q(g,"Unmatched closing tag: "+g.tagName),g.textNode+="</"+g.tagName+">",g.state=N.TEXT;return}g.tagName=M;for(var I=g.tags.length;I-- >m;){var J=g.tag=g.tags.pop();g.tagName=g.tag.name,B(g,"onclosetag",g.tagName);var h={};for(var Z in J.ns)h[Z]=J.ns[Z];var b=g.tags[g.tags.length-1]||g;g.opt.xmlns&&J.ns!==b.ns&&Object.keys(J.ns).forEach(function(n){var i=J.ns[n];B(g,"onclosenamespace",{prefix:n,uri:i})})}m===0&&(g.closedRoot=!0),g.tagName=g.attribValue=g.attribName="",g.attribList.length=0,g.state=N.TEXT}function q(g){var m=g.entity,M=m.toLowerCase(),P,C="";return g.ENTITIES[m]?g.ENTITIES[m]:g.ENTITIES[M]?g.ENTITIES[M]:(m=M,m.charAt(0)==="#"&&(m.charAt(1)==="x"?(m=m.slice(2),P=parseInt(m,16),C=P.toString(16)):(m=m.slice(1),P=parseInt(m,10),C=P.toString(10))),m=m.replace(/^0+/,""),isNaN(P)||C.toLowerCase()!==m?(Q(g,"Invalid character entity"),"&"+g.entity+";"):String.fromCodePoint(P))}function K(g,m){m==="<"?(g.state=N.OPEN_WAKA,g.startTagPosition=g.position):O(m)||(Q(g,"Non-whitespace before first tag."),g.textNode=m,g.state=N.TEXT)}function V(g,m){var M="";return m<g.length&&(M=g.charAt(m)),M}function z(g){var m=this;if(this.error)throw this.error;if(m.closed)return Y(m,"Cannot write after close. Assign an onready handler.");if(g===null)return de(m);typeof g=="object"&&(g=g.toString());for(var M=0,P="";P=V(g,M++),m.c=P,!!P;)switch(m.trackPosition&&(m.position++,P===`
`?(m.line++,m.column=0):m.column++),m.state){case N.BEGIN:if(m.state=N.BEGIN_WHITESPACE,P==="\uFEFF")continue;K(m,P);continue;case N.BEGIN_WHITESPACE:K(m,P);continue;case N.TEXT:if(m.sawRoot&&!m.closedRoot){for(var C=M-1;P&&P!=="<"&&P!=="&";)P=V(g,M++),P&&m.trackPosition&&(m.position++,P===`
`?(m.line++,m.column=0):m.column++);m.textNode+=g.substring(C,M-1)}P==="<"&&!(m.sawRoot&&m.closedRoot&&!m.strict)?(m.state=N.OPEN_WAKA,m.startTagPosition=m.position):(!O(P)&&(!m.sawRoot||m.closedRoot)&&Q(m,"Text data outside of root node."),P==="&"?m.state=N.TEXT_ENTITY:m.textNode+=P);continue;case N.SCRIPT:P==="<"?m.state=N.SCRIPT_ENDING:m.script+=P;continue;case N.SCRIPT_ENDING:P==="/"?m.state=N.CLOSE_TAG:(m.script+="<"+P,m.state=N.SCRIPT);continue;case N.OPEN_WAKA:if(P==="!")m.state=N.SGML_DECL,m.sgmlDecl="";else if(!O(P))if(W(A,P))m.state=N.OPEN_TAG,m.tagName=P;else if(P==="/")m.state=N.CLOSE_TAG,m.tagName="";else if(P==="?")m.state=N.PROC_INST,m.procInstName=m.procInstBody="";else{if(Q(m,"Unencoded <"),m.startTagPosition+1<m.position){var I=m.position-m.startTagPosition;P=new Array(I).join(" ")+P}m.textNode+="<"+P,m.state=N.TEXT}continue;case N.SGML_DECL:(m.sgmlDecl+P).toUpperCase()===S?(B(m,"onopencdata"),m.state=N.CDATA,m.sgmlDecl="",m.cdata=""):m.sgmlDecl+P==="--"?(m.state=N.COMMENT,m.comment="",m.sgmlDecl=""):(m.sgmlDecl+P).toUpperCase()===T?(m.state=N.DOCTYPE,(m.doctype||m.sawRoot)&&Q(m,"Inappropriately located doctype declaration"),m.doctype="",m.sgmlDecl=""):P===">"?(B(m,"onsgmldeclaration",m.sgmlDecl),m.sgmlDecl="",m.state=N.TEXT):(F(P)&&(m.state=N.SGML_DECL_QUOTED),m.sgmlDecl+=P);continue;case N.SGML_DECL_QUOTED:P===m.q&&(m.state=N.SGML_DECL,m.q=""),m.sgmlDecl+=P;continue;case N.DOCTYPE:P===">"?(m.state=N.TEXT,B(m,"ondoctype",m.doctype),m.doctype=!0):(m.doctype+=P,P==="["?m.state=N.DOCTYPE_DTD:F(P)&&(m.state=N.DOCTYPE_QUOTED,m.q=P));continue;case N.DOCTYPE_QUOTED:m.doctype+=P,P===m.q&&(m.q="",m.state=N.DOCTYPE);continue;case N.DOCTYPE_DTD:m.doctype+=P,P==="]"?m.state=N.DOCTYPE:F(P)&&(m.state=N.DOCTYPE_DTD_QUOTED,m.q=P);continue;case N.DOCTYPE_DTD_QUOTED:m.doctype+=P,P===m.q&&(m.state=N.DOCTYPE_DTD,m.q="");continue;case N.COMMENT:P==="-"?m.state=N.COMMENT_ENDING:m.comment+=P;continue;case N.COMMENT_ENDING:P==="-"?(m.state=N.COMMENT_ENDED,m.comment=_(m.opt,m.comment),m.comment&&B(m,"oncomment",m.comment),m.comment=""):(m.comment+="-"+P,m.state=N.COMMENT);continue;case N.COMMENT_ENDED:P!==">"?(Q(m,"Malformed comment"),m.comment+="--"+P,m.state=N.COMMENT):m.state=N.TEXT;continue;case N.CDATA:P==="]"?m.state=N.CDATA_ENDING:m.cdata+=P;continue;case N.CDATA_ENDING:P==="]"?m.state=N.CDATA_ENDING_2:(m.cdata+="]"+P,m.state=N.CDATA);continue;case N.CDATA_ENDING_2:P===">"?(m.cdata&&B(m,"oncdata",m.cdata),B(m,"onclosecdata"),m.cdata="",m.state=N.TEXT):P==="]"?m.cdata+="]":(m.cdata+="]]"+P,m.state=N.CDATA);continue;case N.PROC_INST:P==="?"?m.state=N.PROC_INST_ENDING:O(P)?m.state=N.PROC_INST_BODY:m.procInstName+=P;continue;case N.PROC_INST_BODY:if(!m.procInstBody&&O(P))continue;P==="?"?m.state=N.PROC_INST_ENDING:m.procInstBody+=P;continue;case N.PROC_INST_ENDING:P===">"?(B(m,"onprocessinginstruction",{name:m.procInstName,body:m.procInstBody}),m.procInstName=m.procInstBody="",m.state=N.TEXT):(m.procInstBody+="?"+P,m.state=N.PROC_INST_BODY);continue;case N.OPEN_TAG:W(p,P)?m.tagName+=P:(pe(m),P===">"?H(m):P==="/"?m.state=N.OPEN_TAG_SLASH:(O(P)||Q(m,"Invalid character in tag name"),m.state=N.ATTRIB));continue;case N.OPEN_TAG_SLASH:P===">"?(H(m,!0),R(m)):(Q(m,"Forward-slash in opening tag not followed by >"),m.state=N.ATTRIB);continue;case N.ATTRIB:if(O(P))continue;P===">"?H(m):P==="/"?m.state=N.OPEN_TAG_SLASH:W(A,P)?(m.attribName=P,m.attribValue="",m.state=N.ATTRIB_NAME):Q(m,"Invalid attribute name");continue;case N.ATTRIB_NAME:P==="="?m.state=N.ATTRIB_VALUE:P===">"?(Q(m,"Attribute without value"),m.attribValue=m.attribName,fe(m),H(m)):O(P)?m.state=N.ATTRIB_NAME_SAW_WHITE:W(p,P)?m.attribName+=P:Q(m,"Invalid attribute name");continue;case N.ATTRIB_NAME_SAW_WHITE:if(P==="=")m.state=N.ATTRIB_VALUE;else{if(O(P))continue;Q(m,"Attribute without value"),m.tag.attributes[m.attribName]="",m.attribValue="",B(m,"onattribute",{name:m.attribName,value:""}),m.attribName="",P===">"?H(m):W(A,P)?(m.attribName=P,m.state=N.ATTRIB_NAME):(Q(m,"Invalid attribute name"),m.state=N.ATTRIB)}continue;case N.ATTRIB_VALUE:if(O(P))continue;F(P)?(m.q=P,m.state=N.ATTRIB_VALUE_QUOTED):(Q(m,"Unquoted attribute value"),m.state=N.ATTRIB_VALUE_UNQUOTED,m.attribValue=P);continue;case N.ATTRIB_VALUE_QUOTED:if(P!==m.q){P==="&"?m.state=N.ATTRIB_VALUE_ENTITY_Q:m.attribValue+=P;continue}fe(m),m.q="",m.state=N.ATTRIB_VALUE_CLOSED;continue;case N.ATTRIB_VALUE_CLOSED:O(P)?m.state=N.ATTRIB:P===">"?H(m):P==="/"?m.state=N.OPEN_TAG_SLASH:W(A,P)?(Q(m,"No whitespace between attributes"),m.attribName=P,m.attribValue="",m.state=N.ATTRIB_NAME):Q(m,"Invalid attribute name");continue;case N.ATTRIB_VALUE_UNQUOTED:if(!G(P)){P==="&"?m.state=N.ATTRIB_VALUE_ENTITY_U:m.attribValue+=P;continue}fe(m),P===">"?H(m):m.state=N.ATTRIB;continue;case N.CLOSE_TAG:if(m.tagName)P===">"?R(m):W(p,P)?m.tagName+=P:m.script?(m.script+="</"+m.tagName,m.tagName="",m.state=N.SCRIPT):(O(P)||Q(m,"Invalid tagname in closing tag"),m.state=N.CLOSE_TAG_SAW_WHITE);else{if(O(P))continue;$(A,P)?m.script?(m.script+="</"+P,m.state=N.SCRIPT):Q(m,"Invalid tagname in closing tag."):m.tagName=P}continue;case N.CLOSE_TAG_SAW_WHITE:if(O(P))continue;P===">"?R(m):Q(m,"Invalid characters in closing tag");continue;case N.TEXT_ENTITY:case N.ATTRIB_VALUE_ENTITY_Q:case N.ATTRIB_VALUE_ENTITY_U:var J,h;switch(m.state){case N.TEXT_ENTITY:J=N.TEXT,h="textNode";break;case N.ATTRIB_VALUE_ENTITY_Q:J=N.ATTRIB_VALUE_QUOTED,h="attribValue";break;case N.ATTRIB_VALUE_ENTITY_U:J=N.ATTRIB_VALUE_UNQUOTED,h="attribValue";break}P===";"?(m[h]+=q(m),m.entity="",m.state=J):W(m.entity.length?j:k,P)?m.entity+=P:(Q(m,"Invalid character in entity name"),m[h]+="&"+m.entity+P,m.entity="",m.state=J);continue;default:throw new Error(m,"Unknown state: "+m.state)}return m.position>=m.bufferCheckPosition&&d(m),m}/*! http://mths.be/fromcodepoint v0.1.0 by @mathias */String.fromCodePoint||function(){var g=String.fromCharCode,m=Math.floor,M=function(){var P=16384,C=[],I,J,h=-1,Z=arguments.length;if(!Z)return"";for(var b="";++h<Z;){var n=Number(arguments[h]);if(!isFinite(n)||n<0||n>1114111||m(n)!==n)throw RangeError("Invalid code point: "+n);n<=65535?C.push(n):(n-=65536,I=(n>>10)+55296,J=n%1024+56320,C.push(I,J)),(h+1===Z||C.length>P)&&(b+=g.apply(null,C),C.length=0)}return b};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:M,configurable:!0,writable:!0}):String.fromCodePoint=M}()})(t)})(yi);var Pn={isArray:function(t){return Array.isArray?Array.isArray(t):Object.prototype.toString.call(t)==="[object Array]"}},il=Pn.isArray,Dn={copyOptions:function(t){var e,r={};for(e in t)t.hasOwnProperty(e)&&(r[e]=t[e]);return r},ensureFlagExists:function(t,e){(!(t in e)||typeof e[t]!="boolean")&&(e[t]=!1)},ensureSpacesExists:function(t){(!("spaces"in t)||typeof t.spaces!="number"&&typeof t.spaces!="string")&&(t.spaces=0)},ensureAlwaysArrayExists:function(t){(!("alwaysArray"in t)||typeof t.alwaysArray!="boolean"&&!il(t.alwaysArray))&&(t.alwaysArray=!1)},ensureKeyExists:function(t,e){(!(t+"Key"in e)||typeof e[t+"Key"]!="string")&&(e[t+"Key"]=e.compact?"_"+t:t)},checkFnExists:function(t,e){return t+"Fn"in e}},sl=yi,Se=Dn,vt=Pn.isArray,ee,ve;function ol(t){return ee=Se.copyOptions(t),Se.ensureFlagExists("ignoreDeclaration",ee),Se.ensureFlagExists("ignoreInstruction",ee),Se.ensureFlagExists("ignoreAttributes",ee),Se.ensureFlagExists("ignoreText",ee),Se.ensureFlagExists("ignoreComment",ee),Se.ensureFlagExists("ignoreCdata",ee),Se.ensureFlagExists("ignoreDoctype",ee),Se.ensureFlagExists("compact",ee),Se.ensureFlagExists("alwaysChildren",ee),Se.ensureFlagExists("addParent",ee),Se.ensureFlagExists("trim",ee),Se.ensureFlagExists("nativeType",ee),Se.ensureFlagExists("nativeTypeAttributes",ee),Se.ensureFlagExists("sanitize",ee),Se.ensureFlagExists("instructionHasAttributes",ee),Se.ensureFlagExists("captureSpacesBetweenElements",ee),Se.ensureAlwaysArrayExists(ee),Se.ensureKeyExists("declaration",ee),Se.ensureKeyExists("instruction",ee),Se.ensureKeyExists("attributes",ee),Se.ensureKeyExists("text",ee),Se.ensureKeyExists("comment",ee),Se.ensureKeyExists("cdata",ee),Se.ensureKeyExists("doctype",ee),Se.ensureKeyExists("type",ee),Se.ensureKeyExists("name",ee),Se.ensureKeyExists("elements",ee),Se.ensureKeyExists("parent",ee),ee}function Gi(t){var e=Number(t);if(!isNaN(e))return e;var r=t.toLowerCase();return r==="true"?!0:r==="false"?!1:t}function Ht(t,e){var r;if(ee.compact){if(!ve[ee[t+"Key"]]&&(vt(ee.alwaysArray)?ee.alwaysArray.indexOf(ee[t+"Key"])!==-1:ee.alwaysArray)&&(ve[ee[t+"Key"]]=[]),ve[ee[t+"Key"]]&&!vt(ve[ee[t+"Key"]])&&(ve[ee[t+"Key"]]=[ve[ee[t+"Key"]]]),t+"Fn"in ee&&typeof e=="string"&&(e=ee[t+"Fn"](e,ve)),t==="instruction"&&("instructionFn"in ee||"instructionNameFn"in ee)){for(r in e)if(e.hasOwnProperty(r))if("instructionFn"in ee)e[r]=ee.instructionFn(e[r],r,ve);else{var l=e[r];delete e[r],e[ee.instructionNameFn(r,l,ve)]=l}}vt(ve[ee[t+"Key"]])?ve[ee[t+"Key"]].push(e):ve[ee[t+"Key"]]=e}else{ve[ee.elementsKey]||(ve[ee.elementsKey]=[]);var d={};if(d[ee.typeKey]=t,t==="instruction"){for(r in e)if(e.hasOwnProperty(r))break;d[ee.nameKey]="instructionNameFn"in ee?ee.instructionNameFn(r,e,ve):r,ee.instructionHasAttributes?(d[ee.attributesKey]=e[r][ee.attributesKey],"instructionFn"in ee&&(d[ee.attributesKey]=ee.instructionFn(d[ee.attributesKey],r,ve))):("instructionFn"in ee&&(e[r]=ee.instructionFn(e[r],r,ve)),d[ee.instructionKey]=e[r])}else t+"Fn"in ee&&(e=ee[t+"Fn"](e,ve)),d[ee[t+"Key"]]=e;ee.addParent&&(d[ee.parentKey]=ve),ve[ee.elementsKey].push(d)}}function Ki(t){if("attributesFn"in ee&&t&&(t=ee.attributesFn(t,ve)),(ee.trim||"attributeValueFn"in ee||"attributeNameFn"in ee||ee.nativeTypeAttributes)&&t){var e;for(e in t)if(t.hasOwnProperty(e)&&(ee.trim&&(t[e]=t[e].trim()),ee.nativeTypeAttributes&&(t[e]=Gi(t[e])),"attributeValueFn"in ee&&(t[e]=ee.attributeValueFn(t[e],e,ve)),"attributeNameFn"in ee)){var r=t[e];delete t[e],t[ee.attributeNameFn(e,t[e],ve)]=r}}return t}function ll(t){var e={};if(t.body&&(t.name.toLowerCase()==="xml"||ee.instructionHasAttributes)){for(var r=/([\w:-]+)\s*=\s*(?:"([^"]*)"|'([^']*)'|(\w+))\s*/g,l;(l=r.exec(t.body))!==null;)e[l[1]]=l[2]||l[3]||l[4];e=Ki(e)}if(t.name.toLowerCase()==="xml"){if(ee.ignoreDeclaration)return;ve[ee.declarationKey]={},Object.keys(e).length&&(ve[ee.declarationKey][ee.attributesKey]=e),ee.addParent&&(ve[ee.declarationKey][ee.parentKey]=ve)}else{if(ee.ignoreInstruction)return;ee.trim&&(t.body=t.body.trim());var d={};ee.instructionHasAttributes&&Object.keys(e).length?(d[t.name]={},d[t.name][ee.attributesKey]=e):d[t.name]=t.body,Ht("instruction",d)}}function ul(t,e){var r;if(typeof t=="object"&&(e=t.attributes,t=t.name),e=Ki(e),"elementNameFn"in ee&&(t=ee.elementNameFn(t,ve)),ee.compact){if(r={},!ee.ignoreAttributes&&e&&Object.keys(e).length){r[ee.attributesKey]={};var l;for(l in e)e.hasOwnProperty(l)&&(r[ee.attributesKey][l]=e[l])}!(t in ve)&&(vt(ee.alwaysArray)?ee.alwaysArray.indexOf(t)!==-1:ee.alwaysArray)&&(ve[t]=[]),ve[t]&&!vt(ve[t])&&(ve[t]=[ve[t]]),vt(ve[t])?ve[t].push(r):ve[t]=r}else ve[ee.elementsKey]||(ve[ee.elementsKey]=[]),r={},r[ee.typeKey]="element",r[ee.nameKey]=t,!ee.ignoreAttributes&&e&&Object.keys(e).length&&(r[ee.attributesKey]=e),ee.alwaysChildren&&(r[ee.elementsKey]=[]),ve[ee.elementsKey].push(r);r[ee.parentKey]=ve,ve=r}function cl(t){ee.ignoreText||!t.trim()&&!ee.captureSpacesBetweenElements||(ee.trim&&(t=t.trim()),ee.nativeType&&(t=Gi(t)),ee.sanitize&&(t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")),Ht("text",t))}function dl(t){ee.ignoreComment||(ee.trim&&(t=t.trim()),Ht("comment",t))}function fl(t){var e=ve[ee.parentKey];ee.addParent||delete ve[ee.parentKey],ve=e}function hl(t){ee.ignoreCdata||(ee.trim&&(t=t.trim()),Ht("cdata",t))}function pl(t){ee.ignoreDoctype||(t=t.replace(/^ /,""),ee.trim&&(t=t.trim()),Ht("doctype",t))}function ml(t){t.note=t}var qi=function(t,e){var r=sl.parser(!0,{}),l={};if(ve=l,ee=ol(e),r.opt={strictEntities:!0},r.onopentag=ul,r.ontext=cl,r.oncomment=dl,r.onclosetag=fl,r.onerror=ml,r.oncdata=hl,r.ondoctype=pl,r.onprocessinginstruction=ll,r.write(t).close(),l[ee.elementsKey]){var d=l[ee.elementsKey];delete l[ee.elementsKey],l[ee.elementsKey]=d,delete l.text}return l},Va=Dn,gl=qi;function wl(t){var e=Va.copyOptions(t);return Va.ensureSpacesExists(e),e}var bl=function(t,e){var r,l,d,o;return r=wl(e),l=gl(t,r),o="compact"in r&&r.compact?"_parent":"parent","addParent"in r&&r.addParent?d=JSON.stringify(l,function(s,a){return s===o?"_":a},r.spaces):d=JSON.stringify(l,null,r.spaces),d.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")},Ae=Dn,yl=Pn.isArray,Me,ze;function xl(t){var e=Ae.copyOptions(t);return Ae.ensureFlagExists("ignoreDeclaration",e),Ae.ensureFlagExists("ignoreInstruction",e),Ae.ensureFlagExists("ignoreAttributes",e),Ae.ensureFlagExists("ignoreText",e),Ae.ensureFlagExists("ignoreComment",e),Ae.ensureFlagExists("ignoreCdata",e),Ae.ensureFlagExists("ignoreDoctype",e),Ae.ensureFlagExists("compact",e),Ae.ensureFlagExists("indentText",e),Ae.ensureFlagExists("indentCdata",e),Ae.ensureFlagExists("indentAttributes",e),Ae.ensureFlagExists("indentInstruction",e),Ae.ensureFlagExists("fullTagEmptyElement",e),Ae.ensureFlagExists("noQuotesForNativeAttributes",e),Ae.ensureSpacesExists(e),typeof e.spaces=="number"&&(e.spaces=Array(e.spaces+1).join(" ")),Ae.ensureKeyExists("declaration",e),Ae.ensureKeyExists("instruction",e),Ae.ensureKeyExists("attributes",e),Ae.ensureKeyExists("text",e),Ae.ensureKeyExists("comment",e),Ae.ensureKeyExists("cdata",e),Ae.ensureKeyExists("doctype",e),Ae.ensureKeyExists("type",e),Ae.ensureKeyExists("name",e),Ae.ensureKeyExists("elements",e),e}function Je(t,e,r){return(!r&&t.spaces?`
`:"")+Array(e+1).join(t.spaces)}function fr(t,e,r){if(e.ignoreAttributes)return"";"attributesFn"in e&&(t=e.attributesFn(t,ze,Me));var l,d,o,s,a=[];for(l in t)t.hasOwnProperty(l)&&t[l]!==null&&t[l]!==void 0&&(s=e.noQuotesForNativeAttributes&&typeof t[l]!="string"?"":'"',d=""+t[l],d=d.replace(/"/g,"&quot;"),o="attributeNameFn"in e?e.attributeNameFn(l,d,ze,Me):l,a.push(e.spaces&&e.indentAttributes?Je(e,r+1,!1):" "),a.push(o+"="+s+("attributeValueFn"in e?e.attributeValueFn(d,l,ze,Me):d)+s));return t&&Object.keys(t).length&&e.spaces&&e.indentAttributes&&a.push(Je(e,r,!1)),a.join("")}function Vi(t,e,r){return Me=t,ze="xml",e.ignoreDeclaration?"":"<?xml"+fr(t[e.attributesKey],e,r)+"?>"}function $i(t,e,r){if(e.ignoreInstruction)return"";var l;for(l in t)if(t.hasOwnProperty(l))break;var d="instructionNameFn"in e?e.instructionNameFn(l,t[l],ze,Me):l;if(typeof t[l]=="object")return Me=t,ze=d,"<?"+d+fr(t[l][e.attributesKey],e,r)+"?>";var o=t[l]?t[l]:"";return"instructionFn"in e&&(o=e.instructionFn(o,l,ze,Me)),"<?"+d+(o?" "+o:"")+"?>"}function Xi(t,e){return e.ignoreComment?"":"<!--"+("commentFn"in e?e.commentFn(t,ze,Me):t)+"-->"}function Zi(t,e){return e.ignoreCdata?"":"<![CDATA["+("cdataFn"in e?e.cdataFn(t,ze,Me):t.replace("]]>","]]]]><![CDATA[>"))+"]]>"}function Yi(t,e){return e.ignoreDoctype?"":"<!DOCTYPE "+("doctypeFn"in e?e.doctypeFn(t,ze,Me):t)+">"}function Bn(t,e){return e.ignoreText?"":(t=""+t,t=t.replace(/&amp;/g,"&"),t=t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),"textFn"in e?e.textFn(t,ze,Me):t)}function vl(t,e){var r;if(t.elements&&t.elements.length)for(r=0;r<t.elements.length;++r)switch(t.elements[r][e.typeKey]){case"text":if(e.indentText)return!0;break;case"cdata":if(e.indentCdata)return!0;break;case"instruction":if(e.indentInstruction)return!0;break;case"doctype":case"comment":case"element":return!0;default:return!0}return!1}function kl(t,e,r){Me=t,ze=t.name;var l=[],d="elementNameFn"in e?e.elementNameFn(t.name,t):t.name;l.push("<"+d),t[e.attributesKey]&&l.push(fr(t[e.attributesKey],e,r));var o=t[e.elementsKey]&&t[e.elementsKey].length||t[e.attributesKey]&&t[e.attributesKey]["xml:space"]==="preserve";return o||("fullTagEmptyElementFn"in e?o=e.fullTagEmptyElementFn(t.name,t):o=e.fullTagEmptyElement),o?(l.push(">"),t[e.elementsKey]&&t[e.elementsKey].length&&(l.push(Ji(t[e.elementsKey],e,r+1)),Me=t,ze=t.name),l.push(e.spaces&&vl(t,e)?`
`+Array(r+1).join(e.spaces):""),l.push("</"+d+">")):l.push("/>"),l.join("")}function Ji(t,e,r,l){return t.reduce(function(d,o){var s=Je(e,r,l&&!d);switch(o.type){case"element":return d+s+kl(o,e,r);case"comment":return d+s+Xi(o[e.commentKey],e);case"doctype":return d+s+Yi(o[e.doctypeKey],e);case"cdata":return d+(e.indentCdata?s:"")+Zi(o[e.cdataKey],e);case"text":return d+(e.indentText?s:"")+Bn(o[e.textKey],e);case"instruction":var a={};return a[o[e.nameKey]]=o[e.attributesKey]?o:o[e.instructionKey],d+(e.indentInstruction?s:"")+$i(a,e,r)}},"")}function Qi(t,e,r){var l;for(l in t)if(t.hasOwnProperty(l))switch(l){case e.parentKey:case e.attributesKey:break;case e.textKey:if(e.indentText||r)return!0;break;case e.cdataKey:if(e.indentCdata||r)return!0;break;case e.instructionKey:if(e.indentInstruction||r)return!0;break;case e.doctypeKey:case e.commentKey:return!0;default:return!0}return!1}function _l(t,e,r,l,d){Me=t,ze=e;var o="elementNameFn"in r?r.elementNameFn(e,t):e;if(typeof t>"u"||t===null||t==="")return"fullTagEmptyElementFn"in r&&r.fullTagEmptyElementFn(e,t)||r.fullTagEmptyElement?"<"+o+"></"+o+">":"<"+o+"/>";var s=[];if(e){if(s.push("<"+o),typeof t!="object")return s.push(">"+Bn(t,r)+"</"+o+">"),s.join("");t[r.attributesKey]&&s.push(fr(t[r.attributesKey],r,l));var a=Qi(t,r,!0)||t[r.attributesKey]&&t[r.attributesKey]["xml:space"]==="preserve";if(a||("fullTagEmptyElementFn"in r?a=r.fullTagEmptyElementFn(e,t):a=r.fullTagEmptyElement),a)s.push(">");else return s.push("/>"),s.join("")}return s.push(es(t,r,l+1,!1)),Me=t,ze=e,e&&s.push((d?Je(r,l,!1):"")+"</"+o+">"),s.join("")}function es(t,e,r,l){var d,o,s,a=[];for(o in t)if(t.hasOwnProperty(o))for(s=yl(t[o])?t[o]:[t[o]],d=0;d<s.length;++d){switch(o){case e.declarationKey:a.push(Vi(s[d],e,r));break;case e.instructionKey:a.push((e.indentInstruction?Je(e,r,l):"")+$i(s[d],e,r));break;case e.attributesKey:case e.parentKey:break;case e.textKey:a.push((e.indentText?Je(e,r,l):"")+Bn(s[d],e));break;case e.cdataKey:a.push((e.indentCdata?Je(e,r,l):"")+Zi(s[d],e));break;case e.doctypeKey:a.push(Je(e,r,l)+Yi(s[d],e));break;case e.commentKey:a.push(Je(e,r,l)+Xi(s[d],e));break;default:a.push(Je(e,r,l)+_l(s[d],o,e,r,Qi(s[d],e)))}l=l&&!a.length}return a.join("")}var ts=function(t,e){e=xl(e);var r=[];return Me=t,ze="_root_",e.compact?r.push(es(t,e,0,!0)):(t[e.declarationKey]&&r.push(Vi(t[e.declarationKey],e,0)),t[e.elementsKey]&&t[e.elementsKey].length&&r.push(Ji(t[e.elementsKey],e,0,!r.length))),r.join("")},El=ts,Sl=function(t,e){t instanceof Buffer&&(t=t.toString());var r=null;if(typeof t=="string")try{r=JSON.parse(t)}catch{throw new Error("The JSON structure is invalid")}else r=t;return El(r,e)},Tl=qi,Al=bl,Nl=ts,jl=Sl,rs={xml2js:Tl,xml2json:Al,js2xml:Nl,json2xml:jl};const Ln=t=>{switch(t.type){case void 0:case"element":const e=new Rl(t.name,t.attributes),r=t.elements||[];for(const l of r){const d=Ln(l);d!==void 0&&e.push(d)}return e;case"text":return t.text;default:return}};class Cl extends xe{}class Rl extends oe{static fromXmlString(e){const r=rs.xml2js(e,{compact:!1});return Ln(r)}constructor(e,r){super(e),r&&this.root.push(new Cl(r))}push(e){this.root.push(e)}}class Il extends oe{constructor(e){super(""),this._attr=e}prepForXml(e){return{_attr:this._attr}}}class ns extends oe{constructor(e,r){super(e),r&&(this.root=r.root)}}const Ue=t=>{if(isNaN(t))throw new Error(`Invalid value '${t}' specified. Must be an integer.`);return Math.floor(t)},hr=t=>{const e=Ue(t);if(e<0)throw new Error(`Invalid value '${t}' specified. Must be a positive integer.`);return e},as=(t,e)=>{const r=e*2;if(t.length!==r||isNaN(+`0x${t}`))throw new Error(`Invalid hex value '${t}'. Expected ${r} digit hex value`);return t},$a=t=>as(t,1),is=t=>{const e=t.slice(-2),r=t.substring(0,t.length-2);return`${Number(r)}${e}`},ss=t=>{const e=is(t);if(parseFloat(e)<0)throw new Error(`Invalid value '${e}' specified. Expected a positive number.`);return e},St=t=>{if(t==="auto")return t;const e=t.charAt(0)==="#"?t.substring(1):t;return as(e,3)},ft=t=>typeof t=="string"?is(t):Ue(t),Fl=t=>typeof t=="string"?ss(t):hr(t),$e=t=>typeof t=="string"?ss(t):hr(t),Ol=hr,Pl=hr,Dl=t=>t.toISOString();class ue extends oe{constructor(e,r=!0){super(e),r!==!0&&this.root.push(new Fe({val:r}))}}class on extends oe{constructor(e,r){super(e),this.root.push(new Fe({val:Fl(r)}))}}class kt extends oe{constructor(e,r){super(e),this.root.push(new Fe({val:r}))}}const Dt=(t,e)=>new st({name:t,attributes:{value:{key:"w:val",value:e}}});class Mn extends oe{constructor(e,r){super(e),this.root.push(new Fe({val:r}))}}class ut extends oe{constructor(e,r){super(e),this.root.push(r)}}class st extends oe{constructor({name:e,attributes:r,children:l}){super(e),r&&this.root.push(new Wt(r)),l&&this.root.push(...l)}}const Xe={START:"start",LEFT:"left"};class Bl extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class Ll extends oe{constructor(e){super("w:jc"),this.root.push(new Bl({val:e}))}}class Ce extends oe{constructor(e,{color:r,size:l,space:d,style:o}){super(e),this.root.push(new Ml({style:o,color:r===void 0?void 0:St(r),size:l===void 0?void 0:Ol(l),space:d===void 0?void 0:Pl(d)}))}}class Ml extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{style:"w:val",color:"w:color",size:"w:sz",space:"w:space"})}}const zn={SINGLE:"single",NONE:"none"};class zl extends ur{constructor(e){super("w:pBdr"),e.top&&this.root.push(new Ce("w:top",e.top)),e.bottom&&this.root.push(new Ce("w:bottom",e.bottom)),e.left&&this.root.push(new Ce("w:left",e.left)),e.right&&this.root.push(new Ce("w:right",e.right))}}class Ul extends oe{constructor(){super("w:pBdr");const e=new Ce("w:bottom",{color:"auto",space:1,style:zn.SINGLE,size:6});this.root.push(e)}}class Wl extends oe{constructor({start:e,end:r,left:l,right:d,hanging:o,firstLine:s}){super("w:ind"),this.root.push(new Wt({start:{key:"w:start",value:e===void 0?void 0:ft(e)},end:{key:"w:end",value:r===void 0?void 0:ft(r)},left:{key:"w:left",value:l===void 0?void 0:ft(l)},right:{key:"w:right",value:d===void 0?void 0:ft(d)},hanging:{key:"w:hanging",value:o===void 0?void 0:$e(o)},firstLine:{key:"w:firstLine",value:s===void 0?void 0:$e(s)}}))}}let Hl=class extends oe{constructor(){super("w:br")}};const Un={BEGIN:"begin",END:"end",SEPARATE:"separate"};class Wn extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{type:"w:fldCharType",dirty:"w:dirty"})}}class $t extends oe{constructor(e){super("w:fldChar"),this.root.push(new Wn({type:Un.BEGIN,dirty:e}))}}class Xt extends oe{constructor(e){super("w:fldChar"),this.root.push(new Wn({type:Un.SEPARATE,dirty:e}))}}class Zt extends oe{constructor(e){super("w:fldChar"),this.root.push(new Wn({type:Un.END,dirty:e}))}}const Tt={DEFAULT:"default",PRESERVE:"preserve"};class At extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{space:"xml:space"})}}class Gl extends oe{constructor(){super("w:instrText"),this.root.push(new At({space:Tt.PRESERVE})),this.root.push("PAGE")}}class Kl extends oe{constructor(){super("w:instrText"),this.root.push(new At({space:Tt.PRESERVE})),this.root.push("NUMPAGES")}}class ql extends oe{constructor(){super("w:instrText"),this.root.push(new At({space:Tt.PRESERVE})),this.root.push("SECTIONPAGES")}}class Vl extends oe{constructor(){super("w:instrText"),this.root.push(new At({space:Tt.PRESERVE})),this.root.push("SECTION")}}class $l extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{fill:"w:fill",color:"w:color",type:"w:val"})}}class os extends oe{constructor({fill:e,color:r,type:l}){super("w:shd"),this.root.push(new $l({fill:e===void 0?void 0:St(e),color:r===void 0?void 0:St(r),type:l}))}}class Xl extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"w:id",author:"w:author",date:"w:date"})}}const Zl={DOT:"dot"};class Yl extends oe{constructor(e){super("w:em"),this.root.push(new Fe({val:e}))}}class Jl extends Yl{constructor(e=Zl.DOT){super(e)}}class Ql extends oe{constructor(e){super("w:spacing"),this.root.push(new Fe({val:ft(e)}))}}class eu extends oe{constructor(e){super("w:color"),this.root.push(new Fe({val:St(e)}))}}class tu extends oe{constructor(e){super("w:highlight"),this.root.push(new Fe({val:e}))}}class ru extends oe{constructor(e){super("w:highlightCs"),this.root.push(new Fe({val:e}))}}const nu=t=>new st({name:"w:lang",attributes:{value:{key:"w:val",value:t.value},eastAsia:{key:"w:eastAsia",value:t.eastAsia},bidirectional:{key:"w:bidi",value:t.bidirectional}}});class Xa extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{ascii:"w:ascii",cs:"w:cs",eastAsia:"w:eastAsia",hAnsi:"w:hAnsi",hint:"w:hint"})}}class ln extends oe{constructor(e,r){if(super("w:rFonts"),typeof e=="string"){const l=e;this.root.push(new Xa({ascii:l,cs:l,eastAsia:l,hAnsi:l,hint:r}))}else{const l=e;this.root.push(new Xa(l))}}}let ls=class extends oe{constructor(e){super("w:vertAlign"),this.root.push(new Fe({val:e}))}};class au extends ls{constructor(){super("superscript")}}class iu extends ls{constructor(){super("subscript")}}const us={SINGLE:"single"};class su extends oe{constructor(e=us.SINGLE,r){super("w:u"),this.root.push(new Fe({val:e,color:r===void 0?void 0:St(r)}))}}class mt extends ur{constructor(e){var r,l;if(super("w:rPr"),!e)return;e.noProof!==void 0&&this.push(new ue("w:noProof",e.noProof)),e.bold!==void 0&&this.push(new ue("w:b",e.bold)),(e.boldComplexScript===void 0&&e.bold!==void 0||e.boldComplexScript)&&this.push(new ue("w:bCs",(r=e.boldComplexScript)!=null?r:e.bold)),e.italics!==void 0&&this.push(new ue("w:i",e.italics)),(e.italicsComplexScript===void 0&&e.italics!==void 0||e.italicsComplexScript)&&this.push(new ue("w:iCs",(l=e.italicsComplexScript)!=null?l:e.italics)),e.underline&&this.push(new su(e.underline.type,e.underline.color)),e.effect&&this.push(new kt("w:effect",e.effect)),e.emphasisMark&&this.push(new Jl(e.emphasisMark.type)),e.color&&this.push(new eu(e.color)),e.kern&&this.push(new on("w:kern",e.kern)),e.position&&this.push(new kt("w:position",e.position)),e.size!==void 0&&this.push(new on("w:sz",e.size));const d=e.sizeComplexScript===void 0||e.sizeComplexScript===!0?e.size:e.sizeComplexScript;d&&this.push(new on("w:szCs",d)),e.rightToLeft!==void 0&&this.push(new ue("w:rtl",e.rightToLeft)),e.smallCaps!==void 0?this.push(new ue("w:smallCaps",e.smallCaps)):e.allCaps!==void 0&&this.push(new ue("w:caps",e.allCaps)),e.strike!==void 0&&this.push(new ue("w:strike",e.strike)),e.doubleStrike!==void 0&&this.push(new ue("w:dstrike",e.doubleStrike)),e.subScript&&this.push(new iu),e.superScript&&this.push(new au),e.style&&this.push(new kt("w:rStyle",e.style)),e.font&&(typeof e.font=="string"?this.push(new ln(e.font)):"name"in e.font?this.push(new ln(e.font.name,e.font.hint)):this.push(new ln(e.font))),e.highlight&&this.push(new tu(e.highlight));const o=e.highlightComplexScript===void 0||e.highlightComplexScript===!0?e.highlight:e.highlightComplexScript;o&&this.push(new ru(o)),e.characterSpacing&&this.push(new Ql(e.characterSpacing)),e.emboss!==void 0&&this.push(new ue("w:emboss",e.emboss)),e.imprint!==void 0&&this.push(new ue("w:imprint",e.imprint)),e.shading&&this.push(new os(e.shading)),e.revision&&this.push(new ou(e.revision)),e.border&&this.push(new Ce("w:bdr",e.border)),e.snapToGrid!==void 0&&this.push(new ue("w:snapToGrid",e.snapToGrid)),e.vanish&&this.push(new ue("w:vanish",e.vanish)),e.specVanish&&this.push(new ue("w:specVanish",e.vanish)),e.scale!==void 0&&this.push(new Mn("w:w",e.scale)),e.language&&this.push(nu(e.language)),e.math&&this.push(new ue("w:oMath",e.math))}push(e){this.root.push(e)}}class ou extends oe{constructor(e){super("w:rPrChange"),this.root.push(new Xl({id:e.id,author:e.author,date:e.date})),this.addChildElement(new mt(e))}}class xn extends oe{constructor(e){var r;return super("w:t"),typeof e=="string"?(this.root.push(new At({space:Tt.PRESERVE})),this.root.push(e),this):(this.root.push(new At({space:(r=e.space)!=null?r:Tt.DEFAULT})),this.root.push(e.text),this)}}const Yt={CURRENT:"CURRENT",TOTAL_PAGES:"TOTAL_PAGES",TOTAL_PAGES_IN_SECTION:"TOTAL_PAGES_IN_SECTION",CURRENT_SECTION:"SECTION"};class pr extends oe{constructor(e){if(super("w:r"),ie(this,"properties"),this.properties=new mt(e),this.root.push(this.properties),e.break)for(let r=0;r<e.break;r++)this.root.push(new Hl);if(e.children)for(const r of e.children){if(typeof r=="string"){switch(r){case Yt.CURRENT:this.root.push(new $t),this.root.push(new Gl),this.root.push(new Xt),this.root.push(new Zt);break;case Yt.TOTAL_PAGES:this.root.push(new $t),this.root.push(new Kl),this.root.push(new Xt),this.root.push(new Zt);break;case Yt.TOTAL_PAGES_IN_SECTION:this.root.push(new $t),this.root.push(new ql),this.root.push(new Xt),this.root.push(new Zt);break;case Yt.CURRENT_SECTION:this.root.push(new $t),this.root.push(new Vl),this.root.push(new Xt),this.root.push(new Zt);break;default:this.root.push(new xn(r));break}continue}this.root.push(r)}else e.text&&this.root.push(new xn(e.text))}}class sr extends pr{constructor(e){if(typeof e=="string")return super({}),this.root.push(new xn(e)),this;super(e)}}let lu="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict",uu=(t,e=21)=>(r=e)=>{let l="",d=r;for(;d--;)l+=t[Math.random()*t.length|0];return l},cu=(t=21)=>{let e="",r=t;for(;r--;)e+=lu[Math.random()*64|0];return e};const Ve=t=>Math.floor(t*72*20),Hn=(t=0)=>{let e=t;return()=>++e},du=()=>Hn(),fu=()=>Hn(1),hu=()=>Hn(),pu=()=>cu().toLowerCase(),Bt=t=>uu("1234567890abcdef",t)(),mu=()=>`${Bt(8)}-${Bt(4)}-${Bt(4)}-${Bt(4)}-${Bt(12)}`;class gu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"w:id",initials:"w:initials",author:"w:author",date:"w:date"})}}class wu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{"xmlns:cx":"xmlns:cx","xmlns:cx1":"xmlns:cx1","xmlns:cx2":"xmlns:cx2","xmlns:cx3":"xmlns:cx3","xmlns:cx4":"xmlns:cx4","xmlns:cx5":"xmlns:cx5","xmlns:cx6":"xmlns:cx6","xmlns:cx7":"xmlns:cx7","xmlns:cx8":"xmlns:cx8","xmlns:mc":"xmlns:mc","xmlns:aink":"xmlns:aink","xmlns:am3d":"xmlns:am3d","xmlns:o":"xmlns:o","xmlns:r":"xmlns:r","xmlns:m":"xmlns:m","xmlns:v":"xmlns:v","xmlns:wp14":"xmlns:wp14","xmlns:wp":"xmlns:wp","xmlns:w10":"xmlns:w10","xmlns:w":"xmlns:w","xmlns:w14":"xmlns:w14","xmlns:w15":"xmlns:w15","xmlns:w16cex":"xmlns:w16cex","xmlns:w16cid":"xmlns:w16cid","xmlns:w16":"xmlns:w16","xmlns:w16sdtdh":"xmlns:w16sdtdh","xmlns:w16se":"xmlns:w16se","xmlns:wpg":"xmlns:wpg","xmlns:wpi":"xmlns:wpi","xmlns:wne":"xmlns:wne","xmlns:wps":"xmlns:wps"})}}class bu extends oe{constructor({id:e,initials:r,author:l,date:d=new Date,children:o}){super("w:comment"),this.root.push(new gu({id:e,initials:r,author:l,date:d.toISOString()}));for(const s of o)this.root.push(s)}}class yu extends oe{constructor({children:e}){super("w:comments"),this.root.push(new wu({"xmlns:cx":"http://schemas.microsoft.com/office/drawing/2014/chartex","xmlns:cx1":"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex","xmlns:cx2":"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex","xmlns:cx3":"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex","xmlns:cx4":"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex","xmlns:cx5":"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex","xmlns:cx6":"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex","xmlns:cx7":"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex","xmlns:cx8":"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex","xmlns:mc":"http://schemas.openxmlformats.org/markup-compatibility/2006","xmlns:aink":"http://schemas.microsoft.com/office/drawing/2016/ink","xmlns:am3d":"http://schemas.microsoft.com/office/drawing/2017/model3d","xmlns:o":"urn:schemas-microsoft-com:office:office","xmlns:r":"http://schemas.openxmlformats.org/officeDocument/2006/relationships","xmlns:m":"http://schemas.openxmlformats.org/officeDocument/2006/math","xmlns:v":"urn:schemas-microsoft-com:vml","xmlns:wp14":"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing","xmlns:wp":"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing","xmlns:w10":"urn:schemas-microsoft-com:office:word","xmlns:w":"http://schemas.openxmlformats.org/wordprocessingml/2006/main","xmlns:w14":"http://schemas.microsoft.com/office/word/2010/wordml","xmlns:w15":"http://schemas.microsoft.com/office/word/2012/wordml","xmlns:w16cex":"http://schemas.microsoft.com/office/word/2018/wordml/cex","xmlns:w16cid":"http://schemas.microsoft.com/office/word/2016/wordml/cid","xmlns:w16":"http://schemas.microsoft.com/office/word/2018/wordml","xmlns:w16sdtdh":"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash","xmlns:w16se":"http://schemas.microsoft.com/office/word/2015/wordml/symex","xmlns:wpg":"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup","xmlns:wpi":"http://schemas.microsoft.com/office/word/2010/wordprocessingInk","xmlns:wne":"http://schemas.microsoft.com/office/word/2006/wordml","xmlns:wps":"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}));for(const r of e)this.root.push(new bu(r))}}class xu extends oe{constructor(){super("w:pageBreakBefore")}}const vn={AUTO:"auto"};class vu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{after:"w:after",before:"w:before",line:"w:line",lineRule:"w:lineRule"})}}class ku extends oe{constructor(e){super("w:spacing"),this.root.push(new vu(e))}}let Jt=class extends oe{constructor(e){super("w:pStyle"),this.root.push(new Fe({val:e}))}};class _u extends oe{constructor(e){super("w:tabs");for(const r of e)this.root.push(new Su(r))}}const Za={LEFT:"left",RIGHT:"right"};class Eu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val",pos:"w:pos",leader:"w:leader"})}}class Su extends oe{constructor({type:e,position:r,leader:l}){super("w:tab"),this.root.push(new Eu({val:e,pos:r,leader:l}))}}class Ya extends oe{constructor(e,r){super("w:numPr"),this.root.push(new Tu(r)),this.root.push(new Au(e))}}class Tu extends oe{constructor(e){if(super("w:ilvl"),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Fe({val:e}))}}class Au extends oe{constructor(e){super("w:numId"),this.root.push(new Fe({val:typeof e=="string"?`{${e}}`:e}))}}class Nu extends oe{constructor(){super(...arguments),ie(this,"fileChild",Symbol())}}class ju extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"Id",type:"Type",target:"Target",targetMode:"TargetMode"})}}const Cu={EXTERNAL:"External"};class Ru extends oe{constructor(e,r,l,d){super("Relationship"),this.root.push(new ju({id:e,type:r,target:l,targetMode:d}))}}class Iu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"r:id",history:"w:history",anchor:"w:anchor"})}}class Fu extends oe{constructor(e,r,l){super("w:hyperlink"),ie(this,"linkId"),this.linkId=r;const d={history:1,anchor:l||void 0,id:l?void 0:`rId${this.linkId}`},o=new Iu(d);this.root.push(o),e.forEach(s=>{this.root.push(s)})}}class Ou extends oe{constructor(e){super("w:externalHyperlink"),this.options=e}}class Pu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"w:id",name:"w:name"})}}class Du extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{id:"w:id"})}}class Bu{constructor(e){ie(this,"bookmarkUniqueNumericId",hu()),ie(this,"start"),ie(this,"children"),ie(this,"end");const r=this.bookmarkUniqueNumericId();this.start=new Lu(e.id,r),this.children=e.children,this.end=new Mu(r)}}class Lu extends oe{constructor(e,r){super("w:bookmarkStart");const l=new Pu({name:e,id:r});this.root.push(l)}}class Mu extends oe{constructor(e){super("w:bookmarkEnd");const r=new Du({id:e});this.root.push(r)}}class zu extends oe{constructor(e){super("w:outlineLvl"),this.level=e,this.root.push(new Fe({val:e}))}}class Uu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{verticalAlign:"w:val"})}}class Wu extends oe{constructor(e){super("w:vAlign"),this.root.push(new Uu({verticalAlign:e}))}}const _t={DEFAULT:"default",FIRST:"first",EVEN:"even"};class Hu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{type:"w:type",id:"r:id"})}}const Ja={HEADER:"w:headerReference",FOOTER:"w:footerReference"};class un extends oe{constructor(e,r){super(e),this.root.push(new Hu({type:r.type||_t.DEFAULT,id:`rId${r.id}`}))}}class Gu extends oe{constructor({space:e,count:r,separate:l,equalWidth:d,children:o}){super("w:cols"),this.root.push(new Wt({space:{key:"w:space",value:e===void 0?void 0:$e(e)},count:{key:"w:num",value:r===void 0?void 0:Ue(r)},separate:{key:"w:sep",value:l},equalWidth:{key:"w:equalWidth",value:d}})),!d&&o&&o.forEach(s=>this.addChildElement(s))}}class Ku extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{type:"w:type",linePitch:"w:linePitch",charSpace:"w:charSpace"})}}class qu extends oe{constructor(e,r,l){super("w:docGrid"),this.root.push(new Ku({type:l,linePitch:Ue(e),charSpace:r?Ue(r):void 0}))}}const Vu=({countBy:t,start:e,restart:r,distance:l})=>new st({name:"w:lnNumType",attributes:{countBy:{key:"w:countBy",value:t===void 0?void 0:Ue(t)},start:{key:"w:start",value:e===void 0?void 0:Ue(e)},restart:{key:"w:restart",value:r},distance:{key:"w:distance",value:l===void 0?void 0:$e(l)}}});class Qa extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{display:"w:display",offsetFrom:"w:offsetFrom",zOrder:"w:zOrder"})}}class $u extends ur{constructor(e){if(super("w:pgBorders"),!e)return this;e.pageBorders?this.root.push(new Qa({display:e.pageBorders.display,offsetFrom:e.pageBorders.offsetFrom,zOrder:e.pageBorders.zOrder})):this.root.push(new Qa({})),e.pageBorderTop&&this.root.push(new Ce("w:top",e.pageBorderTop)),e.pageBorderLeft&&this.root.push(new Ce("w:left",e.pageBorderLeft)),e.pageBorderBottom&&this.root.push(new Ce("w:bottom",e.pageBorderBottom)),e.pageBorderRight&&this.root.push(new Ce("w:right",e.pageBorderRight))}}class Xu extends oe{constructor(e,r,l,d,o,s,a){super("w:pgMar"),this.root.push(new Wt({top:{key:"w:top",value:ft(e)},right:{key:"w:right",value:$e(r)},bottom:{key:"w:bottom",value:ft(l)},left:{key:"w:left",value:$e(d)},header:{key:"w:header",value:$e(o)},footer:{key:"w:footer",value:$e(s)},gutter:{key:"w:gutter",value:$e(a)}}))}}class Zu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{start:"w:start",formatType:"w:fmt",separator:"w:chapSep"})}}class Yu extends oe{constructor({start:e,formatType:r,separator:l}){super("w:pgNumType"),this.root.push(new Zu({start:e===void 0?void 0:Ue(e),formatType:r,separator:l}))}}const cs={PORTRAIT:"portrait",LANDSCAPE:"landscape"};class Ju extends oe{constructor(e,r,l){super("w:pgSz");const d=l===cs.LANDSCAPE,o=$e(e),s=$e(r);this.root.push(new Wt({width:{key:"w:w",value:d?s:o},height:{key:"w:h",value:d?o:s},orientation:{key:"w:orient",value:l}}))}}class Qu extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class ec extends oe{constructor(e){super("w:textDirection"),this.root.push(new Qu({val:e}))}}class tc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class rc extends oe{constructor(e){super("w:type"),this.root.push(new tc({val:e}))}}const ct={TOP:1440,RIGHT:1440,BOTTOM:1440,LEFT:1440,HEADER:708,FOOTER:708,GUTTER:0},cn={WIDTH:11906,HEIGHT:16838,ORIENTATION:cs.PORTRAIT};class nc extends oe{constructor({page:{size:{width:e=cn.WIDTH,height:r=cn.HEIGHT,orientation:l=cn.ORIENTATION}={},margin:{top:d=ct.TOP,right:o=ct.RIGHT,bottom:s=ct.BOTTOM,left:a=ct.LEFT,header:c=ct.HEADER,footer:x=ct.FOOTER,gutter:v=ct.GUTTER}={},pageNumbers:S={},borders:T,textDirection:w}={},grid:{linePitch:E=360,charSpace:y,type:A}={},headerWrapperGroup:p={},footerWrapperGroup:k={},lineNumbers:j,titlePage:O,verticalAlign:F,column:G,type:W}={}){super("w:sectPr"),this.addHeaderFooterGroup(Ja.HEADER,p),this.addHeaderFooterGroup(Ja.FOOTER,k),W&&this.root.push(new rc(W)),this.root.push(new Ju(e,r,l)),this.root.push(new Xu(d,o,s,a,c,x,v)),T&&this.root.push(new $u(T)),j&&this.root.push(Vu(j)),this.root.push(new Yu(S)),G&&this.root.push(new Gu(G)),F&&this.root.push(new Wu(F)),O!==void 0&&this.root.push(new ue("w:titlePg",O)),w&&this.root.push(new ec(w)),this.root.push(new qu(E,y,A))}addHeaderFooterGroup(e,r){r.default&&this.root.push(new un(e,{type:_t.DEFAULT,id:r.default.View.ReferenceId})),r.first&&this.root.push(new un(e,{type:_t.FIRST,id:r.first.View.ReferenceId})),r.even&&this.root.push(new un(e,{type:_t.EVEN,id:r.even.View.ReferenceId}))}}class ac extends oe{constructor(){super("w:body"),ie(this,"sections",[])}addSection(e){const r=this.sections.pop();this.root.push(this.createSectionParagraph(r)),this.sections.push(new nc(e))}prepForXml(e){return this.sections.length===1&&(this.root.splice(0,1),this.root.push(this.sections.pop())),super.prepForXml(e)}push(e){this.root.push(e)}createSectionParagraph(e){const r=new Ut({}),l=new Nt({});return l.push(e),r.addChildElement(l),r}}class Gt extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",aink:"xmlns:aink",am3d:"xmlns:am3d",w16cex:"xmlns:w16cex",w16cid:"xmlns:w16cid",w16:"xmlns:w16",w16sdtdh:"xmlns:w16sdtdh",w16se:"xmlns:w16se"})}}class ic extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{color:"w:color",themeColor:"w:themeColor",themeShade:"w:themeShade",themeTint:"w:themeTint"})}}class sc extends oe{constructor(e){super("w:background"),this.root.push(new ic({color:e.color===void 0?void 0:St(e.color),themeColor:e.themeColor,themeShade:e.themeShade===void 0?void 0:$a(e.themeShade),themeTint:e.themeTint===void 0?void 0:$a(e.themeTint)}))}}class oc extends oe{constructor(e){super("w:document"),ie(this,"body"),this.root.push(new Gt({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",aink:"http://schemas.microsoft.com/office/drawing/2016/ink",am3d:"http://schemas.microsoft.com/office/drawing/2017/model3d",w16cex:"http://schemas.microsoft.com/office/word/2018/wordml/cex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16:"http://schemas.microsoft.com/office/word/2018/wordml",w16sdtdh:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex",Ignorable:"w14 w15 wp14"})),this.body=new ac,e.background&&this.root.push(new sc(e.background)),this.root.push(this.body)}add(e){return this.body.push(e),this}get Body(){return this.body}}class lc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{xmlns:"xmlns"})}}class Rt extends oe{constructor(){super("Relationships"),this.root.push(new lc({xmlns:"http://schemas.openxmlformats.org/package/2006/relationships"}))}createRelationship(e,r,l,d){const o=new Ru(`rId${e}`,r,l,d);return this.root.push(o),o}get RelationshipCount(){return this.root.length-1}}class ds{constructor(e){ie(this,"document"),ie(this,"relationships"),this.document=new oc(e),this.relationships=new Rt}get View(){return this.document}get Relationships(){return this.relationships}}class uc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class cc extends oe{constructor(){super("w:wordWrap"),this.root.push(new uc({val:0}))}}const dc=t=>{var e,r;return new st({name:"w:framePr",attributes:{anchorLock:{key:"w:anchorLock",value:t.anchorLock},dropCap:{key:"w:dropCap",value:t.dropCap},width:{key:"w:w",value:t.width},height:{key:"w:h",value:t.height},x:{key:"w:x",value:t.position?t.position.x:void 0},y:{key:"w:y",value:t.position?t.position.y:void 0},anchorHorizontal:{key:"w:hAnchor",value:t.anchor.horizontal},anchorVertical:{key:"w:vAnchor",value:t.anchor.vertical},spaceHorizontal:{key:"w:hSpace",value:(e=t.space)==null?void 0:e.horizontal},spaceVertical:{key:"w:vSpace",value:(r=t.space)==null?void 0:r.vertical},rule:{key:"w:hRule",value:t.rule},alignmentX:{key:"w:xAlign",value:t.alignment?t.alignment.x:void 0},alignmentY:{key:"w:yAlign",value:t.alignment?t.alignment.y:void 0},lines:{key:"w:lines",value:t.lines},wrap:{key:"w:wrap",value:t.wrap}}})};class Nt extends ur{constructor(e){var r,l;if(super("w:pPr"),ie(this,"numberingReferences",[]),!e)return this;e.heading&&this.push(new Jt(e.heading)),e.bullet&&this.push(new Jt("ListParagraph")),e.numbering&&!e.style&&!e.heading&&(e.numbering.custom||this.push(new Jt("ListParagraph"))),e.style&&this.push(new Jt(e.style)),e.keepNext!==void 0&&this.push(new ue("w:keepNext",e.keepNext)),e.keepLines!==void 0&&this.push(new ue("w:keepLines",e.keepLines)),e.pageBreakBefore&&this.push(new xu),e.frame&&this.push(dc(e.frame)),e.widowControl!==void 0&&this.push(new ue("w:widowControl",e.widowControl)),e.bullet&&this.push(new Ya(1,e.bullet.level)),e.numbering&&(this.numberingReferences.push({reference:e.numbering.reference,instance:(r=e.numbering.instance)!=null?r:0}),this.push(new Ya(`${e.numbering.reference}-${(l=e.numbering.instance)!=null?l:0}`,e.numbering.level))),e.border&&this.push(new zl(e.border)),e.thematicBreak&&this.push(new Ul),e.shading&&this.push(new os(e.shading)),e.wordWrap&&this.push(new cc),e.overflowPunctuation&&this.push(new ue("w:overflowPunct",e.overflowPunctuation));const d=[...e.rightTabStop!==void 0?[{type:Za.RIGHT,position:e.rightTabStop}]:[],...e.tabStops?e.tabStops:[],...e.leftTabStop!==void 0?[{type:Za.LEFT,position:e.leftTabStop}]:[]];d.length>0&&this.push(new _u(d)),e.bidirectional!==void 0&&this.push(new ue("w:bidi",e.bidirectional)),e.spacing&&this.push(new ku(e.spacing)),e.indent&&this.push(new Wl(e.indent)),e.contextualSpacing!==void 0&&this.push(new ue("w:contextualSpacing",e.contextualSpacing)),e.alignment&&this.push(new Ll(e.alignment)),e.outlineLevel!==void 0&&this.push(new zu(e.outlineLevel)),e.suppressLineNumbers!==void 0&&this.push(new ue("w:suppressLineNumbers",e.suppressLineNumbers)),e.autoSpaceEastAsianText!==void 0&&this.push(new ue("w:autoSpaceDN",e.autoSpaceEastAsianText)),e.run&&this.push(new mt(e.run))}push(e){this.root.push(e)}prepForXml(e){if(e.viewWrapper instanceof ds)for(const r of this.numberingReferences)e.file.Numbering.createConcreteNumberingInstance(r.reference,r.instance);return super.prepForXml(e)}}class Ut extends Nu{constructor(e){if(super("w:p"),ie(this,"properties"),typeof e=="string")return this.properties=new Nt({}),this.root.push(this.properties),this.root.push(new sr(e)),this;if(this.properties=new Nt(e),this.root.push(this.properties),e.text&&this.root.push(new sr(e.text)),e.children)for(const r of e.children){if(r instanceof Bu){this.root.push(r.start);for(const l of r.children)this.root.push(l);this.root.push(r.end);continue}this.root.push(r)}}prepForXml(e){for(const r of this.root)if(r instanceof Ou){const l=this.root.indexOf(r),d=new Fu(r.options.children,pu());e.viewWrapper.Relationships.createRelationship(d.linkId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",r.options.link,Cu.EXTERNAL),this.root[l]=d}return super.prepForXml(e)}addRunToFront(e){return this.root.splice(1,0,e),this}}const gt={style:zn.NONE,size:0,color:"auto"},wt={style:zn.SINGLE,size:4,color:"auto"};class fc extends oe{constructor(e){super("w:tblBorders"),e.top?this.root.push(new Ce("w:top",e.top)):this.root.push(new Ce("w:top",wt)),e.left?this.root.push(new Ce("w:left",e.left)):this.root.push(new Ce("w:left",wt)),e.bottom?this.root.push(new Ce("w:bottom",e.bottom)):this.root.push(new Ce("w:bottom",wt)),e.right?this.root.push(new Ce("w:right",e.right)):this.root.push(new Ce("w:right",wt)),e.insideHorizontal?this.root.push(new Ce("w:insideH",e.insideHorizontal)):this.root.push(new Ce("w:insideH",wt)),e.insideVertical?this.root.push(new Ce("w:insideV",e.insideVertical)):this.root.push(new Ce("w:insideV",wt))}}ie(fc,"NONE",{top:gt,bottom:gt,left:gt,right:gt,insideHorizontal:gt,insideVertical:gt});class hc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class pc extends oe{constructor(){super("Properties"),this.root.push(new hc({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"}))}}class mc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{xmlns:"xmlns"})}}class gc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{contentType:"ContentType",extension:"Extension"})}}class at extends oe{constructor(e,r){super("Default"),this.root.push(new gc({contentType:e,extension:r}))}}class wc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{contentType:"ContentType",partName:"PartName"})}}class He extends oe{constructor(e,r){super("Override"),this.root.push(new wc({contentType:e,partName:r}))}}class bc extends oe{constructor(){super("Types"),this.root.push(new mc({xmlns:"http://schemas.openxmlformats.org/package/2006/content-types"})),this.root.push(new at("image/png","png")),this.root.push(new at("image/jpeg","jpeg")),this.root.push(new at("image/jpeg","jpg")),this.root.push(new at("image/bmp","bmp")),this.root.push(new at("image/gif","gif")),this.root.push(new at("application/vnd.openxmlformats-package.relationships+xml","rels")),this.root.push(new at("application/xml","xml")),this.root.push(new at("application/vnd.openxmlformats-officedocument.obfuscatedFont","odttf")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.document.main+xml","/word/document.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.styles+xml","/word/styles.xml")),this.root.push(new He("application/vnd.openxmlformats-package.core-properties+xml","/docProps/core.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.custom-properties+xml","/docProps/custom.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.extended-properties+xml","/docProps/app.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.numbering+xml","/word/numbering.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.footnotes+xml","/word/footnotes.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.settings+xml","/word/settings.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.comments+xml","/word/comments.xml")),this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.fontTable+xml","/word/fontTable.xml"))}addFooter(e){this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.footer+xml",`/word/footer${e}.xml`))}addHeader(e){this.root.push(new He("application/vnd.openxmlformats-officedocument.wordprocessingml.header+xml",`/word/header${e}.xml`))}}class yc extends oe{constructor(e){super("cp:coreProperties"),this.root.push(new Gt({cp:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",xsi:"http://www.w3.org/2001/XMLSchema-instance"})),e.title&&this.root.push(new ut("dc:title",e.title)),e.subject&&this.root.push(new ut("dc:subject",e.subject)),e.creator&&this.root.push(new ut("dc:creator",e.creator)),e.keywords&&this.root.push(new ut("cp:keywords",e.keywords)),e.description&&this.root.push(new ut("dc:description",e.description)),e.lastModifiedBy&&this.root.push(new ut("cp:lastModifiedBy",e.lastModifiedBy)),e.revision&&this.root.push(new ut("cp:revision",String(e.revision))),this.root.push(new ei("dcterms:created")),this.root.push(new ei("dcterms:modified"))}}class ei extends oe{constructor(e){super(e),this.root.push(new Gt({type:"dcterms:W3CDTF"})),this.root.push(Dl(new Date))}}class xc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{xmlns:"xmlns",vt:"xmlns:vt"})}}class vc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{fmtid:"fmtid",pid:"pid",name:"name"})}}class kc extends oe{constructor(e,r){super("property"),this.root.push(new vc({fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e.toString(),name:r.name})),this.root.push(new _c(r.value))}}class _c extends oe{constructor(e){super("vt:lpwstr"),this.root.push(e)}}class Ec extends oe{constructor(e){super("Properties"),ie(this,"nextId"),ie(this,"properties",[]),this.root.push(new xc({xmlns:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes"})),this.nextId=2;for(const r of e)this.addCustomProperty(r)}prepForXml(e){return this.properties.forEach(r=>this.root.push(r)),super.prepForXml(e)}addCustomProperty(e){this.properties.push(new kc(this.nextId++,e))}}class Sc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type"})}}let Tc=class extends ns{constructor(e,r){super("w:ftr",r),ie(this,"refId"),this.refId=e,r||this.root.push(new Sc({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class Ac{constructor(e,r,l){ie(this,"footer"),ie(this,"relationships"),this.media=e,this.footer=new Tc(r,l),this.relationships=new Rt}add(e){this.footer.add(e)}addChildElement(e){this.footer.addChildElement(e)}get View(){return this.footer}get Relationships(){return this.relationships}get Media(){return this.media}}class Nc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{type:"w:type",id:"w:id"})}}class jc extends oe{constructor(){super("w:footnoteRef")}}class Cc extends pr{constructor(){super({style:"FootnoteReference"}),this.root.push(new jc)}}const ti={SEPERATOR:"separator",CONTINUATION_SEPERATOR:"continuationSeparator"};class dn extends oe{constructor(e){super("w:footnote"),this.root.push(new Nc({type:e.type,id:e.id}));for(let r=0;r<e.children.length;r++){const l=e.children[r];r===0&&l.addRunToFront(new Cc),this.root.push(l)}}}class Rc extends oe{constructor(){super("w:continuationSeparator")}}class Ic extends pr{constructor(){super({}),this.root.push(new Rc)}}class Fc extends oe{constructor(){super("w:separator")}}class Oc extends pr{constructor(){super({}),this.root.push(new Fc)}}class Pc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class Dc extends oe{constructor(){super("w:footnotes"),this.root.push(new Pc({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const e=new dn({id:-1,type:ti.SEPERATOR,children:[new Ut({spacing:{after:0,line:240,lineRule:vn.AUTO},children:[new Oc]})]});this.root.push(e);const r=new dn({id:0,type:ti.CONTINUATION_SEPERATOR,children:[new Ut({spacing:{after:0,line:240,lineRule:vn.AUTO},children:[new Ic]})]});this.root.push(r)}createFootNote(e,r){const l=new dn({id:e,children:r});this.root.push(l)}}class Bc{constructor(){ie(this,"footnotess"),ie(this,"relationships"),this.footnotess=new Dc,this.relationships=new Rt}get View(){return this.footnotess}get Relationships(){return this.relationships}}class Lc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",cp:"xmlns:cp",dc:"xmlns:dc",dcterms:"xmlns:dcterms",dcmitype:"xmlns:dcmitype",xsi:"xmlns:xsi",type:"xsi:type",cx:"xmlns:cx",cx1:"xmlns:cx1",cx2:"xmlns:cx2",cx3:"xmlns:cx3",cx4:"xmlns:cx4",cx5:"xmlns:cx5",cx6:"xmlns:cx6",cx7:"xmlns:cx7",cx8:"xmlns:cx8",w16cid:"xmlns:w16cid",w16se:"xmlns:w16se"})}}let Mc=class extends ns{constructor(e,r){super("w:hdr",r),ie(this,"refId"),this.refId=e,r||this.root.push(new Lc({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",cx:"http://schemas.microsoft.com/office/drawing/2014/chartex",cx1:"http://schemas.microsoft.com/office/drawing/2015/9/8/chartex",cx2:"http://schemas.microsoft.com/office/drawing/2015/10/21/chartex",cx3:"http://schemas.microsoft.com/office/drawing/2016/5/9/chartex",cx4:"http://schemas.microsoft.com/office/drawing/2016/5/10/chartex",cx5:"http://schemas.microsoft.com/office/drawing/2016/5/11/chartex",cx6:"http://schemas.microsoft.com/office/drawing/2016/5/12/chartex",cx7:"http://schemas.microsoft.com/office/drawing/2016/5/13/chartex",cx8:"http://schemas.microsoft.com/office/drawing/2016/5/14/chartex",w16cid:"http://schemas.microsoft.com/office/word/2016/wordml/cid",w16se:"http://schemas.microsoft.com/office/word/2015/wordml/symex"}))}get ReferenceId(){return this.refId}add(e){this.root.push(e)}};class zc{constructor(e,r,l){ie(this,"header"),ie(this,"relationships"),this.media=e,this.header=new Mc(r,l),this.relationships=new Rt}add(e){return this.header.add(e),this}addChildElement(e){this.header.addChildElement(e)}get View(){return this.header}get Relationships(){return this.relationships}get Media(){return this.media}}class Uc{constructor(){ie(this,"map"),this.map=new Map}addImage(e,r){this.map.set(e,r)}get Array(){return Array.from(this.map.values())}}const tt={BULLET:"bullet"};class Wc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{ilvl:"w:ilvl",tentative:"w15:tentative"})}}class Hc extends oe{constructor(e){super("w:numFmt"),this.root.push(new Fe({val:e}))}}class Gc extends oe{constructor(e){super("w:lvlText"),this.root.push(new Fe({val:e}))}}class Kc extends oe{constructor(e){super("w:lvlJc"),this.root.push(new Fe({val:e}))}}class qc extends oe{constructor(e){super("w:suff"),this.root.push(new Fe({val:e}))}}class Vc extends oe{constructor(){super("w:isLgl")}}class $c extends oe{constructor({level:e,format:r,text:l,alignment:d=Xe.START,start:o=1,style:s,suffix:a,isLegalNumberingStyle:c}){if(super("w:lvl"),ie(this,"paragraphProperties"),ie(this,"runProperties"),this.root.push(new Mn("w:start",Ue(o))),r&&this.root.push(new Hc(r)),a&&this.root.push(new qc(a)),c&&this.root.push(new Vc),l&&this.root.push(new Gc(l)),this.root.push(new Kc(d)),this.paragraphProperties=new Nt(s&&s.paragraph),this.runProperties=new mt(s&&s.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties),e>9)throw new Error("Level cannot be greater than 9. Read more here: https://answers.microsoft.com/en-us/msoffice/forum/all/does-word-support-more-than-9-list-levels/d130fdcd-1781-446d-8c84-c6c79124e4d7");this.root.push(new Wc({ilvl:Ue(e),tentative:1}))}}class Xc extends $c{}class Zc extends oe{constructor(e){super("w:multiLevelType"),this.root.push(new Fe({val:e}))}}class Yc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{abstractNumId:"w:abstractNumId",restartNumberingAfterBreak:"w15:restartNumberingAfterBreak"})}}class ri extends oe{constructor(e,r){super("w:abstractNum"),ie(this,"id"),this.root.push(new Yc({abstractNumId:Ue(e),restartNumberingAfterBreak:0})),this.root.push(new Zc("hybridMultilevel")),this.id=e;for(const l of r)this.root.push(new Xc(l))}}class Jc extends oe{constructor(e){super("w:abstractNumId"),this.root.push(new Fe({val:e}))}}class Qc extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{numId:"w:numId"})}}class ni extends oe{constructor(e){if(super("w:num"),ie(this,"numId"),ie(this,"reference"),ie(this,"instance"),this.numId=e.numId,this.reference=e.reference,this.instance=e.instance,this.root.push(new Qc({numId:Ue(e.numId)})),this.root.push(new Jc(Ue(e.abstractNumId))),e.overrideLevels&&e.overrideLevels.length)for(const r of e.overrideLevels)this.root.push(new td(r.num,r.start))}}class ed extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{ilvl:"w:ilvl"})}}class td extends oe{constructor(e,r){super("w:lvlOverride"),this.root.push(new ed({ilvl:e})),r!==void 0&&this.root.push(new nd(r))}}class rd extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class nd extends oe{constructor(e){super("w:startOverride"),this.root.push(new rd({val:e}))}}class ad extends oe{constructor(e){super("w:numbering"),ie(this,"abstractNumberingMap",new Map),ie(this,"concreteNumberingMap",new Map),ie(this,"referenceConfigMap",new Map),ie(this,"abstractNumUniqueNumericId",du()),ie(this,"concreteNumUniqueNumericId",fu()),this.root.push(new Gt({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"}));const r=new ri(this.abstractNumUniqueNumericId(),[{level:0,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:Ve(.5),hanging:Ve(.25)}}}},{level:1,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:Ve(1),hanging:Ve(.25)}}}},{level:2,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:2160,hanging:Ve(.25)}}}},{level:3,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:2880,hanging:Ve(.25)}}}},{level:4,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:3600,hanging:Ve(.25)}}}},{level:5,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:4320,hanging:Ve(.25)}}}},{level:6,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:5040,hanging:Ve(.25)}}}},{level:7,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:5760,hanging:Ve(.25)}}}},{level:8,format:tt.BULLET,text:"",alignment:Xe.LEFT,style:{paragraph:{indent:{left:6480,hanging:Ve(.25)}}}}]);this.concreteNumberingMap.set("default-bullet-numbering",new ni({numId:1,abstractNumId:r.id,reference:"default-bullet-numbering",instance:0,overrideLevels:[{num:0,start:1}]})),this.abstractNumberingMap.set("default-bullet-numbering",r);for(const l of e.config)this.abstractNumberingMap.set(l.reference,new ri(this.abstractNumUniqueNumericId(),l.levels)),this.referenceConfigMap.set(l.reference,l.levels)}prepForXml(e){for(const r of this.abstractNumberingMap.values())this.root.push(r);for(const r of this.concreteNumberingMap.values())this.root.push(r);return super.prepForXml(e)}createConcreteNumberingInstance(e,r){const l=this.abstractNumberingMap.get(e);if(!l)return;const d=`${e}-${r}`;if(this.concreteNumberingMap.has(d))return;const o=this.referenceConfigMap.get(e),s=o&&o[0].start,a={numId:this.concreteNumUniqueNumericId(),abstractNumId:l.id,reference:e,instance:r,overrideLevels:[s&&Number.isInteger(s)?{num:0,start:s}:{num:0,start:1}]};this.concreteNumberingMap.set(d,new ni(a))}get ConcreteNumbering(){return Array.from(this.concreteNumberingMap.values())}get ReferenceConfig(){return Array.from(this.referenceConfigMap.values())}}class id extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{version:"w:val",name:"w:name",uri:"w:uri"})}}class sd extends oe{constructor(e){super("w:compatSetting"),this.root.push(new id({version:e,uri:"http://schemas.microsoft.com/office/word",name:"compatibilityMode"}))}}class od extends oe{constructor(e){super("w:compat"),e.version&&this.root.push(new sd(e.version)),e.useSingleBorderforContiguousCells&&this.root.push(new ue("w:useSingleBorderforContiguousCells",e.useSingleBorderforContiguousCells)),e.wordPerfectJustification&&this.root.push(new ue("w:wpJustification",e.wordPerfectJustification)),e.noTabStopForHangingIndent&&this.root.push(new ue("w:noTabHangInd",e.noTabStopForHangingIndent)),e.noLeading&&this.root.push(new ue("w:noLeading",e.noLeading)),e.spaceForUnderline&&this.root.push(new ue("w:spaceForUL",e.spaceForUnderline)),e.noColumnBalance&&this.root.push(new ue("w:noColumnBalance",e.noColumnBalance)),e.balanceSingleByteDoubleByteWidth&&this.root.push(new ue("w:balanceSingleByteDoubleByteWidth",e.balanceSingleByteDoubleByteWidth)),e.noExtraLineSpacing&&this.root.push(new ue("w:noExtraLineSpacing",e.noExtraLineSpacing)),e.doNotLeaveBackslashAlone&&this.root.push(new ue("w:doNotLeaveBackslashAlone",e.doNotLeaveBackslashAlone)),e.underlineTrailingSpaces&&this.root.push(new ue("w:ulTrailSpace",e.underlineTrailingSpaces)),e.doNotExpandShiftReturn&&this.root.push(new ue("w:doNotExpandShiftReturn",e.doNotExpandShiftReturn)),e.spacingInWholePoints&&this.root.push(new ue("w:spacingInWholePoints",e.spacingInWholePoints)),e.lineWrapLikeWord6&&this.root.push(new ue("w:lineWrapLikeWord6",e.lineWrapLikeWord6)),e.printBodyTextBeforeHeader&&this.root.push(new ue("w:printBodyTextBeforeHeader",e.printBodyTextBeforeHeader)),e.printColorsBlack&&this.root.push(new ue("w:printColBlack",e.printColorsBlack)),e.spaceWidth&&this.root.push(new ue("w:wpSpaceWidth",e.spaceWidth)),e.showBreaksInFrames&&this.root.push(new ue("w:showBreaksInFrames",e.showBreaksInFrames)),e.subFontBySize&&this.root.push(new ue("w:subFontBySize",e.subFontBySize)),e.suppressBottomSpacing&&this.root.push(new ue("w:suppressBottomSpacing",e.suppressBottomSpacing)),e.suppressTopSpacing&&this.root.push(new ue("w:suppressTopSpacing",e.suppressTopSpacing)),e.suppressSpacingAtTopOfPage&&this.root.push(new ue("w:suppressSpacingAtTopOfPage",e.suppressSpacingAtTopOfPage)),e.suppressTopSpacingWP&&this.root.push(new ue("w:suppressTopSpacingWP",e.suppressTopSpacingWP)),e.suppressSpBfAfterPgBrk&&this.root.push(new ue("w:suppressSpBfAfterPgBrk",e.suppressSpBfAfterPgBrk)),e.swapBordersFacingPages&&this.root.push(new ue("w:swapBordersFacingPages",e.swapBordersFacingPages)),e.convertMailMergeEsc&&this.root.push(new ue("w:convMailMergeEsc",e.convertMailMergeEsc)),e.truncateFontHeightsLikeWP6&&this.root.push(new ue("w:truncateFontHeightsLikeWP6",e.truncateFontHeightsLikeWP6)),e.macWordSmallCaps&&this.root.push(new ue("w:mwSmallCaps",e.macWordSmallCaps)),e.usePrinterMetrics&&this.root.push(new ue("w:usePrinterMetrics",e.usePrinterMetrics)),e.doNotSuppressParagraphBorders&&this.root.push(new ue("w:doNotSuppressParagraphBorders",e.doNotSuppressParagraphBorders)),e.wrapTrailSpaces&&this.root.push(new ue("w:wrapTrailSpaces",e.wrapTrailSpaces)),e.footnoteLayoutLikeWW8&&this.root.push(new ue("w:footnoteLayoutLikeWW8",e.footnoteLayoutLikeWW8)),e.shapeLayoutLikeWW8&&this.root.push(new ue("w:shapeLayoutLikeWW8",e.shapeLayoutLikeWW8)),e.alignTablesRowByRow&&this.root.push(new ue("w:alignTablesRowByRow",e.alignTablesRowByRow)),e.forgetLastTabAlignment&&this.root.push(new ue("w:forgetLastTabAlignment",e.forgetLastTabAlignment)),e.adjustLineHeightInTable&&this.root.push(new ue("w:adjustLineHeightInTable",e.adjustLineHeightInTable)),e.autoSpaceLikeWord95&&this.root.push(new ue("w:autoSpaceLikeWord95",e.autoSpaceLikeWord95)),e.noSpaceRaiseLower&&this.root.push(new ue("w:noSpaceRaiseLower",e.noSpaceRaiseLower)),e.doNotUseHTMLParagraphAutoSpacing&&this.root.push(new ue("w:doNotUseHTMLParagraphAutoSpacing",e.doNotUseHTMLParagraphAutoSpacing)),e.layoutRawTableWidth&&this.root.push(new ue("w:layoutRawTableWidth",e.layoutRawTableWidth)),e.layoutTableRowsApart&&this.root.push(new ue("w:layoutTableRowsApart",e.layoutTableRowsApart)),e.useWord97LineBreakRules&&this.root.push(new ue("w:useWord97LineBreakRules",e.useWord97LineBreakRules)),e.doNotBreakWrappedTables&&this.root.push(new ue("w:doNotBreakWrappedTables",e.doNotBreakWrappedTables)),e.doNotSnapToGridInCell&&this.root.push(new ue("w:doNotSnapToGridInCell",e.doNotSnapToGridInCell)),e.selectFieldWithFirstOrLastCharacter&&this.root.push(new ue("w:selectFldWithFirstOrLastChar",e.selectFieldWithFirstOrLastCharacter)),e.applyBreakingRules&&this.root.push(new ue("w:applyBreakingRules",e.applyBreakingRules)),e.doNotWrapTextWithPunctuation&&this.root.push(new ue("w:doNotWrapTextWithPunct",e.doNotWrapTextWithPunctuation)),e.doNotUseEastAsianBreakRules&&this.root.push(new ue("w:doNotUseEastAsianBreakRules",e.doNotUseEastAsianBreakRules)),e.useWord2002TableStyleRules&&this.root.push(new ue("w:useWord2002TableStyleRules",e.useWord2002TableStyleRules)),e.growAutofit&&this.root.push(new ue("w:growAutofit",e.growAutofit)),e.useFELayout&&this.root.push(new ue("w:useFELayout",e.useFELayout)),e.useNormalStyleForList&&this.root.push(new ue("w:useNormalStyleForList",e.useNormalStyleForList)),e.doNotUseIndentAsNumberingTabStop&&this.root.push(new ue("w:doNotUseIndentAsNumberingTabStop",e.doNotUseIndentAsNumberingTabStop)),e.useAlternateEastAsianLineBreakRules&&this.root.push(new ue("w:useAltKinsokuLineBreakRules",e.useAlternateEastAsianLineBreakRules)),e.allowSpaceOfSameStyleInTable&&this.root.push(new ue("w:allowSpaceOfSameStyleInTable",e.allowSpaceOfSameStyleInTable)),e.doNotSuppressIndentation&&this.root.push(new ue("w:doNotSuppressIndentation",e.doNotSuppressIndentation)),e.doNotAutofitConstrainedTables&&this.root.push(new ue("w:doNotAutofitConstrainedTables",e.doNotAutofitConstrainedTables)),e.autofitToFirstFixedWidthCell&&this.root.push(new ue("w:autofitToFirstFixedWidthCell",e.autofitToFirstFixedWidthCell)),e.underlineTabInNumberingList&&this.root.push(new ue("w:underlineTabInNumList",e.underlineTabInNumberingList)),e.displayHangulFixedWidth&&this.root.push(new ue("w:displayHangulFixedWidth",e.displayHangulFixedWidth)),e.splitPgBreakAndParaMark&&this.root.push(new ue("w:splitPgBreakAndParaMark",e.splitPgBreakAndParaMark)),e.doNotVerticallyAlignCellWithSp&&this.root.push(new ue("w:doNotVertAlignCellWithSp",e.doNotVerticallyAlignCellWithSp)),e.doNotBreakConstrainedForcedTable&&this.root.push(new ue("w:doNotBreakConstrainedForcedTable",e.doNotBreakConstrainedForcedTable)),e.ignoreVerticalAlignmentInTextboxes&&this.root.push(new ue("w:doNotVertAlignInTxbx",e.ignoreVerticalAlignmentInTextboxes)),e.useAnsiKerningPairs&&this.root.push(new ue("w:useAnsiKerningPairs",e.useAnsiKerningPairs)),e.cachedColumnBalance&&this.root.push(new ue("w:cachedColBalance",e.cachedColumnBalance))}}class ld extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{wpc:"xmlns:wpc",mc:"xmlns:mc",o:"xmlns:o",r:"xmlns:r",m:"xmlns:m",v:"xmlns:v",wp14:"xmlns:wp14",wp:"xmlns:wp",w10:"xmlns:w10",w:"xmlns:w",w14:"xmlns:w14",w15:"xmlns:w15",wpg:"xmlns:wpg",wpi:"xmlns:wpi",wne:"xmlns:wne",wps:"xmlns:wps",Ignorable:"mc:Ignorable"})}}class ud extends oe{constructor(e){var r,l,d,o;super("w:settings"),this.root.push(new ld({wpc:"http://schemas.microsoft.com/office/word/2010/wordprocessingCanvas",mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",o:"urn:schemas-microsoft-com:office:office",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",m:"http://schemas.openxmlformats.org/officeDocument/2006/math",v:"urn:schemas-microsoft-com:vml",wp14:"http://schemas.microsoft.com/office/word/2010/wordprocessingDrawing",wp:"http://schemas.openxmlformats.org/drawingml/2006/wordprocessingDrawing",w10:"urn:schemas-microsoft-com:office:word",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",wpg:"http://schemas.microsoft.com/office/word/2010/wordprocessingGroup",wpi:"http://schemas.microsoft.com/office/word/2010/wordprocessingInk",wne:"http://schemas.microsoft.com/office/word/2006/wordml",wps:"http://schemas.microsoft.com/office/word/2010/wordprocessingShape",Ignorable:"w14 w15 wp14"})),this.root.push(new ue("w:displayBackgroundShape",!0)),e.trackRevisions!==void 0&&this.root.push(new ue("w:trackRevisions",e.trackRevisions)),e.evenAndOddHeaders!==void 0&&this.root.push(new ue("w:evenAndOddHeaders",e.evenAndOddHeaders)),e.updateFields!==void 0&&this.root.push(new ue("w:updateFields",e.updateFields)),e.defaultTabStop!==void 0&&this.root.push(new Mn("w:defaultTabStop",e.defaultTabStop)),this.root.push(new od(zt(Ee({},(r=e.compatibility)!=null?r:{}),{version:(o=(d=(l=e.compatibility)==null?void 0:l.version)!=null?d:e.compatibilityModeVersion)!=null?o:15})))}}class fs extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{val:"w:val"})}}class cd extends oe{constructor(e){super("w:name"),this.root.push(new fs({val:e}))}}class dd extends oe{constructor(e){super("w:uiPriority"),this.root.push(new fs({val:Ue(e)}))}}class fd extends xe{constructor(){super(...arguments),ie(this,"xmlKeys",{type:"w:type",styleId:"w:styleId",default:"w:default",customStyle:"w:customStyle"})}}class hs extends oe{constructor(e,r){super("w:style"),this.root.push(new fd(e)),r.name&&this.root.push(new cd(r.name)),r.basedOn&&this.root.push(new kt("w:basedOn",r.basedOn)),r.next&&this.root.push(new kt("w:next",r.next)),r.link&&this.root.push(new kt("w:link",r.link)),r.uiPriority!==void 0&&this.root.push(new dd(r.uiPriority)),r.semiHidden!==void 0&&this.root.push(new ue("w:semiHidden",r.semiHidden)),r.unhideWhenUsed!==void 0&&this.root.push(new ue("w:unhideWhenUsed",r.unhideWhenUsed)),r.quickFormat!==void 0&&this.root.push(new ue("w:qFormat",r.quickFormat))}}class mr extends hs{constructor(e){super({type:"paragraph",styleId:e.id},e),ie(this,"paragraphProperties"),ie(this,"runProperties"),this.paragraphProperties=new Nt(e.paragraph),this.runProperties=new mt(e.run),this.root.push(this.paragraphProperties),this.root.push(this.runProperties)}}class gr extends hs{constructor(e){super({type:"character",styleId:e.id},Ee({uiPriority:99,unhideWhenUsed:!0},e)),ie(this,"runProperties"),this.runProperties=new mt(e.run),this.root.push(this.runProperties)}}class ot extends mr{constructor(e){super(Ee({basedOn:"Normal",next:"Normal",quickFormat:!0},e))}}class hd extends ot{constructor(e){super(Ee({id:"Title",name:"Title"},e))}}class pd extends ot{constructor(e){super(Ee({id:"Heading1",name:"Heading 1"},e))}}class md extends ot{constructor(e){super(Ee({id:"Heading2",name:"Heading 2"},e))}}class gd extends ot{constructor(e){super(Ee({id:"Heading3",name:"Heading 3"},e))}}class wd extends ot{constructor(e){super(Ee({id:"Heading4",name:"Heading 4"},e))}}class bd extends ot{constructor(e){super(Ee({id:"Heading5",name:"Heading 5"},e))}}class yd extends ot{constructor(e){super(Ee({id:"Heading6",name:"Heading 6"},e))}}class xd extends ot{constructor(e){super(Ee({id:"Strong",name:"Strong"},e))}}class vd extends mr{constructor(e){super(Ee({id:"ListParagraph",name:"List Paragraph",basedOn:"Normal",quickFormat:!0},e))}}class kd extends mr{constructor(e){super(Ee({id:"FootnoteText",name:"footnote text",link:"FootnoteTextChar",basedOn:"Normal",uiPriority:99,semiHidden:!0,unhideWhenUsed:!0,paragraph:{spacing:{after:0,line:240,lineRule:vn.AUTO}},run:{size:20}},e))}}class _d extends gr{constructor(e){super(Ee({id:"FootnoteReference",name:"footnote reference",basedOn:"DefaultParagraphFont",semiHidden:!0,run:{superScript:!0}},e))}}class Ed extends gr{constructor(e){super(Ee({id:"FootnoteTextChar",name:"Footnote Text Char",basedOn:"DefaultParagraphFont",link:"FootnoteText",semiHidden:!0,run:{size:20}},e))}}class Sd extends gr{constructor(e){super(Ee({id:"Hyperlink",name:"Hyperlink",basedOn:"DefaultParagraphFont",run:{color:"0563C1",underline:{type:us.SINGLE}}},e))}}class kn extends oe{constructor(e){if(super("w:styles"),e.initialStyles&&this.root.push(e.initialStyles),e.importedStyles)for(const r of e.importedStyles)this.root.push(r);if(e.paragraphStyles)for(const r of e.paragraphStyles)this.root.push(new mr(r));if(e.characterStyles)for(const r of e.characterStyles)this.root.push(new gr(r))}}class Td extends oe{constructor(e){super("w:pPrDefault"),this.root.push(new Nt(e))}}class Ad extends oe{constructor(e){super("w:rPrDefault"),this.root.push(new mt(e))}}class Nd extends oe{constructor(e){super("w:docDefaults"),ie(this,"runPropertiesDefaults"),ie(this,"paragraphPropertiesDefaults"),this.runPropertiesDefaults=new Ad(e.run),this.paragraphPropertiesDefaults=new Td(e.paragraph),this.root.push(this.runPropertiesDefaults),this.root.push(this.paragraphPropertiesDefaults)}}class jd{newInstance(e){const r=rs.xml2js(e,{compact:!1});let l;for(const s of r.elements||[])s.name==="w:styles"&&(l=s);if(l===void 0)throw new Error("can not find styles element");const d=l.elements||[];return new kn({initialStyles:new Il(l.attributes),importedStyles:d.map(s=>Ln(s))})}}class ai{newInstance(e={}){var r;return{initialStyles:new Gt({mc:"http://schemas.openxmlformats.org/markup-compatibility/2006",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",w:"http://schemas.openxmlformats.org/wordprocessingml/2006/main",w14:"http://schemas.microsoft.com/office/word/2010/wordml",w15:"http://schemas.microsoft.com/office/word/2012/wordml",Ignorable:"w14 w15"}),importedStyles:[new Nd((r=e.document)!=null?r:{}),new hd(Ee({run:{size:56}},e.title)),new pd(Ee({run:{color:"2E74B5",size:32}},e.heading1)),new md(Ee({run:{color:"2E74B5",size:26}},e.heading2)),new gd(Ee({run:{color:"1F4D78",size:24}},e.heading3)),new wd(Ee({run:{color:"2E74B5",italics:!0}},e.heading4)),new bd(Ee({run:{color:"2E74B5"}},e.heading5)),new yd(Ee({run:{color:"1F4D78"}},e.heading6)),new xd(Ee({run:{bold:!0}},e.strong)),new vd(e.listParagraph||{}),new Sd(e.hyperlink||{}),new _d(e.footnoteReference||{}),new kd(e.footnoteText||{}),new Ed(e.footnoteTextChar||{})]}}}const Qt=({id:t,fontKey:e,subsetted:r},l)=>new st({name:l,attributes:Ee({id:{key:"r:id",value:t}},e?{fontKey:{key:"w:fontKey",value:`{${e}}`}}:{}),children:[...r?[new ue("w:subsetted",r)]:[]]}),Cd=({name:t,altName:e,panose1:r,charset:l,family:d,notTrueType:o,pitch:s,sig:a,embedRegular:c,embedBold:x,embedItalic:v,embedBoldItalic:S})=>new st({name:"w:font",attributes:{name:{key:"w:name",value:t}},children:[...e?[Dt("w:altName",e)]:[],...r?[Dt("w:panose1",r)]:[],...l?[Dt("w:charset",l)]:[],Dt("w:family",d),...o?[new ue("w:notTrueType",o)]:[],Dt("w:pitch",s),...a?[new st({name:"w:sig",attributes:{usb0:{key:"w:usb0",value:a.usb0},usb1:{key:"w:usb1",value:a.usb1},usb2:{key:"w:usb2",value:a.usb2},usb3:{key:"w:usb3",value:a.usb3},csb0:{key:"w:csb0",value:a.csb0},csb1:{key:"w:csb1",value:a.csb1}}})]:[],...c?[Qt(c,"w:embedRegular")]:[],...x?[Qt(x,"w:embedBold")]:[],...v?[Qt(v,"w:embedItalic")]:[],...S?[Qt(S,"w:embedBoldItalic")]:[]]}),Rd=({name:t,index:e,fontKey:r,characterSet:l})=>Cd({name:t,sig:{usb0:"E0002AFF",usb1:"C000247B",usb2:"00000009",usb3:"00000000",csb0:"000001FF",csb1:"00000000"},charset:l,family:"auto",pitch:"variable",embedRegular:{fontKey:r,id:`rId${e}`}}),Id=t=>new st({name:"w:fonts",attributes:{mc:{key:"xmlns:mc",value:"http://schemas.openxmlformats.org/markup-compatibility/2006"},r:{key:"xmlns:r",value:"http://schemas.openxmlformats.org/officeDocument/2006/relationships"},w:{key:"xmlns:w",value:"http://schemas.openxmlformats.org/wordprocessingml/2006/main"},w14:{key:"xmlns:w14",value:"http://schemas.microsoft.com/office/word/2010/wordml"},w15:{key:"xmlns:w15",value:"http://schemas.microsoft.com/office/word/2012/wordml"},w16cex:{key:"xmlns:w16cex",value:"http://schemas.microsoft.com/office/word/2018/wordml/cex"},w16cid:{key:"xmlns:w16cid",value:"http://schemas.microsoft.com/office/word/2016/wordml/cid"},w16:{key:"xmlns:w16",value:"http://schemas.microsoft.com/office/word/2018/wordml"},w16sdtdh:{key:"xmlns:w16sdtdh",value:"http://schemas.microsoft.com/office/word/2020/wordml/sdtdatahash"},w16se:{key:"xmlns:w16se",value:"http://schemas.microsoft.com/office/word/2015/wordml/symex"},Ignorable:{key:"mc:Ignorable",value:"w14 w15 w16se w16cid w16 w16cex w16sdtdh"}},children:t.map((e,r)=>Rd({name:e.name,index:r+1,fontKey:e.fontKey}))});class Fd{constructor(e){ie(this,"fontTable"),ie(this,"relationships"),ie(this,"fontOptionsWithKey",[]),this.options=e,this.fontOptionsWithKey=e.map(r=>zt(Ee({},r),{fontKey:mu()})),this.fontTable=Id(this.fontOptionsWithKey),this.relationships=new Rt;for(let r=0;r<e.length;r++)this.relationships.createRelationship(r+1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/font",`fonts/${e[r].name}.odttf`)}get View(){return this.fontTable}get Relationships(){return this.relationships}}class Od{constructor(e){ie(this,"currentRelationshipId",1),ie(this,"documentWrapper"),ie(this,"headers",[]),ie(this,"footers",[]),ie(this,"coreProperties"),ie(this,"numbering"),ie(this,"media"),ie(this,"fileRelationships"),ie(this,"footnotesWrapper"),ie(this,"settings"),ie(this,"contentTypes"),ie(this,"customProperties"),ie(this,"appProperties"),ie(this,"styles"),ie(this,"comments"),ie(this,"fontWrapper");var r,l,d,o,s,a,c,x;if(this.coreProperties=new yc(zt(Ee({},e),{creator:(r=e.creator)!=null?r:"Un-named",revision:(l=e.revision)!=null?l:1,lastModifiedBy:(d=e.lastModifiedBy)!=null?d:"Un-named"})),this.numbering=new ad(e.numbering?e.numbering:{config:[]}),this.comments=new yu((o=e.comments)!=null?o:{children:[]}),this.fileRelationships=new Rt,this.customProperties=new Ec((s=e.customProperties)!=null?s:[]),this.appProperties=new pc,this.footnotesWrapper=new Bc,this.contentTypes=new bc,this.documentWrapper=new ds({background:e.background}),this.settings=new ud({compatibilityModeVersion:e.compatabilityModeVersion,compatibility:e.compatibility,evenAndOddHeaders:!!e.evenAndOddHeaderAndFooters,trackRevisions:(a=e.features)==null?void 0:a.trackRevisions,updateFields:(c=e.features)==null?void 0:c.updateFields,defaultTabStop:e.defaultTabStop}),this.media=new Uc,e.externalStyles){const v=new jd;this.styles=v.newInstance(e.externalStyles)}else if(e.styles){const S=new ai().newInstance(e.styles.default);this.styles=new kn(Ee(Ee({},S),e.styles))}else{const v=new ai;this.styles=new kn(v.newInstance())}this.addDefaultRelationships();for(const v of e.sections)this.addSection(v);if(e.footnotes)for(const v in e.footnotes)this.footnotesWrapper.View.createFootNote(parseFloat(v),e.footnotes[v].children);this.fontWrapper=new Fd((x=e.fonts)!=null?x:[])}addSection({headers:e={},footers:r={},children:l,properties:d}){this.documentWrapper.View.Body.addSection(zt(Ee({},d),{headerWrapperGroup:{default:e.default?this.createHeader(e.default):void 0,first:e.first?this.createHeader(e.first):void 0,even:e.even?this.createHeader(e.even):void 0},footerWrapperGroup:{default:r.default?this.createFooter(r.default):void 0,first:r.first?this.createFooter(r.first):void 0,even:r.even?this.createFooter(r.even):void 0}}));for(const o of l)this.documentWrapper.View.add(o)}createHeader(e){const r=new zc(this.media,this.currentRelationshipId++);for(const l of e.options.children)r.add(l);return this.addHeaderToDocument(r),r}createFooter(e){const r=new Ac(this.media,this.currentRelationshipId++);for(const l of e.options.children)r.add(l);return this.addFooterToDocument(r),r}addHeaderToDocument(e,r=_t.DEFAULT){this.headers.push({header:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/header",`header${this.headers.length}.xml`),this.contentTypes.addHeader(this.headers.length)}addFooterToDocument(e,r=_t.DEFAULT){this.footers.push({footer:e,type:r}),this.documentWrapper.Relationships.createRelationship(e.View.ReferenceId,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footer",`footer${this.footers.length}.xml`),this.contentTypes.addFooter(this.footers.length)}addDefaultRelationships(){this.fileRelationships.createRelationship(1,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument","word/document.xml"),this.fileRelationships.createRelationship(2,"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties","docProps/core.xml"),this.fileRelationships.createRelationship(3,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties","docProps/app.xml"),this.fileRelationships.createRelationship(4,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties","docProps/custom.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles","styles.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/numbering","numbering.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/footnotes","footnotes.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/settings","settings.xml"),this.documentWrapper.Relationships.createRelationship(this.currentRelationshipId++,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments","comments.xml")}get Document(){return this.documentWrapper}get Styles(){return this.styles}get CoreProperties(){return this.coreProperties}get Numbering(){return this.numbering}get Media(){return this.media}get FileRelationships(){return this.fileRelationships}get Headers(){return this.headers.map(e=>e.header)}get Footers(){return this.footers.map(e=>e.footer)}get ContentTypes(){return this.contentTypes}get CustomProperties(){return this.customProperties}get AppProperties(){return this.appProperties}get FootNotes(){return this.footnotesWrapper}get Settings(){return this.settings}get Comments(){return this.comments}get FontTable(){return this.fontWrapper}}function er(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ps={exports:{}};(function(t,e){(function(r){t.exports=r()})(function(){return function r(l,d,o){function s(x,v){if(!d[x]){if(!l[x]){var S=typeof er=="function"&&er;if(!v&&S)return S(x,!0);if(a)return a(x,!0);var T=new Error("Cannot find module '"+x+"'");throw T.code="MODULE_NOT_FOUND",T}var w=d[x]={exports:{}};l[x][0].call(w.exports,function(E){var y=l[x][1][E];return s(y||E)},w,w.exports,r,l,d,o)}return d[x].exports}for(var a=typeof er=="function"&&er,c=0;c<o.length;c++)s(o[c]);return s}({1:[function(r,l,d){var o=r("./utils"),s=r("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";d.encode=function(c){for(var x,v,S,T,w,E,y,A=[],p=0,k=c.length,j=k,O=o.getTypeOf(c)!=="string";p<c.length;)j=k-p,S=O?(x=c[p++],v=p<k?c[p++]:0,p<k?c[p++]:0):(x=c.charCodeAt(p++),v=p<k?c.charCodeAt(p++):0,p<k?c.charCodeAt(p++):0),T=x>>2,w=(3&x)<<4|v>>4,E=1<j?(15&v)<<2|S>>6:64,y=2<j?63&S:64,A.push(a.charAt(T)+a.charAt(w)+a.charAt(E)+a.charAt(y));return A.join("")},d.decode=function(c){var x,v,S,T,w,E,y=0,A=0,p="data:";if(c.substr(0,p.length)===p)throw new Error("Invalid base64 input, it looks like a data url.");var k,j=3*(c=c.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(c.charAt(c.length-1)===a.charAt(64)&&j--,c.charAt(c.length-2)===a.charAt(64)&&j--,j%1!=0)throw new Error("Invalid base64 input, bad content length.");for(k=s.uint8array?new Uint8Array(0|j):new Array(0|j);y<c.length;)x=a.indexOf(c.charAt(y++))<<2|(T=a.indexOf(c.charAt(y++)))>>4,v=(15&T)<<4|(w=a.indexOf(c.charAt(y++)))>>2,S=(3&w)<<6|(E=a.indexOf(c.charAt(y++))),k[A++]=x,w!==64&&(k[A++]=v),E!==64&&(k[A++]=S);return k}},{"./support":30,"./utils":32}],2:[function(r,l,d){var o=r("./external"),s=r("./stream/DataWorker"),a=r("./stream/Crc32Probe"),c=r("./stream/DataLengthProbe");function x(v,S,T,w,E){this.compressedSize=v,this.uncompressedSize=S,this.crc32=T,this.compression=w,this.compressedContent=E}x.prototype={getContentWorker:function(){var v=new s(o.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new c("data_length")),S=this;return v.on("end",function(){if(this.streamInfo.data_length!==S.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),v},getCompressedWorker:function(){return new s(o.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},x.createWorkerFrom=function(v,S,T){return v.pipe(new a).pipe(new c("uncompressedSize")).pipe(S.compressWorker(T)).pipe(new c("compressedSize")).withStreamInfo("compression",S)},l.exports=x},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(r,l,d){var o=r("./stream/GenericWorker");d.STORE={magic:"\0\0",compressWorker:function(){return new o("STORE compression")},uncompressWorker:function(){return new o("STORE decompression")}},d.DEFLATE=r("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(r,l,d){var o=r("./utils"),s=function(){for(var a,c=[],x=0;x<256;x++){a=x;for(var v=0;v<8;v++)a=1&a?3988292384^a>>>1:a>>>1;c[x]=a}return c}();l.exports=function(a,c){return a!==void 0&&a.length?o.getTypeOf(a)!=="string"?function(x,v,S,T){var w=s,E=T+S;x^=-1;for(var y=T;y<E;y++)x=x>>>8^w[255&(x^v[y])];return-1^x}(0|c,a,a.length,0):function(x,v,S,T){var w=s,E=T+S;x^=-1;for(var y=T;y<E;y++)x=x>>>8^w[255&(x^v.charCodeAt(y))];return-1^x}(0|c,a,a.length,0):0}},{"./utils":32}],5:[function(r,l,d){d.base64=!1,d.binary=!1,d.dir=!1,d.createFolders=!0,d.date=null,d.compression=null,d.compressionOptions=null,d.comment=null,d.unixPermissions=null,d.dosPermissions=null},{}],6:[function(r,l,d){var o=null;o=typeof Promise<"u"?Promise:r("lie"),l.exports={Promise:o}},{lie:37}],7:[function(r,l,d){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",s=r("pako"),a=r("./utils"),c=r("./stream/GenericWorker"),x=o?"uint8array":"array";function v(S,T){c.call(this,"FlateWorker/"+S),this._pako=null,this._pakoAction=S,this._pakoOptions=T,this.meta={}}d.magic="\b\0",a.inherits(v,c),v.prototype.processChunk=function(S){this.meta=S.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(x,S.data),!1)},v.prototype.flush=function(){c.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},v.prototype.cleanUp=function(){c.prototype.cleanUp.call(this),this._pako=null},v.prototype._createPako=function(){this._pako=new s[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var S=this;this._pako.onData=function(T){S.push({data:T,meta:S.meta})}},d.compressWorker=function(S){return new v("Deflate",S)},d.uncompressWorker=function(){return new v("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(r,l,d){function o(w,E){var y,A="";for(y=0;y<E;y++)A+=String.fromCharCode(255&w),w>>>=8;return A}function s(w,E,y,A,p,k){var j,O,F=w.file,G=w.compression,W=k!==x.utf8encode,$=a.transformTo("string",k(F.name)),N=a.transformTo("string",x.utf8encode(F.name)),ne=F.comment,se=a.transformTo("string",k(ne)),B=a.transformTo("string",x.utf8encode(ne)),X=N.length!==F.name.length,_=B.length!==ne.length,Y="",de="",Q="",pe=F.dir,te=F.date,fe={crc32:0,compressedSize:0,uncompressedSize:0};E&&!y||(fe.crc32=w.crc32,fe.compressedSize=w.compressedSize,fe.uncompressedSize=w.uncompressedSize);var H=0;E&&(H|=8),W||!X&&!_||(H|=2048);var R=0,q=0;pe&&(R|=16),p==="UNIX"?(q=798,R|=function(V,z){var g=V;return V||(g=z?16893:33204),(65535&g)<<16}(F.unixPermissions,pe)):(q=20,R|=function(V){return 63&(V||0)}(F.dosPermissions)),j=te.getUTCHours(),j<<=6,j|=te.getUTCMinutes(),j<<=5,j|=te.getUTCSeconds()/2,O=te.getUTCFullYear()-1980,O<<=4,O|=te.getUTCMonth()+1,O<<=5,O|=te.getUTCDate(),X&&(de=o(1,1)+o(v($),4)+N,Y+="up"+o(de.length,2)+de),_&&(Q=o(1,1)+o(v(se),4)+B,Y+="uc"+o(Q.length,2)+Q);var K="";return K+=`
\0`,K+=o(H,2),K+=G.magic,K+=o(j,2),K+=o(O,2),K+=o(fe.crc32,4),K+=o(fe.compressedSize,4),K+=o(fe.uncompressedSize,4),K+=o($.length,2),K+=o(Y.length,2),{fileRecord:S.LOCAL_FILE_HEADER+K+$+Y,dirRecord:S.CENTRAL_FILE_HEADER+o(q,2)+K+o(se.length,2)+"\0\0\0\0"+o(R,4)+o(A,4)+$+Y+se}}var a=r("../utils"),c=r("../stream/GenericWorker"),x=r("../utf8"),v=r("../crc32"),S=r("../signature");function T(w,E,y,A){c.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=E,this.zipPlatform=y,this.encodeFileName=A,this.streamFiles=w,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(T,c),T.prototype.push=function(w){var E=w.meta.percent||0,y=this.entriesCount,A=this._sources.length;this.accumulate?this.contentBuffer.push(w):(this.bytesWritten+=w.data.length,c.prototype.push.call(this,{data:w.data,meta:{currentFile:this.currentFile,percent:y?(E+100*(y-A-1))/y:100}}))},T.prototype.openedSource=function(w){this.currentSourceOffset=this.bytesWritten,this.currentFile=w.file.name;var E=this.streamFiles&&!w.file.dir;if(E){var y=s(w,E,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:y.fileRecord,meta:{percent:0}})}else this.accumulate=!0},T.prototype.closedSource=function(w){this.accumulate=!1;var E=this.streamFiles&&!w.file.dir,y=s(w,E,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(y.dirRecord),E)this.push({data:function(A){return S.DATA_DESCRIPTOR+o(A.crc32,4)+o(A.compressedSize,4)+o(A.uncompressedSize,4)}(w),meta:{percent:100}});else for(this.push({data:y.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},T.prototype.flush=function(){for(var w=this.bytesWritten,E=0;E<this.dirRecords.length;E++)this.push({data:this.dirRecords[E],meta:{percent:100}});var y=this.bytesWritten-w,A=function(p,k,j,O,F){var G=a.transformTo("string",F(O));return S.CENTRAL_DIRECTORY_END+"\0\0\0\0"+o(p,2)+o(p,2)+o(k,4)+o(j,4)+o(G.length,2)+G}(this.dirRecords.length,y,w,this.zipComment,this.encodeFileName);this.push({data:A,meta:{percent:100}})},T.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},T.prototype.registerPrevious=function(w){this._sources.push(w);var E=this;return w.on("data",function(y){E.processChunk(y)}),w.on("end",function(){E.closedSource(E.previous.streamInfo),E._sources.length?E.prepareNextSource():E.end()}),w.on("error",function(y){E.error(y)}),this},T.prototype.resume=function(){return!!c.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},T.prototype.error=function(w){var E=this._sources;if(!c.prototype.error.call(this,w))return!1;for(var y=0;y<E.length;y++)try{E[y].error(w)}catch{}return!0},T.prototype.lock=function(){c.prototype.lock.call(this);for(var w=this._sources,E=0;E<w.length;E++)w[E].lock()},l.exports=T},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(r,l,d){var o=r("../compressions"),s=r("./ZipFileWorker");d.generateWorker=function(a,c,x){var v=new s(c.streamFiles,x,c.platform,c.encodeFileName),S=0;try{a.forEach(function(T,w){S++;var E=function(k,j){var O=k||j,F=o[O];if(!F)throw new Error(O+" is not a valid compression method !");return F}(w.options.compression,c.compression),y=w.options.compressionOptions||c.compressionOptions||{},A=w.dir,p=w.date;w._compressWorker(E,y).withStreamInfo("file",{name:T,dir:A,date:p,comment:w.comment||"",unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions}).pipe(v)}),v.entriesCount=S}catch(T){v.error(T)}return v}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(r,l,d){function o(){if(!(this instanceof o))return new o;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var s=new o;for(var a in this)typeof this[a]!="function"&&(s[a]=this[a]);return s}}(o.prototype=r("./object")).loadAsync=r("./load"),o.support=r("./support"),o.defaults=r("./defaults"),o.version="3.10.1",o.loadAsync=function(s,a){return new o().loadAsync(s,a)},o.external=r("./external"),l.exports=o},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(r,l,d){var o=r("./utils"),s=r("./external"),a=r("./utf8"),c=r("./zipEntries"),x=r("./stream/Crc32Probe"),v=r("./nodejsUtils");function S(T){return new s.Promise(function(w,E){var y=T.decompressed.getContentWorker().pipe(new x);y.on("error",function(A){E(A)}).on("end",function(){y.streamInfo.crc32!==T.decompressed.crc32?E(new Error("Corrupted zip : CRC32 mismatch")):w()}).resume()})}l.exports=function(T,w){var E=this;return w=o.extend(w||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),v.isNode&&v.isStream(T)?s.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):o.prepareContent("the loaded zip file",T,!0,w.optimizedBinaryString,w.base64).then(function(y){var A=new c(w);return A.load(y),A}).then(function(y){var A=[s.Promise.resolve(y)],p=y.files;if(w.checkCRC32)for(var k=0;k<p.length;k++)A.push(S(p[k]));return s.Promise.all(A)}).then(function(y){for(var A=y.shift(),p=A.files,k=0;k<p.length;k++){var j=p[k],O=j.fileNameStr,F=o.resolve(j.fileNameStr);E.file(F,j.decompressed,{binary:!0,optimizedBinaryString:!0,date:j.date,dir:j.dir,comment:j.fileCommentStr.length?j.fileCommentStr:null,unixPermissions:j.unixPermissions,dosPermissions:j.dosPermissions,createFolders:w.createFolders}),j.dir||(E.file(F).unsafeOriginalName=O)}return A.zipComment.length&&(E.comment=A.zipComment),E})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(r,l,d){var o=r("../utils"),s=r("../stream/GenericWorker");function a(c,x){s.call(this,"Nodejs stream input adapter for "+c),this._upstreamEnded=!1,this._bindStream(x)}o.inherits(a,s),a.prototype._bindStream=function(c){var x=this;(this._stream=c).pause(),c.on("data",function(v){x.push({data:v,meta:{percent:0}})}).on("error",function(v){x.isPaused?this.generatedError=v:x.error(v)}).on("end",function(){x.isPaused?x._upstreamEnded=!0:x.end()})},a.prototype.pause=function(){return!!s.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},l.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(r,l,d){var o=r("readable-stream").Readable;function s(a,c,x){o.call(this,c),this._helper=a;var v=this;a.on("data",function(S,T){v.push(S)||v._helper.pause(),x&&x(T)}).on("error",function(S){v.emit("error",S)}).on("end",function(){v.push(null)})}r("../utils").inherits(s,o),s.prototype._read=function(){this._helper.resume()},l.exports=s},{"../utils":32,"readable-stream":16}],14:[function(r,l,d){l.exports={isNode:typeof Buffer<"u",newBufferFrom:function(o,s){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(o,s);if(typeof o=="number")throw new Error('The "data" argument must not be a number');return new Buffer(o,s)},allocBuffer:function(o){if(Buffer.alloc)return Buffer.alloc(o);var s=new Buffer(o);return s.fill(0),s},isBuffer:function(o){return Buffer.isBuffer(o)},isStream:function(o){return o&&typeof o.on=="function"&&typeof o.pause=="function"&&typeof o.resume=="function"}}},{}],15:[function(r,l,d){function o(F,G,W){var $,N=a.getTypeOf(G),ne=a.extend(W||{},v);ne.date=ne.date||new Date,ne.compression!==null&&(ne.compression=ne.compression.toUpperCase()),typeof ne.unixPermissions=="string"&&(ne.unixPermissions=parseInt(ne.unixPermissions,8)),ne.unixPermissions&&16384&ne.unixPermissions&&(ne.dir=!0),ne.dosPermissions&&16&ne.dosPermissions&&(ne.dir=!0),ne.dir&&(F=p(F)),ne.createFolders&&($=A(F))&&k.call(this,$,!0);var se=N==="string"&&ne.binary===!1&&ne.base64===!1;W&&W.binary!==void 0||(ne.binary=!se),(G instanceof S&&G.uncompressedSize===0||ne.dir||!G||G.length===0)&&(ne.base64=!1,ne.binary=!0,G="",ne.compression="STORE",N="string");var B=null;B=G instanceof S||G instanceof c?G:E.isNode&&E.isStream(G)?new y(F,G):a.prepareContent(F,G,ne.binary,ne.optimizedBinaryString,ne.base64);var X=new T(F,B,ne);this.files[F]=X}var s=r("./utf8"),a=r("./utils"),c=r("./stream/GenericWorker"),x=r("./stream/StreamHelper"),v=r("./defaults"),S=r("./compressedObject"),T=r("./zipObject"),w=r("./generate"),E=r("./nodejsUtils"),y=r("./nodejs/NodejsStreamInputAdapter"),A=function(F){F.slice(-1)==="/"&&(F=F.substring(0,F.length-1));var G=F.lastIndexOf("/");return 0<G?F.substring(0,G):""},p=function(F){return F.slice(-1)!=="/"&&(F+="/"),F},k=function(F,G){return G=G!==void 0?G:v.createFolders,F=p(F),this.files[F]||o.call(this,F,null,{dir:!0,createFolders:G}),this.files[F]};function j(F){return Object.prototype.toString.call(F)==="[object RegExp]"}var O={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(F){var G,W,$;for(G in this.files)$=this.files[G],(W=G.slice(this.root.length,G.length))&&G.slice(0,this.root.length)===this.root&&F(W,$)},filter:function(F){var G=[];return this.forEach(function(W,$){F(W,$)&&G.push($)}),G},file:function(F,G,W){if(arguments.length!==1)return F=this.root+F,o.call(this,F,G,W),this;if(j(F)){var $=F;return this.filter(function(ne,se){return!se.dir&&$.test(ne)})}var N=this.files[this.root+F];return N&&!N.dir?N:null},folder:function(F){if(!F)return this;if(j(F))return this.filter(function(N,ne){return ne.dir&&F.test(N)});var G=this.root+F,W=k.call(this,G),$=this.clone();return $.root=W.name,$},remove:function(F){F=this.root+F;var G=this.files[F];if(G||(F.slice(-1)!=="/"&&(F+="/"),G=this.files[F]),G&&!G.dir)delete this.files[F];else for(var W=this.filter(function(N,ne){return ne.name.slice(0,F.length)===F}),$=0;$<W.length;$++)delete this.files[W[$].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(F){var G,W={};try{if((W=a.extend(F||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:s.utf8encode})).type=W.type.toLowerCase(),W.compression=W.compression.toUpperCase(),W.type==="binarystring"&&(W.type="string"),!W.type)throw new Error("No output type specified.");a.checkSupport(W.type),W.platform!=="darwin"&&W.platform!=="freebsd"&&W.platform!=="linux"&&W.platform!=="sunos"||(W.platform="UNIX"),W.platform==="win32"&&(W.platform="DOS");var $=W.comment||this.comment||"";G=w.generateWorker(this,W,$)}catch(N){(G=new c("error")).error(N)}return new x(G,W.type||"string",W.mimeType)},generateAsync:function(F,G){return this.generateInternalStream(F).accumulate(G)},generateNodeStream:function(F,G){return(F=F||{}).type||(F.type="nodebuffer"),this.generateInternalStream(F).toNodejsStream(G)}};l.exports=O},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(r,l,d){l.exports=r("stream")},{stream:void 0}],17:[function(r,l,d){var o=r("./DataReader");function s(a){o.call(this,a);for(var c=0;c<this.data.length;c++)a[c]=255&a[c]}r("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data[this.zero+a]},s.prototype.lastIndexOfSignature=function(a){for(var c=a.charCodeAt(0),x=a.charCodeAt(1),v=a.charCodeAt(2),S=a.charCodeAt(3),T=this.length-4;0<=T;--T)if(this.data[T]===c&&this.data[T+1]===x&&this.data[T+2]===v&&this.data[T+3]===S)return T-this.zero;return-1},s.prototype.readAndCheckSignature=function(a){var c=a.charCodeAt(0),x=a.charCodeAt(1),v=a.charCodeAt(2),S=a.charCodeAt(3),T=this.readData(4);return c===T[0]&&x===T[1]&&v===T[2]&&S===T[3]},s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},l.exports=s},{"../utils":32,"./DataReader":18}],18:[function(r,l,d){var o=r("../utils");function s(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}s.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var c,x=0;for(this.checkOffset(a),c=this.index+a-1;c>=this.index;c--)x=(x<<8)+this.byteAt(c);return this.index+=a,x},readString:function(a){return o.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},l.exports=s},{"../utils":32}],19:[function(r,l,d){var o=r("./Uint8ArrayReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},l.exports=s},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(r,l,d){var o=r("./DataReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},s.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},s.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},s.prototype.readData=function(a){this.checkOffset(a);var c=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},l.exports=s},{"../utils":32,"./DataReader":18}],21:[function(r,l,d){var o=r("./ArrayReader");function s(a){o.call(this,a)}r("../utils").inherits(s,o),s.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var c=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,c},l.exports=s},{"../utils":32,"./ArrayReader":17}],22:[function(r,l,d){var o=r("../utils"),s=r("../support"),a=r("./ArrayReader"),c=r("./StringReader"),x=r("./NodeBufferReader"),v=r("./Uint8ArrayReader");l.exports=function(S){var T=o.getTypeOf(S);return o.checkSupport(T),T!=="string"||s.uint8array?T==="nodebuffer"?new x(S):s.uint8array?new v(o.transformTo("uint8array",S)):new a(o.transformTo("array",S)):new c(S)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(r,l,d){d.LOCAL_FILE_HEADER="PK",d.CENTRAL_FILE_HEADER="PK",d.CENTRAL_DIRECTORY_END="PK",d.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",d.ZIP64_CENTRAL_DIRECTORY_END="PK",d.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(r,l,d){var o=r("./GenericWorker"),s=r("../utils");function a(c){o.call(this,"ConvertWorker to "+c),this.destType=c}s.inherits(a,o),a.prototype.processChunk=function(c){this.push({data:s.transformTo(this.destType,c.data),meta:c.meta})},l.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(r,l,d){var o=r("./GenericWorker"),s=r("../crc32");function a(){o.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}r("../utils").inherits(a,o),a.prototype.processChunk=function(c){this.streamInfo.crc32=s(c.data,this.streamInfo.crc32||0),this.push(c)},l.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(r,l,d){var o=r("../utils"),s=r("./GenericWorker");function a(c){s.call(this,"DataLengthProbe for "+c),this.propName=c,this.withStreamInfo(c,0)}o.inherits(a,s),a.prototype.processChunk=function(c){if(c){var x=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=x+c.data.length}s.prototype.processChunk.call(this,c)},l.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(r,l,d){var o=r("../utils"),s=r("./GenericWorker");function a(c){s.call(this,"DataWorker");var x=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,c.then(function(v){x.dataIsReady=!0,x.data=v,x.max=v&&v.length||0,x.type=o.getTypeOf(v),x.isPaused||x._tickAndRepeat()},function(v){x.error(v)})}o.inherits(a,s),a.prototype.cleanUp=function(){s.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!s.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,o.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(o.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var c=null,x=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":c=this.data.substring(this.index,x);break;case"uint8array":c=this.data.subarray(this.index,x);break;case"array":case"nodebuffer":c=this.data.slice(this.index,x)}return this.index=x,this.push({data:c,meta:{percent:this.max?this.index/this.max*100:0}})},l.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(r,l,d){function o(s){this.name=s||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}o.prototype={push:function(s){this.emit("data",s)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(s){this.emit("error",s)}return!0},error:function(s){return!this.isFinished&&(this.isPaused?this.generatedError=s:(this.isFinished=!0,this.emit("error",s),this.previous&&this.previous.error(s),this.cleanUp()),!0)},on:function(s,a){return this._listeners[s].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(s,a){if(this._listeners[s])for(var c=0;c<this._listeners[s].length;c++)this._listeners[s][c].call(this,a)},pipe:function(s){return s.registerPrevious(this)},registerPrevious:function(s){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=s.streamInfo,this.mergeStreamInfo(),this.previous=s;var a=this;return s.on("data",function(c){a.processChunk(c)}),s.on("end",function(){a.end()}),s.on("error",function(c){a.error(c)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var s=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),s=!0),this.previous&&this.previous.resume(),!s},flush:function(){},processChunk:function(s){this.push(s)},withStreamInfo:function(s,a){return this.extraStreamInfo[s]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var s in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,s)&&(this.streamInfo[s]=this.extraStreamInfo[s])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var s="Worker "+this.name;return this.previous?this.previous+" -> "+s:s}},l.exports=o},{}],29:[function(r,l,d){var o=r("../utils"),s=r("./ConvertWorker"),a=r("./GenericWorker"),c=r("../base64"),x=r("../support"),v=r("../external"),S=null;if(x.nodestream)try{S=r("../nodejs/NodejsStreamOutputAdapter")}catch{}function T(E,y){return new v.Promise(function(A,p){var k=[],j=E._internalType,O=E._outputType,F=E._mimeType;E.on("data",function(G,W){k.push(G),y&&y(W)}).on("error",function(G){k=[],p(G)}).on("end",function(){try{var G=function(W,$,N){switch(W){case"blob":return o.newBlob(o.transformTo("arraybuffer",$),N);case"base64":return c.encode($);default:return o.transformTo(W,$)}}(O,function(W,$){var N,ne=0,se=null,B=0;for(N=0;N<$.length;N++)B+=$[N].length;switch(W){case"string":return $.join("");case"array":return Array.prototype.concat.apply([],$);case"uint8array":for(se=new Uint8Array(B),N=0;N<$.length;N++)se.set($[N],ne),ne+=$[N].length;return se;case"nodebuffer":return Buffer.concat($);default:throw new Error("concat : unsupported type '"+W+"'")}}(j,k),F);A(G)}catch(W){p(W)}k=[]}).resume()})}function w(E,y,A){var p=y;switch(y){case"blob":case"arraybuffer":p="uint8array";break;case"base64":p="string"}try{this._internalType=p,this._outputType=y,this._mimeType=A,o.checkSupport(p),this._worker=E.pipe(new s(p)),E.lock()}catch(k){this._worker=new a("error"),this._worker.error(k)}}w.prototype={accumulate:function(E){return T(this,E)},on:function(E,y){var A=this;return E==="data"?this._worker.on(E,function(p){y.call(A,p.data,p.meta)}):this._worker.on(E,function(){o.delay(y,arguments,A)}),this},resume:function(){return o.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(E){if(o.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new S(this,{objectMode:this._outputType!=="nodebuffer"},E)}},l.exports=w},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(r,l,d){if(d.base64=!0,d.array=!0,d.string=!0,d.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",d.nodebuffer=typeof Buffer<"u",d.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")d.blob=!1;else{var o=new ArrayBuffer(0);try{d.blob=new Blob([o],{type:"application/zip"}).size===0}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);s.append(o),d.blob=s.getBlob("application/zip").size===0}catch{d.blob=!1}}}try{d.nodestream=!!r("readable-stream").Readable}catch{d.nodestream=!1}},{"readable-stream":16}],31:[function(r,l,d){for(var o=r("./utils"),s=r("./support"),a=r("./nodejsUtils"),c=r("./stream/GenericWorker"),x=new Array(256),v=0;v<256;v++)x[v]=252<=v?6:248<=v?5:240<=v?4:224<=v?3:192<=v?2:1;x[254]=x[254]=1;function S(){c.call(this,"utf-8 decode"),this.leftOver=null}function T(){c.call(this,"utf-8 encode")}d.utf8encode=function(w){return s.nodebuffer?a.newBufferFrom(w,"utf-8"):function(E){var y,A,p,k,j,O=E.length,F=0;for(k=0;k<O;k++)(64512&(A=E.charCodeAt(k)))==55296&&k+1<O&&(64512&(p=E.charCodeAt(k+1)))==56320&&(A=65536+(A-55296<<10)+(p-56320),k++),F+=A<128?1:A<2048?2:A<65536?3:4;for(y=s.uint8array?new Uint8Array(F):new Array(F),k=j=0;j<F;k++)(64512&(A=E.charCodeAt(k)))==55296&&k+1<O&&(64512&(p=E.charCodeAt(k+1)))==56320&&(A=65536+(A-55296<<10)+(p-56320),k++),A<128?y[j++]=A:(A<2048?y[j++]=192|A>>>6:(A<65536?y[j++]=224|A>>>12:(y[j++]=240|A>>>18,y[j++]=128|A>>>12&63),y[j++]=128|A>>>6&63),y[j++]=128|63&A);return y}(w)},d.utf8decode=function(w){return s.nodebuffer?o.transformTo("nodebuffer",w).toString("utf-8"):function(E){var y,A,p,k,j=E.length,O=new Array(2*j);for(y=A=0;y<j;)if((p=E[y++])<128)O[A++]=p;else if(4<(k=x[p]))O[A++]=65533,y+=k-1;else{for(p&=k===2?31:k===3?15:7;1<k&&y<j;)p=p<<6|63&E[y++],k--;1<k?O[A++]=65533:p<65536?O[A++]=p:(p-=65536,O[A++]=55296|p>>10&1023,O[A++]=56320|1023&p)}return O.length!==A&&(O.subarray?O=O.subarray(0,A):O.length=A),o.applyFromCharCode(O)}(w=o.transformTo(s.uint8array?"uint8array":"array",w))},o.inherits(S,c),S.prototype.processChunk=function(w){var E=o.transformTo(s.uint8array?"uint8array":"array",w.data);if(this.leftOver&&this.leftOver.length){if(s.uint8array){var y=E;(E=new Uint8Array(y.length+this.leftOver.length)).set(this.leftOver,0),E.set(y,this.leftOver.length)}else E=this.leftOver.concat(E);this.leftOver=null}var A=function(k,j){var O;for((j=j||k.length)>k.length&&(j=k.length),O=j-1;0<=O&&(192&k[O])==128;)O--;return O<0||O===0?j:O+x[k[O]]>j?O:j}(E),p=E;A!==E.length&&(s.uint8array?(p=E.subarray(0,A),this.leftOver=E.subarray(A,E.length)):(p=E.slice(0,A),this.leftOver=E.slice(A,E.length))),this.push({data:d.utf8decode(p),meta:w.meta})},S.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:d.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},d.Utf8DecodeWorker=S,o.inherits(T,c),T.prototype.processChunk=function(w){this.push({data:d.utf8encode(w.data),meta:w.meta})},d.Utf8EncodeWorker=T},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(r,l,d){var o=r("./support"),s=r("./base64"),a=r("./nodejsUtils"),c=r("./external");function x(y){return y}function v(y,A){for(var p=0;p<y.length;++p)A[p]=255&y.charCodeAt(p);return A}r("setimmediate"),d.newBlob=function(y,A){d.checkSupport("blob");try{return new Blob([y],{type:A})}catch{try{var p=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return p.append(y),p.getBlob(A)}catch{throw new Error("Bug : can't construct the Blob.")}}};var S={stringifyByChunk:function(y,A,p){var k=[],j=0,O=y.length;if(O<=p)return String.fromCharCode.apply(null,y);for(;j<O;)A==="array"||A==="nodebuffer"?k.push(String.fromCharCode.apply(null,y.slice(j,Math.min(j+p,O)))):k.push(String.fromCharCode.apply(null,y.subarray(j,Math.min(j+p,O)))),j+=p;return k.join("")},stringifyByChar:function(y){for(var A="",p=0;p<y.length;p++)A+=String.fromCharCode(y[p]);return A},applyCanBeUsed:{uint8array:function(){try{return o.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return o.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function T(y){var A=65536,p=d.getTypeOf(y),k=!0;if(p==="uint8array"?k=S.applyCanBeUsed.uint8array:p==="nodebuffer"&&(k=S.applyCanBeUsed.nodebuffer),k)for(;1<A;)try{return S.stringifyByChunk(y,p,A)}catch{A=Math.floor(A/2)}return S.stringifyByChar(y)}function w(y,A){for(var p=0;p<y.length;p++)A[p]=y[p];return A}d.applyFromCharCode=T;var E={};E.string={string:x,array:function(y){return v(y,new Array(y.length))},arraybuffer:function(y){return E.string.uint8array(y).buffer},uint8array:function(y){return v(y,new Uint8Array(y.length))},nodebuffer:function(y){return v(y,a.allocBuffer(y.length))}},E.array={string:T,array:x,arraybuffer:function(y){return new Uint8Array(y).buffer},uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return a.newBufferFrom(y)}},E.arraybuffer={string:function(y){return T(new Uint8Array(y))},array:function(y){return w(new Uint8Array(y),new Array(y.byteLength))},arraybuffer:x,uint8array:function(y){return new Uint8Array(y)},nodebuffer:function(y){return a.newBufferFrom(new Uint8Array(y))}},E.uint8array={string:T,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return y.buffer},uint8array:x,nodebuffer:function(y){return a.newBufferFrom(y)}},E.nodebuffer={string:T,array:function(y){return w(y,new Array(y.length))},arraybuffer:function(y){return E.nodebuffer.uint8array(y).buffer},uint8array:function(y){return w(y,new Uint8Array(y.length))},nodebuffer:x},d.transformTo=function(y,A){if(A=A||"",!y)return A;d.checkSupport(y);var p=d.getTypeOf(A);return E[p][y](A)},d.resolve=function(y){for(var A=y.split("/"),p=[],k=0;k<A.length;k++){var j=A[k];j==="."||j===""&&k!==0&&k!==A.length-1||(j===".."?p.pop():p.push(j))}return p.join("/")},d.getTypeOf=function(y){return typeof y=="string"?"string":Object.prototype.toString.call(y)==="[object Array]"?"array":o.nodebuffer&&a.isBuffer(y)?"nodebuffer":o.uint8array&&y instanceof Uint8Array?"uint8array":o.arraybuffer&&y instanceof ArrayBuffer?"arraybuffer":void 0},d.checkSupport=function(y){if(!o[y.toLowerCase()])throw new Error(y+" is not supported by this platform")},d.MAX_VALUE_16BITS=65535,d.MAX_VALUE_32BITS=-1,d.pretty=function(y){var A,p,k="";for(p=0;p<(y||"").length;p++)k+="\\x"+((A=y.charCodeAt(p))<16?"0":"")+A.toString(16).toUpperCase();return k},d.delay=function(y,A,p){setImmediate(function(){y.apply(p||null,A||[])})},d.inherits=function(y,A){function p(){}p.prototype=A.prototype,y.prototype=new p},d.extend=function(){var y,A,p={};for(y=0;y<arguments.length;y++)for(A in arguments[y])Object.prototype.hasOwnProperty.call(arguments[y],A)&&p[A]===void 0&&(p[A]=arguments[y][A]);return p},d.prepareContent=function(y,A,p,k,j){return c.Promise.resolve(A).then(function(O){return o.blob&&(O instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(O))!==-1)&&typeof FileReader<"u"?new c.Promise(function(F,G){var W=new FileReader;W.onload=function($){F($.target.result)},W.onerror=function($){G($.target.error)},W.readAsArrayBuffer(O)}):O}).then(function(O){var F=d.getTypeOf(O);return F?(F==="arraybuffer"?O=d.transformTo("uint8array",O):F==="string"&&(j?O=s.decode(O):p&&k!==!0&&(O=function(G){return v(G,o.uint8array?new Uint8Array(G.length):new Array(G.length))}(O))),O):c.Promise.reject(new Error("Can't read the data of '"+y+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(r,l,d){var o=r("./reader/readerFor"),s=r("./utils"),a=r("./signature"),c=r("./zipEntry"),x=r("./support");function v(S){this.files=[],this.loadOptions=S}v.prototype={checkSignature:function(S){if(!this.reader.readAndCheckSignature(S)){this.reader.index-=4;var T=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+s.pretty(T)+", expected "+s.pretty(S)+")")}},isSignature:function(S,T){var w=this.reader.index;this.reader.setIndex(S);var E=this.reader.readString(4)===T;return this.reader.setIndex(w),E},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var S=this.reader.readData(this.zipCommentLength),T=x.uint8array?"uint8array":"array",w=s.transformTo(T,S);this.zipComment=this.loadOptions.decodeFileName(w)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var S,T,w,E=this.zip64EndOfCentralSize-44;0<E;)S=this.reader.readInt(2),T=this.reader.readInt(4),w=this.reader.readData(T),this.zip64ExtensibleData[S]={id:S,length:T,value:w}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var S,T;for(S=0;S<this.files.length;S++)T=this.files[S],this.reader.setIndex(T.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),T.readLocalPart(this.reader),T.handleUTF8(),T.processAttributes()},readCentralDir:function(){var S;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(S=new c({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(S);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var S=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(S<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(S);var T=S;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===s.MAX_VALUE_16BITS||this.diskWithCentralDirStart===s.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===s.MAX_VALUE_16BITS||this.centralDirRecords===s.MAX_VALUE_16BITS||this.centralDirSize===s.MAX_VALUE_32BITS||this.centralDirOffset===s.MAX_VALUE_32BITS){if(this.zip64=!0,(S=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(S),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var w=this.centralDirOffset+this.centralDirSize;this.zip64&&(w+=20,w+=12+this.zip64EndOfCentralSize);var E=T-w;if(0<E)this.isSignature(T,a.CENTRAL_FILE_HEADER)||(this.reader.zero=E);else if(E<0)throw new Error("Corrupted zip: missing "+Math.abs(E)+" bytes.")},prepareReader:function(S){this.reader=o(S)},load:function(S){this.prepareReader(S),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},l.exports=v},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(r,l,d){var o=r("./reader/readerFor"),s=r("./utils"),a=r("./compressedObject"),c=r("./crc32"),x=r("./utf8"),v=r("./compressions"),S=r("./support");function T(w,E){this.options=w,this.loadOptions=E}T.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(w){var E,y;if(w.skip(22),this.fileNameLength=w.readInt(2),y=w.readInt(2),this.fileName=w.readData(this.fileNameLength),w.skip(y),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((E=function(A){for(var p in v)if(Object.prototype.hasOwnProperty.call(v,p)&&v[p].magic===A)return v[p];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+s.pretty(this.compressionMethod)+" unknown (inner file : "+s.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,E,w.readData(this.compressedSize))},readCentralPart:function(w){this.versionMadeBy=w.readInt(2),w.skip(2),this.bitFlag=w.readInt(2),this.compressionMethod=w.readString(2),this.date=w.readDate(),this.crc32=w.readInt(4),this.compressedSize=w.readInt(4),this.uncompressedSize=w.readInt(4);var E=w.readInt(2);if(this.extraFieldsLength=w.readInt(2),this.fileCommentLength=w.readInt(2),this.diskNumberStart=w.readInt(2),this.internalFileAttributes=w.readInt(2),this.externalFileAttributes=w.readInt(4),this.localHeaderOffset=w.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");w.skip(E),this.readExtraFields(w),this.parseZIP64ExtraField(w),this.fileComment=w.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var w=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),w==0&&(this.dosPermissions=63&this.externalFileAttributes),w==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var w=o(this.extraFields[1].value);this.uncompressedSize===s.MAX_VALUE_32BITS&&(this.uncompressedSize=w.readInt(8)),this.compressedSize===s.MAX_VALUE_32BITS&&(this.compressedSize=w.readInt(8)),this.localHeaderOffset===s.MAX_VALUE_32BITS&&(this.localHeaderOffset=w.readInt(8)),this.diskNumberStart===s.MAX_VALUE_32BITS&&(this.diskNumberStart=w.readInt(4))}},readExtraFields:function(w){var E,y,A,p=w.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});w.index+4<p;)E=w.readInt(2),y=w.readInt(2),A=w.readData(y),this.extraFields[E]={id:E,length:y,value:A};w.setIndex(p)},handleUTF8:function(){var w=S.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=x.utf8decode(this.fileName),this.fileCommentStr=x.utf8decode(this.fileComment);else{var E=this.findExtraFieldUnicodePath();if(E!==null)this.fileNameStr=E;else{var y=s.transformTo(w,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(y)}var A=this.findExtraFieldUnicodeComment();if(A!==null)this.fileCommentStr=A;else{var p=s.transformTo(w,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(p)}}},findExtraFieldUnicodePath:function(){var w=this.extraFields[28789];if(w){var E=o(w.value);return E.readInt(1)!==1||c(this.fileName)!==E.readInt(4)?null:x.utf8decode(E.readData(w.length-5))}return null},findExtraFieldUnicodeComment:function(){var w=this.extraFields[25461];if(w){var E=o(w.value);return E.readInt(1)!==1||c(this.fileComment)!==E.readInt(4)?null:x.utf8decode(E.readData(w.length-5))}return null}},l.exports=T},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(r,l,d){function o(E,y,A){this.name=E,this.dir=A.dir,this.date=A.date,this.comment=A.comment,this.unixPermissions=A.unixPermissions,this.dosPermissions=A.dosPermissions,this._data=y,this._dataBinary=A.binary,this.options={compression:A.compression,compressionOptions:A.compressionOptions}}var s=r("./stream/StreamHelper"),a=r("./stream/DataWorker"),c=r("./utf8"),x=r("./compressedObject"),v=r("./stream/GenericWorker");o.prototype={internalStream:function(E){var y=null,A="string";try{if(!E)throw new Error("No output type specified.");var p=(A=E.toLowerCase())==="string"||A==="text";A!=="binarystring"&&A!=="text"||(A="string"),y=this._decompressWorker();var k=!this._dataBinary;k&&!p&&(y=y.pipe(new c.Utf8EncodeWorker)),!k&&p&&(y=y.pipe(new c.Utf8DecodeWorker))}catch(j){(y=new v("error")).error(j)}return new s(y,A,"")},async:function(E,y){return this.internalStream(E).accumulate(y)},nodeStream:function(E,y){return this.internalStream(E||"nodebuffer").toNodejsStream(y)},_compressWorker:function(E,y){if(this._data instanceof x&&this._data.compression.magic===E.magic)return this._data.getCompressedWorker();var A=this._decompressWorker();return this._dataBinary||(A=A.pipe(new c.Utf8EncodeWorker)),x.createWorkerFrom(A,E,y)},_decompressWorker:function(){return this._data instanceof x?this._data.getContentWorker():this._data instanceof v?this._data:new a(this._data)}};for(var S=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],T=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},w=0;w<S.length;w++)o.prototype[S[w]]=T;l.exports=o},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(r,l,d){(function(o){var s,a,c=o.MutationObserver||o.WebKitMutationObserver;if(c){var x=0,v=new c(E),S=o.document.createTextNode("");v.observe(S,{characterData:!0}),s=function(){S.data=x=++x%2}}else if(o.setImmediate||o.MessageChannel===void 0)s="document"in o&&"onreadystatechange"in o.document.createElement("script")?function(){var y=o.document.createElement("script");y.onreadystatechange=function(){E(),y.onreadystatechange=null,y.parentNode.removeChild(y),y=null},o.document.documentElement.appendChild(y)}:function(){setTimeout(E,0)};else{var T=new o.MessageChannel;T.port1.onmessage=E,s=function(){T.port2.postMessage(0)}}var w=[];function E(){var y,A;a=!0;for(var p=w.length;p;){for(A=w,w=[],y=-1;++y<p;)A[y]();p=w.length}a=!1}l.exports=function(y){w.push(y)!==1||a||s()}}).call(this,typeof Qe<"u"?Qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(r,l,d){var o=r("immediate");function s(){}var a={},c=["REJECTED"],x=["FULFILLED"],v=["PENDING"];function S(p){if(typeof p!="function")throw new TypeError("resolver must be a function");this.state=v,this.queue=[],this.outcome=void 0,p!==s&&y(this,p)}function T(p,k,j){this.promise=p,typeof k=="function"&&(this.onFulfilled=k,this.callFulfilled=this.otherCallFulfilled),typeof j=="function"&&(this.onRejected=j,this.callRejected=this.otherCallRejected)}function w(p,k,j){o(function(){var O;try{O=k(j)}catch(F){return a.reject(p,F)}O===p?a.reject(p,new TypeError("Cannot resolve promise with itself")):a.resolve(p,O)})}function E(p){var k=p&&p.then;if(p&&(typeof p=="object"||typeof p=="function")&&typeof k=="function")return function(){k.apply(p,arguments)}}function y(p,k){var j=!1;function O(W){j||(j=!0,a.reject(p,W))}function F(W){j||(j=!0,a.resolve(p,W))}var G=A(function(){k(F,O)});G.status==="error"&&O(G.value)}function A(p,k){var j={};try{j.value=p(k),j.status="success"}catch(O){j.status="error",j.value=O}return j}(l.exports=S).prototype.finally=function(p){if(typeof p!="function")return this;var k=this.constructor;return this.then(function(j){return k.resolve(p()).then(function(){return j})},function(j){return k.resolve(p()).then(function(){throw j})})},S.prototype.catch=function(p){return this.then(null,p)},S.prototype.then=function(p,k){if(typeof p!="function"&&this.state===x||typeof k!="function"&&this.state===c)return this;var j=new this.constructor(s);return this.state!==v?w(j,this.state===x?p:k,this.outcome):this.queue.push(new T(j,p,k)),j},T.prototype.callFulfilled=function(p){a.resolve(this.promise,p)},T.prototype.otherCallFulfilled=function(p){w(this.promise,this.onFulfilled,p)},T.prototype.callRejected=function(p){a.reject(this.promise,p)},T.prototype.otherCallRejected=function(p){w(this.promise,this.onRejected,p)},a.resolve=function(p,k){var j=A(E,k);if(j.status==="error")return a.reject(p,j.value);var O=j.value;if(O)y(p,O);else{p.state=x,p.outcome=k;for(var F=-1,G=p.queue.length;++F<G;)p.queue[F].callFulfilled(k)}return p},a.reject=function(p,k){p.state=c,p.outcome=k;for(var j=-1,O=p.queue.length;++j<O;)p.queue[j].callRejected(k);return p},S.resolve=function(p){return p instanceof this?p:a.resolve(new this(s),p)},S.reject=function(p){var k=new this(s);return a.reject(k,p)},S.all=function(p){var k=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=p.length,O=!1;if(!j)return this.resolve([]);for(var F=new Array(j),G=0,W=-1,$=new this(s);++W<j;)N(p[W],W);return $;function N(ne,se){k.resolve(ne).then(function(B){F[se]=B,++G!==j||O||(O=!0,a.resolve($,F))},function(B){O||(O=!0,a.reject($,B))})}},S.race=function(p){var k=this;if(Object.prototype.toString.call(p)!=="[object Array]")return this.reject(new TypeError("must be an array"));var j=p.length,O=!1;if(!j)return this.resolve([]);for(var F=-1,G=new this(s);++F<j;)W=p[F],k.resolve(W).then(function($){O||(O=!0,a.resolve(G,$))},function($){O||(O=!0,a.reject(G,$))});var W;return G}},{immediate:36}],38:[function(r,l,d){var o={};(0,r("./lib/utils/common").assign)(o,r("./lib/deflate"),r("./lib/inflate"),r("./lib/zlib/constants")),l.exports=o},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(r,l,d){var o=r("./zlib/deflate"),s=r("./utils/common"),a=r("./utils/strings"),c=r("./zlib/messages"),x=r("./zlib/zstream"),v=Object.prototype.toString,S=0,T=-1,w=0,E=8;function y(p){if(!(this instanceof y))return new y(p);this.options=s.assign({level:T,method:E,chunkSize:16384,windowBits:15,memLevel:8,strategy:w,to:""},p||{});var k=this.options;k.raw&&0<k.windowBits?k.windowBits=-k.windowBits:k.gzip&&0<k.windowBits&&k.windowBits<16&&(k.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new x,this.strm.avail_out=0;var j=o.deflateInit2(this.strm,k.level,k.method,k.windowBits,k.memLevel,k.strategy);if(j!==S)throw new Error(c[j]);if(k.header&&o.deflateSetHeader(this.strm,k.header),k.dictionary){var O;if(O=typeof k.dictionary=="string"?a.string2buf(k.dictionary):v.call(k.dictionary)==="[object ArrayBuffer]"?new Uint8Array(k.dictionary):k.dictionary,(j=o.deflateSetDictionary(this.strm,O))!==S)throw new Error(c[j]);this._dict_set=!0}}function A(p,k){var j=new y(k);if(j.push(p,!0),j.err)throw j.msg||c[j.err];return j.result}y.prototype.push=function(p,k){var j,O,F=this.strm,G=this.options.chunkSize;if(this.ended)return!1;O=k===~~k?k:k===!0?4:0,typeof p=="string"?F.input=a.string2buf(p):v.call(p)==="[object ArrayBuffer]"?F.input=new Uint8Array(p):F.input=p,F.next_in=0,F.avail_in=F.input.length;do{if(F.avail_out===0&&(F.output=new s.Buf8(G),F.next_out=0,F.avail_out=G),(j=o.deflate(F,O))!==1&&j!==S)return this.onEnd(j),!(this.ended=!0);F.avail_out!==0&&(F.avail_in!==0||O!==4&&O!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(s.shrinkBuf(F.output,F.next_out))):this.onData(s.shrinkBuf(F.output,F.next_out)))}while((0<F.avail_in||F.avail_out===0)&&j!==1);return O===4?(j=o.deflateEnd(this.strm),this.onEnd(j),this.ended=!0,j===S):O!==2||(this.onEnd(S),!(F.avail_out=0))},y.prototype.onData=function(p){this.chunks.push(p)},y.prototype.onEnd=function(p){p===S&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=p,this.msg=this.strm.msg},d.Deflate=y,d.deflate=A,d.deflateRaw=function(p,k){return(k=k||{}).raw=!0,A(p,k)},d.gzip=function(p,k){return(k=k||{}).gzip=!0,A(p,k)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(r,l,d){var o=r("./zlib/inflate"),s=r("./utils/common"),a=r("./utils/strings"),c=r("./zlib/constants"),x=r("./zlib/messages"),v=r("./zlib/zstream"),S=r("./zlib/gzheader"),T=Object.prototype.toString;function w(y){if(!(this instanceof w))return new w(y);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},y||{});var A=this.options;A.raw&&0<=A.windowBits&&A.windowBits<16&&(A.windowBits=-A.windowBits,A.windowBits===0&&(A.windowBits=-15)),!(0<=A.windowBits&&A.windowBits<16)||y&&y.windowBits||(A.windowBits+=32),15<A.windowBits&&A.windowBits<48&&!(15&A.windowBits)&&(A.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new v,this.strm.avail_out=0;var p=o.inflateInit2(this.strm,A.windowBits);if(p!==c.Z_OK)throw new Error(x[p]);this.header=new S,o.inflateGetHeader(this.strm,this.header)}function E(y,A){var p=new w(A);if(p.push(y,!0),p.err)throw p.msg||x[p.err];return p.result}w.prototype.push=function(y,A){var p,k,j,O,F,G,W=this.strm,$=this.options.chunkSize,N=this.options.dictionary,ne=!1;if(this.ended)return!1;k=A===~~A?A:A===!0?c.Z_FINISH:c.Z_NO_FLUSH,typeof y=="string"?W.input=a.binstring2buf(y):T.call(y)==="[object ArrayBuffer]"?W.input=new Uint8Array(y):W.input=y,W.next_in=0,W.avail_in=W.input.length;do{if(W.avail_out===0&&(W.output=new s.Buf8($),W.next_out=0,W.avail_out=$),(p=o.inflate(W,c.Z_NO_FLUSH))===c.Z_NEED_DICT&&N&&(G=typeof N=="string"?a.string2buf(N):T.call(N)==="[object ArrayBuffer]"?new Uint8Array(N):N,p=o.inflateSetDictionary(this.strm,G)),p===c.Z_BUF_ERROR&&ne===!0&&(p=c.Z_OK,ne=!1),p!==c.Z_STREAM_END&&p!==c.Z_OK)return this.onEnd(p),!(this.ended=!0);W.next_out&&(W.avail_out!==0&&p!==c.Z_STREAM_END&&(W.avail_in!==0||k!==c.Z_FINISH&&k!==c.Z_SYNC_FLUSH)||(this.options.to==="string"?(j=a.utf8border(W.output,W.next_out),O=W.next_out-j,F=a.buf2string(W.output,j),W.next_out=O,W.avail_out=$-O,O&&s.arraySet(W.output,W.output,j,O,0),this.onData(F)):this.onData(s.shrinkBuf(W.output,W.next_out)))),W.avail_in===0&&W.avail_out===0&&(ne=!0)}while((0<W.avail_in||W.avail_out===0)&&p!==c.Z_STREAM_END);return p===c.Z_STREAM_END&&(k=c.Z_FINISH),k===c.Z_FINISH?(p=o.inflateEnd(this.strm),this.onEnd(p),this.ended=!0,p===c.Z_OK):k!==c.Z_SYNC_FLUSH||(this.onEnd(c.Z_OK),!(W.avail_out=0))},w.prototype.onData=function(y){this.chunks.push(y)},w.prototype.onEnd=function(y){y===c.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=y,this.msg=this.strm.msg},d.Inflate=w,d.inflate=E,d.inflateRaw=function(y,A){return(A=A||{}).raw=!0,E(y,A)},d.ungzip=E},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(r,l,d){var o=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";d.assign=function(c){for(var x=Array.prototype.slice.call(arguments,1);x.length;){var v=x.shift();if(v){if(typeof v!="object")throw new TypeError(v+"must be non-object");for(var S in v)v.hasOwnProperty(S)&&(c[S]=v[S])}}return c},d.shrinkBuf=function(c,x){return c.length===x?c:c.subarray?c.subarray(0,x):(c.length=x,c)};var s={arraySet:function(c,x,v,S,T){if(x.subarray&&c.subarray)c.set(x.subarray(v,v+S),T);else for(var w=0;w<S;w++)c[T+w]=x[v+w]},flattenChunks:function(c){var x,v,S,T,w,E;for(x=S=0,v=c.length;x<v;x++)S+=c[x].length;for(E=new Uint8Array(S),x=T=0,v=c.length;x<v;x++)w=c[x],E.set(w,T),T+=w.length;return E}},a={arraySet:function(c,x,v,S,T){for(var w=0;w<S;w++)c[T+w]=x[v+w]},flattenChunks:function(c){return[].concat.apply([],c)}};d.setTyped=function(c){c?(d.Buf8=Uint8Array,d.Buf16=Uint16Array,d.Buf32=Int32Array,d.assign(d,s)):(d.Buf8=Array,d.Buf16=Array,d.Buf32=Array,d.assign(d,a))},d.setTyped(o)},{}],42:[function(r,l,d){var o=r("./common"),s=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var c=new o.Buf8(256),x=0;x<256;x++)c[x]=252<=x?6:248<=x?5:240<=x?4:224<=x?3:192<=x?2:1;function v(S,T){if(T<65537&&(S.subarray&&a||!S.subarray&&s))return String.fromCharCode.apply(null,o.shrinkBuf(S,T));for(var w="",E=0;E<T;E++)w+=String.fromCharCode(S[E]);return w}c[254]=c[254]=1,d.string2buf=function(S){var T,w,E,y,A,p=S.length,k=0;for(y=0;y<p;y++)(64512&(w=S.charCodeAt(y)))==55296&&y+1<p&&(64512&(E=S.charCodeAt(y+1)))==56320&&(w=65536+(w-55296<<10)+(E-56320),y++),k+=w<128?1:w<2048?2:w<65536?3:4;for(T=new o.Buf8(k),y=A=0;A<k;y++)(64512&(w=S.charCodeAt(y)))==55296&&y+1<p&&(64512&(E=S.charCodeAt(y+1)))==56320&&(w=65536+(w-55296<<10)+(E-56320),y++),w<128?T[A++]=w:(w<2048?T[A++]=192|w>>>6:(w<65536?T[A++]=224|w>>>12:(T[A++]=240|w>>>18,T[A++]=128|w>>>12&63),T[A++]=128|w>>>6&63),T[A++]=128|63&w);return T},d.buf2binstring=function(S){return v(S,S.length)},d.binstring2buf=function(S){for(var T=new o.Buf8(S.length),w=0,E=T.length;w<E;w++)T[w]=S.charCodeAt(w);return T},d.buf2string=function(S,T){var w,E,y,A,p=T||S.length,k=new Array(2*p);for(w=E=0;w<p;)if((y=S[w++])<128)k[E++]=y;else if(4<(A=c[y]))k[E++]=65533,w+=A-1;else{for(y&=A===2?31:A===3?15:7;1<A&&w<p;)y=y<<6|63&S[w++],A--;1<A?k[E++]=65533:y<65536?k[E++]=y:(y-=65536,k[E++]=55296|y>>10&1023,k[E++]=56320|1023&y)}return v(k,E)},d.utf8border=function(S,T){var w;for((T=T||S.length)>S.length&&(T=S.length),w=T-1;0<=w&&(192&S[w])==128;)w--;return w<0||w===0?T:w+c[S[w]]>T?w:T}},{"./common":41}],43:[function(r,l,d){l.exports=function(o,s,a,c){for(var x=65535&o|0,v=o>>>16&65535|0,S=0;a!==0;){for(a-=S=2e3<a?2e3:a;v=v+(x=x+s[c++]|0)|0,--S;);x%=65521,v%=65521}return x|v<<16|0}},{}],44:[function(r,l,d){l.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(r,l,d){var o=function(){for(var s,a=[],c=0;c<256;c++){s=c;for(var x=0;x<8;x++)s=1&s?3988292384^s>>>1:s>>>1;a[c]=s}return a}();l.exports=function(s,a,c,x){var v=o,S=x+c;s^=-1;for(var T=x;T<S;T++)s=s>>>8^v[255&(s^a[T])];return-1^s}},{}],46:[function(r,l,d){var o,s=r("../utils/common"),a=r("./trees"),c=r("./adler32"),x=r("./crc32"),v=r("./messages"),S=0,T=4,w=0,E=-2,y=-1,A=4,p=2,k=8,j=9,O=286,F=30,G=19,W=2*O+1,$=15,N=3,ne=258,se=ne+N+1,B=42,X=113,_=1,Y=2,de=3,Q=4;function pe(h,Z){return h.msg=v[Z],Z}function te(h){return(h<<1)-(4<h?9:0)}function fe(h){for(var Z=h.length;0<=--Z;)h[Z]=0}function H(h){var Z=h.state,b=Z.pending;b>h.avail_out&&(b=h.avail_out),b!==0&&(s.arraySet(h.output,Z.pending_buf,Z.pending_out,b,h.next_out),h.next_out+=b,Z.pending_out+=b,h.total_out+=b,h.avail_out-=b,Z.pending-=b,Z.pending===0&&(Z.pending_out=0))}function R(h,Z){a._tr_flush_block(h,0<=h.block_start?h.block_start:-1,h.strstart-h.block_start,Z),h.block_start=h.strstart,H(h.strm)}function q(h,Z){h.pending_buf[h.pending++]=Z}function K(h,Z){h.pending_buf[h.pending++]=Z>>>8&255,h.pending_buf[h.pending++]=255&Z}function V(h,Z){var b,n,i=h.max_chain_length,f=h.strstart,D=h.prev_length,U=h.nice_match,L=h.strstart>h.w_size-se?h.strstart-(h.w_size-se):0,re=h.window,le=h.w_mask,ae=h.prev,he=h.strstart+ne,ge=re[f+D-1],ye=re[f+D];h.prev_length>=h.good_match&&(i>>=2),U>h.lookahead&&(U=h.lookahead);do if(re[(b=Z)+D]===ye&&re[b+D-1]===ge&&re[b]===re[f]&&re[++b]===re[f+1]){f+=2,b++;do;while(re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&re[++f]===re[++b]&&f<he);if(n=ne-(he-f),f=he-ne,D<n){if(h.match_start=Z,U<=(D=n))break;ge=re[f+D-1],ye=re[f+D]}}while((Z=ae[Z&le])>L&&--i!=0);return D<=h.lookahead?D:h.lookahead}function z(h){var Z,b,n,i,f,D,U,L,re,le,ae=h.w_size;do{if(i=h.window_size-h.lookahead-h.strstart,h.strstart>=ae+(ae-se)){for(s.arraySet(h.window,h.window,ae,ae,0),h.match_start-=ae,h.strstart-=ae,h.block_start-=ae,Z=b=h.hash_size;n=h.head[--Z],h.head[Z]=ae<=n?n-ae:0,--b;);for(Z=b=ae;n=h.prev[--Z],h.prev[Z]=ae<=n?n-ae:0,--b;);i+=ae}if(h.strm.avail_in===0)break;if(D=h.strm,U=h.window,L=h.strstart+h.lookahead,re=i,le=void 0,le=D.avail_in,re<le&&(le=re),b=le===0?0:(D.avail_in-=le,s.arraySet(U,D.input,D.next_in,le,L),D.state.wrap===1?D.adler=c(D.adler,U,le,L):D.state.wrap===2&&(D.adler=x(D.adler,U,le,L)),D.next_in+=le,D.total_in+=le,le),h.lookahead+=b,h.lookahead+h.insert>=N)for(f=h.strstart-h.insert,h.ins_h=h.window[f],h.ins_h=(h.ins_h<<h.hash_shift^h.window[f+1])&h.hash_mask;h.insert&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[f+N-1])&h.hash_mask,h.prev[f&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=f,f++,h.insert--,!(h.lookahead+h.insert<N)););}while(h.lookahead<se&&h.strm.avail_in!==0)}function g(h,Z){for(var b,n;;){if(h.lookahead<se){if(z(h),h.lookahead<se&&Z===S)return _;if(h.lookahead===0)break}if(b=0,h.lookahead>=N&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+N-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),b!==0&&h.strstart-b<=h.w_size-se&&(h.match_length=V(h,b)),h.match_length>=N)if(n=a._tr_tally(h,h.strstart-h.match_start,h.match_length-N),h.lookahead-=h.match_length,h.match_length<=h.max_lazy_match&&h.lookahead>=N){for(h.match_length--;h.strstart++,h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+N-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart,--h.match_length!=0;);h.strstart++}else h.strstart+=h.match_length,h.match_length=0,h.ins_h=h.window[h.strstart],h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+1])&h.hash_mask;else n=a._tr_tally(h,0,h.window[h.strstart]),h.lookahead--,h.strstart++;if(n&&(R(h,!1),h.strm.avail_out===0))return _}return h.insert=h.strstart<N-1?h.strstart:N-1,Z===T?(R(h,!0),h.strm.avail_out===0?de:Q):h.last_lit&&(R(h,!1),h.strm.avail_out===0)?_:Y}function m(h,Z){for(var b,n,i;;){if(h.lookahead<se){if(z(h),h.lookahead<se&&Z===S)return _;if(h.lookahead===0)break}if(b=0,h.lookahead>=N&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+N-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),h.prev_length=h.match_length,h.prev_match=h.match_start,h.match_length=N-1,b!==0&&h.prev_length<h.max_lazy_match&&h.strstart-b<=h.w_size-se&&(h.match_length=V(h,b),h.match_length<=5&&(h.strategy===1||h.match_length===N&&4096<h.strstart-h.match_start)&&(h.match_length=N-1)),h.prev_length>=N&&h.match_length<=h.prev_length){for(i=h.strstart+h.lookahead-N,n=a._tr_tally(h,h.strstart-1-h.prev_match,h.prev_length-N),h.lookahead-=h.prev_length-1,h.prev_length-=2;++h.strstart<=i&&(h.ins_h=(h.ins_h<<h.hash_shift^h.window[h.strstart+N-1])&h.hash_mask,b=h.prev[h.strstart&h.w_mask]=h.head[h.ins_h],h.head[h.ins_h]=h.strstart),--h.prev_length!=0;);if(h.match_available=0,h.match_length=N-1,h.strstart++,n&&(R(h,!1),h.strm.avail_out===0))return _}else if(h.match_available){if((n=a._tr_tally(h,0,h.window[h.strstart-1]))&&R(h,!1),h.strstart++,h.lookahead--,h.strm.avail_out===0)return _}else h.match_available=1,h.strstart++,h.lookahead--}return h.match_available&&(n=a._tr_tally(h,0,h.window[h.strstart-1]),h.match_available=0),h.insert=h.strstart<N-1?h.strstart:N-1,Z===T?(R(h,!0),h.strm.avail_out===0?de:Q):h.last_lit&&(R(h,!1),h.strm.avail_out===0)?_:Y}function M(h,Z,b,n,i){this.good_length=h,this.max_lazy=Z,this.nice_length=b,this.max_chain=n,this.func=i}function P(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=k,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new s.Buf16(2*W),this.dyn_dtree=new s.Buf16(2*(2*F+1)),this.bl_tree=new s.Buf16(2*(2*G+1)),fe(this.dyn_ltree),fe(this.dyn_dtree),fe(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new s.Buf16($+1),this.heap=new s.Buf16(2*O+1),fe(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new s.Buf16(2*O+1),fe(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function C(h){var Z;return h&&h.state?(h.total_in=h.total_out=0,h.data_type=p,(Z=h.state).pending=0,Z.pending_out=0,Z.wrap<0&&(Z.wrap=-Z.wrap),Z.status=Z.wrap?B:X,h.adler=Z.wrap===2?0:1,Z.last_flush=S,a._tr_init(Z),w):pe(h,E)}function I(h){var Z=C(h);return Z===w&&function(b){b.window_size=2*b.w_size,fe(b.head),b.max_lazy_match=o[b.level].max_lazy,b.good_match=o[b.level].good_length,b.nice_match=o[b.level].nice_length,b.max_chain_length=o[b.level].max_chain,b.strstart=0,b.block_start=0,b.lookahead=0,b.insert=0,b.match_length=b.prev_length=N-1,b.match_available=0,b.ins_h=0}(h.state),Z}function J(h,Z,b,n,i,f){if(!h)return E;var D=1;if(Z===y&&(Z=6),n<0?(D=0,n=-n):15<n&&(D=2,n-=16),i<1||j<i||b!==k||n<8||15<n||Z<0||9<Z||f<0||A<f)return pe(h,E);n===8&&(n=9);var U=new P;return(h.state=U).strm=h,U.wrap=D,U.gzhead=null,U.w_bits=n,U.w_size=1<<U.w_bits,U.w_mask=U.w_size-1,U.hash_bits=i+7,U.hash_size=1<<U.hash_bits,U.hash_mask=U.hash_size-1,U.hash_shift=~~((U.hash_bits+N-1)/N),U.window=new s.Buf8(2*U.w_size),U.head=new s.Buf16(U.hash_size),U.prev=new s.Buf16(U.w_size),U.lit_bufsize=1<<i+6,U.pending_buf_size=4*U.lit_bufsize,U.pending_buf=new s.Buf8(U.pending_buf_size),U.d_buf=1*U.lit_bufsize,U.l_buf=3*U.lit_bufsize,U.level=Z,U.strategy=f,U.method=b,I(h)}o=[new M(0,0,0,0,function(h,Z){var b=65535;for(b>h.pending_buf_size-5&&(b=h.pending_buf_size-5);;){if(h.lookahead<=1){if(z(h),h.lookahead===0&&Z===S)return _;if(h.lookahead===0)break}h.strstart+=h.lookahead,h.lookahead=0;var n=h.block_start+b;if((h.strstart===0||h.strstart>=n)&&(h.lookahead=h.strstart-n,h.strstart=n,R(h,!1),h.strm.avail_out===0)||h.strstart-h.block_start>=h.w_size-se&&(R(h,!1),h.strm.avail_out===0))return _}return h.insert=0,Z===T?(R(h,!0),h.strm.avail_out===0?de:Q):(h.strstart>h.block_start&&(R(h,!1),h.strm.avail_out),_)}),new M(4,4,8,4,g),new M(4,5,16,8,g),new M(4,6,32,32,g),new M(4,4,16,16,m),new M(8,16,32,32,m),new M(8,16,128,128,m),new M(8,32,128,256,m),new M(32,128,258,1024,m),new M(32,258,258,4096,m)],d.deflateInit=function(h,Z){return J(h,Z,k,15,8,0)},d.deflateInit2=J,d.deflateReset=I,d.deflateResetKeep=C,d.deflateSetHeader=function(h,Z){return h&&h.state?h.state.wrap!==2?E:(h.state.gzhead=Z,w):E},d.deflate=function(h,Z){var b,n,i,f;if(!h||!h.state||5<Z||Z<0)return h?pe(h,E):E;if(n=h.state,!h.output||!h.input&&h.avail_in!==0||n.status===666&&Z!==T)return pe(h,h.avail_out===0?-5:E);if(n.strm=h,b=n.last_flush,n.last_flush=Z,n.status===B)if(n.wrap===2)h.adler=0,q(n,31),q(n,139),q(n,8),n.gzhead?(q(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),q(n,255&n.gzhead.time),q(n,n.gzhead.time>>8&255),q(n,n.gzhead.time>>16&255),q(n,n.gzhead.time>>24&255),q(n,n.level===9?2:2<=n.strategy||n.level<2?4:0),q(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(q(n,255&n.gzhead.extra.length),q(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(h.adler=x(h.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(q(n,0),q(n,0),q(n,0),q(n,0),q(n,0),q(n,n.level===9?2:2<=n.strategy||n.level<2?4:0),q(n,3),n.status=X);else{var D=k+(n.w_bits-8<<4)<<8;D|=(2<=n.strategy||n.level<2?0:n.level<6?1:n.level===6?2:3)<<6,n.strstart!==0&&(D|=32),D+=31-D%31,n.status=X,K(n,D),n.strstart!==0&&(K(n,h.adler>>>16),K(n,65535&h.adler)),h.adler=1}if(n.status===69)if(n.gzhead.extra){for(i=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),H(h),i=n.pending,n.pending!==n.pending_buf_size));)q(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(n.status===73)if(n.gzhead.name){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),H(h),i=n.pending,n.pending===n.pending_buf_size)){f=1;break}f=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,q(n,f)}while(f!==0);n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),f===0&&(n.gzindex=0,n.status=91)}else n.status=91;if(n.status===91)if(n.gzhead.comment){i=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),H(h),i=n.pending,n.pending===n.pending_buf_size)){f=1;break}f=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,q(n,f)}while(f!==0);n.gzhead.hcrc&&n.pending>i&&(h.adler=x(h.adler,n.pending_buf,n.pending-i,i)),f===0&&(n.status=103)}else n.status=103;if(n.status===103&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&H(h),n.pending+2<=n.pending_buf_size&&(q(n,255&h.adler),q(n,h.adler>>8&255),h.adler=0,n.status=X)):n.status=X),n.pending!==0){if(H(h),h.avail_out===0)return n.last_flush=-1,w}else if(h.avail_in===0&&te(Z)<=te(b)&&Z!==T)return pe(h,-5);if(n.status===666&&h.avail_in!==0)return pe(h,-5);if(h.avail_in!==0||n.lookahead!==0||Z!==S&&n.status!==666){var U=n.strategy===2?function(L,re){for(var le;;){if(L.lookahead===0&&(z(L),L.lookahead===0)){if(re===S)return _;break}if(L.match_length=0,le=a._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++,le&&(R(L,!1),L.strm.avail_out===0))return _}return L.insert=0,re===T?(R(L,!0),L.strm.avail_out===0?de:Q):L.last_lit&&(R(L,!1),L.strm.avail_out===0)?_:Y}(n,Z):n.strategy===3?function(L,re){for(var le,ae,he,ge,ye=L.window;;){if(L.lookahead<=ne){if(z(L),L.lookahead<=ne&&re===S)return _;if(L.lookahead===0)break}if(L.match_length=0,L.lookahead>=N&&0<L.strstart&&(ae=ye[he=L.strstart-1])===ye[++he]&&ae===ye[++he]&&ae===ye[++he]){ge=L.strstart+ne;do;while(ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&ae===ye[++he]&&he<ge);L.match_length=ne-(ge-he),L.match_length>L.lookahead&&(L.match_length=L.lookahead)}if(L.match_length>=N?(le=a._tr_tally(L,1,L.match_length-N),L.lookahead-=L.match_length,L.strstart+=L.match_length,L.match_length=0):(le=a._tr_tally(L,0,L.window[L.strstart]),L.lookahead--,L.strstart++),le&&(R(L,!1),L.strm.avail_out===0))return _}return L.insert=0,re===T?(R(L,!0),L.strm.avail_out===0?de:Q):L.last_lit&&(R(L,!1),L.strm.avail_out===0)?_:Y}(n,Z):o[n.level].func(n,Z);if(U!==de&&U!==Q||(n.status=666),U===_||U===de)return h.avail_out===0&&(n.last_flush=-1),w;if(U===Y&&(Z===1?a._tr_align(n):Z!==5&&(a._tr_stored_block(n,0,0,!1),Z===3&&(fe(n.head),n.lookahead===0&&(n.strstart=0,n.block_start=0,n.insert=0))),H(h),h.avail_out===0))return n.last_flush=-1,w}return Z!==T?w:n.wrap<=0?1:(n.wrap===2?(q(n,255&h.adler),q(n,h.adler>>8&255),q(n,h.adler>>16&255),q(n,h.adler>>24&255),q(n,255&h.total_in),q(n,h.total_in>>8&255),q(n,h.total_in>>16&255),q(n,h.total_in>>24&255)):(K(n,h.adler>>>16),K(n,65535&h.adler)),H(h),0<n.wrap&&(n.wrap=-n.wrap),n.pending!==0?w:1)},d.deflateEnd=function(h){var Z;return h&&h.state?(Z=h.state.status)!==B&&Z!==69&&Z!==73&&Z!==91&&Z!==103&&Z!==X&&Z!==666?pe(h,E):(h.state=null,Z===X?pe(h,-3):w):E},d.deflateSetDictionary=function(h,Z){var b,n,i,f,D,U,L,re,le=Z.length;if(!h||!h.state||(f=(b=h.state).wrap)===2||f===1&&b.status!==B||b.lookahead)return E;for(f===1&&(h.adler=c(h.adler,Z,le,0)),b.wrap=0,le>=b.w_size&&(f===0&&(fe(b.head),b.strstart=0,b.block_start=0,b.insert=0),re=new s.Buf8(b.w_size),s.arraySet(re,Z,le-b.w_size,b.w_size,0),Z=re,le=b.w_size),D=h.avail_in,U=h.next_in,L=h.input,h.avail_in=le,h.next_in=0,h.input=Z,z(b);b.lookahead>=N;){for(n=b.strstart,i=b.lookahead-(N-1);b.ins_h=(b.ins_h<<b.hash_shift^b.window[n+N-1])&b.hash_mask,b.prev[n&b.w_mask]=b.head[b.ins_h],b.head[b.ins_h]=n,n++,--i;);b.strstart=n,b.lookahead=N-1,z(b)}return b.strstart+=b.lookahead,b.block_start=b.strstart,b.insert=b.lookahead,b.lookahead=0,b.match_length=b.prev_length=N-1,b.match_available=0,h.next_in=U,h.input=L,h.avail_in=D,b.wrap=f,w},d.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(r,l,d){l.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(r,l,d){l.exports=function(o,s){var a,c,x,v,S,T,w,E,y,A,p,k,j,O,F,G,W,$,N,ne,se,B,X,_,Y;a=o.state,c=o.next_in,_=o.input,x=c+(o.avail_in-5),v=o.next_out,Y=o.output,S=v-(s-o.avail_out),T=v+(o.avail_out-257),w=a.dmax,E=a.wsize,y=a.whave,A=a.wnext,p=a.window,k=a.hold,j=a.bits,O=a.lencode,F=a.distcode,G=(1<<a.lenbits)-1,W=(1<<a.distbits)-1;e:do{j<15&&(k+=_[c++]<<j,j+=8,k+=_[c++]<<j,j+=8),$=O[k&G];t:for(;;){if(k>>>=N=$>>>24,j-=N,(N=$>>>16&255)===0)Y[v++]=65535&$;else{if(!(16&N)){if(!(64&N)){$=O[(65535&$)+(k&(1<<N)-1)];continue t}if(32&N){a.mode=12;break e}o.msg="invalid literal/length code",a.mode=30;break e}ne=65535&$,(N&=15)&&(j<N&&(k+=_[c++]<<j,j+=8),ne+=k&(1<<N)-1,k>>>=N,j-=N),j<15&&(k+=_[c++]<<j,j+=8,k+=_[c++]<<j,j+=8),$=F[k&W];r:for(;;){if(k>>>=N=$>>>24,j-=N,!(16&(N=$>>>16&255))){if(!(64&N)){$=F[(65535&$)+(k&(1<<N)-1)];continue r}o.msg="invalid distance code",a.mode=30;break e}if(se=65535&$,j<(N&=15)&&(k+=_[c++]<<j,(j+=8)<N&&(k+=_[c++]<<j,j+=8)),w<(se+=k&(1<<N)-1)){o.msg="invalid distance too far back",a.mode=30;break e}if(k>>>=N,j-=N,(N=v-S)<se){if(y<(N=se-N)&&a.sane){o.msg="invalid distance too far back",a.mode=30;break e}if(X=p,(B=0)===A){if(B+=E-N,N<ne){for(ne-=N;Y[v++]=p[B++],--N;);B=v-se,X=Y}}else if(A<N){if(B+=E+A-N,(N-=A)<ne){for(ne-=N;Y[v++]=p[B++],--N;);if(B=0,A<ne){for(ne-=N=A;Y[v++]=p[B++],--N;);B=v-se,X=Y}}}else if(B+=A-N,N<ne){for(ne-=N;Y[v++]=p[B++],--N;);B=v-se,X=Y}for(;2<ne;)Y[v++]=X[B++],Y[v++]=X[B++],Y[v++]=X[B++],ne-=3;ne&&(Y[v++]=X[B++],1<ne&&(Y[v++]=X[B++]))}else{for(B=v-se;Y[v++]=Y[B++],Y[v++]=Y[B++],Y[v++]=Y[B++],2<(ne-=3););ne&&(Y[v++]=Y[B++],1<ne&&(Y[v++]=Y[B++]))}break}}break}}while(c<x&&v<T);c-=ne=j>>3,k&=(1<<(j-=ne<<3))-1,o.next_in=c,o.next_out=v,o.avail_in=c<x?x-c+5:5-(c-x),o.avail_out=v<T?T-v+257:257-(v-T),a.hold=k,a.bits=j}},{}],49:[function(r,l,d){var o=r("../utils/common"),s=r("./adler32"),a=r("./crc32"),c=r("./inffast"),x=r("./inftrees"),v=1,S=2,T=0,w=-2,E=1,y=852,A=592;function p(B){return(B>>>24&255)+(B>>>8&65280)+((65280&B)<<8)+((255&B)<<24)}function k(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new o.Buf16(320),this.work=new o.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function j(B){var X;return B&&B.state?(X=B.state,B.total_in=B.total_out=X.total=0,B.msg="",X.wrap&&(B.adler=1&X.wrap),X.mode=E,X.last=0,X.havedict=0,X.dmax=32768,X.head=null,X.hold=0,X.bits=0,X.lencode=X.lendyn=new o.Buf32(y),X.distcode=X.distdyn=new o.Buf32(A),X.sane=1,X.back=-1,T):w}function O(B){var X;return B&&B.state?((X=B.state).wsize=0,X.whave=0,X.wnext=0,j(B)):w}function F(B,X){var _,Y;return B&&B.state?(Y=B.state,X<0?(_=0,X=-X):(_=1+(X>>4),X<48&&(X&=15)),X&&(X<8||15<X)?w:(Y.window!==null&&Y.wbits!==X&&(Y.window=null),Y.wrap=_,Y.wbits=X,O(B))):w}function G(B,X){var _,Y;return B?(Y=new k,(B.state=Y).window=null,(_=F(B,X))!==T&&(B.state=null),_):w}var W,$,N=!0;function ne(B){if(N){var X;for(W=new o.Buf32(512),$=new o.Buf32(32),X=0;X<144;)B.lens[X++]=8;for(;X<256;)B.lens[X++]=9;for(;X<280;)B.lens[X++]=7;for(;X<288;)B.lens[X++]=8;for(x(v,B.lens,0,288,W,0,B.work,{bits:9}),X=0;X<32;)B.lens[X++]=5;x(S,B.lens,0,32,$,0,B.work,{bits:5}),N=!1}B.lencode=W,B.lenbits=9,B.distcode=$,B.distbits=5}function se(B,X,_,Y){var de,Q=B.state;return Q.window===null&&(Q.wsize=1<<Q.wbits,Q.wnext=0,Q.whave=0,Q.window=new o.Buf8(Q.wsize)),Y>=Q.wsize?(o.arraySet(Q.window,X,_-Q.wsize,Q.wsize,0),Q.wnext=0,Q.whave=Q.wsize):(Y<(de=Q.wsize-Q.wnext)&&(de=Y),o.arraySet(Q.window,X,_-Y,de,Q.wnext),(Y-=de)?(o.arraySet(Q.window,X,_-Y,Y,0),Q.wnext=Y,Q.whave=Q.wsize):(Q.wnext+=de,Q.wnext===Q.wsize&&(Q.wnext=0),Q.whave<Q.wsize&&(Q.whave+=de))),0}d.inflateReset=O,d.inflateReset2=F,d.inflateResetKeep=j,d.inflateInit=function(B){return G(B,15)},d.inflateInit2=G,d.inflate=function(B,X){var _,Y,de,Q,pe,te,fe,H,R,q,K,V,z,g,m,M,P,C,I,J,h,Z,b,n,i=0,f=new o.Buf8(4),D=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!B||!B.state||!B.output||!B.input&&B.avail_in!==0)return w;(_=B.state).mode===12&&(_.mode=13),pe=B.next_out,de=B.output,fe=B.avail_out,Q=B.next_in,Y=B.input,te=B.avail_in,H=_.hold,R=_.bits,q=te,K=fe,Z=T;e:for(;;)switch(_.mode){case E:if(_.wrap===0){_.mode=13;break}for(;R<16;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(2&_.wrap&&H===35615){f[_.check=0]=255&H,f[1]=H>>>8&255,_.check=a(_.check,f,2,0),R=H=0,_.mode=2;break}if(_.flags=0,_.head&&(_.head.done=!1),!(1&_.wrap)||(((255&H)<<8)+(H>>8))%31){B.msg="incorrect header check",_.mode=30;break}if((15&H)!=8){B.msg="unknown compression method",_.mode=30;break}if(R-=4,h=8+(15&(H>>>=4)),_.wbits===0)_.wbits=h;else if(h>_.wbits){B.msg="invalid window size",_.mode=30;break}_.dmax=1<<h,B.adler=_.check=1,_.mode=512&H?10:12,R=H=0;break;case 2:for(;R<16;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(_.flags=H,(255&_.flags)!=8){B.msg="unknown compression method",_.mode=30;break}if(57344&_.flags){B.msg="unknown header flags set",_.mode=30;break}_.head&&(_.head.text=H>>8&1),512&_.flags&&(f[0]=255&H,f[1]=H>>>8&255,_.check=a(_.check,f,2,0)),R=H=0,_.mode=3;case 3:for(;R<32;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.head&&(_.head.time=H),512&_.flags&&(f[0]=255&H,f[1]=H>>>8&255,f[2]=H>>>16&255,f[3]=H>>>24&255,_.check=a(_.check,f,4,0)),R=H=0,_.mode=4;case 4:for(;R<16;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.head&&(_.head.xflags=255&H,_.head.os=H>>8),512&_.flags&&(f[0]=255&H,f[1]=H>>>8&255,_.check=a(_.check,f,2,0)),R=H=0,_.mode=5;case 5:if(1024&_.flags){for(;R<16;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.length=H,_.head&&(_.head.extra_len=H),512&_.flags&&(f[0]=255&H,f[1]=H>>>8&255,_.check=a(_.check,f,2,0)),R=H=0}else _.head&&(_.head.extra=null);_.mode=6;case 6:if(1024&_.flags&&(te<(V=_.length)&&(V=te),V&&(_.head&&(h=_.head.extra_len-_.length,_.head.extra||(_.head.extra=new Array(_.head.extra_len)),o.arraySet(_.head.extra,Y,Q,V,h)),512&_.flags&&(_.check=a(_.check,Y,V,Q)),te-=V,Q+=V,_.length-=V),_.length))break e;_.length=0,_.mode=7;case 7:if(2048&_.flags){if(te===0)break e;for(V=0;h=Y[Q+V++],_.head&&h&&_.length<65536&&(_.head.name+=String.fromCharCode(h)),h&&V<te;);if(512&_.flags&&(_.check=a(_.check,Y,V,Q)),te-=V,Q+=V,h)break e}else _.head&&(_.head.name=null);_.length=0,_.mode=8;case 8:if(4096&_.flags){if(te===0)break e;for(V=0;h=Y[Q+V++],_.head&&h&&_.length<65536&&(_.head.comment+=String.fromCharCode(h)),h&&V<te;);if(512&_.flags&&(_.check=a(_.check,Y,V,Q)),te-=V,Q+=V,h)break e}else _.head&&(_.head.comment=null);_.mode=9;case 9:if(512&_.flags){for(;R<16;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(H!==(65535&_.check)){B.msg="header crc mismatch",_.mode=30;break}R=H=0}_.head&&(_.head.hcrc=_.flags>>9&1,_.head.done=!0),B.adler=_.check=0,_.mode=12;break;case 10:for(;R<32;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}B.adler=_.check=p(H),R=H=0,_.mode=11;case 11:if(_.havedict===0)return B.next_out=pe,B.avail_out=fe,B.next_in=Q,B.avail_in=te,_.hold=H,_.bits=R,2;B.adler=_.check=1,_.mode=12;case 12:if(X===5||X===6)break e;case 13:if(_.last){H>>>=7&R,R-=7&R,_.mode=27;break}for(;R<3;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}switch(_.last=1&H,R-=1,3&(H>>>=1)){case 0:_.mode=14;break;case 1:if(ne(_),_.mode=20,X!==6)break;H>>>=2,R-=2;break e;case 2:_.mode=17;break;case 3:B.msg="invalid block type",_.mode=30}H>>>=2,R-=2;break;case 14:for(H>>>=7&R,R-=7&R;R<32;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if((65535&H)!=(H>>>16^65535)){B.msg="invalid stored block lengths",_.mode=30;break}if(_.length=65535&H,R=H=0,_.mode=15,X===6)break e;case 15:_.mode=16;case 16:if(V=_.length){if(te<V&&(V=te),fe<V&&(V=fe),V===0)break e;o.arraySet(de,Y,Q,V,pe),te-=V,Q+=V,fe-=V,pe+=V,_.length-=V;break}_.mode=12;break;case 17:for(;R<14;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(_.nlen=257+(31&H),H>>>=5,R-=5,_.ndist=1+(31&H),H>>>=5,R-=5,_.ncode=4+(15&H),H>>>=4,R-=4,286<_.nlen||30<_.ndist){B.msg="too many length or distance symbols",_.mode=30;break}_.have=0,_.mode=18;case 18:for(;_.have<_.ncode;){for(;R<3;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.lens[D[_.have++]]=7&H,H>>>=3,R-=3}for(;_.have<19;)_.lens[D[_.have++]]=0;if(_.lencode=_.lendyn,_.lenbits=7,b={bits:_.lenbits},Z=x(0,_.lens,0,19,_.lencode,0,_.work,b),_.lenbits=b.bits,Z){B.msg="invalid code lengths set",_.mode=30;break}_.have=0,_.mode=19;case 19:for(;_.have<_.nlen+_.ndist;){for(;M=(i=_.lencode[H&(1<<_.lenbits)-1])>>>16&255,P=65535&i,!((m=i>>>24)<=R);){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(P<16)H>>>=m,R-=m,_.lens[_.have++]=P;else{if(P===16){for(n=m+2;R<n;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(H>>>=m,R-=m,_.have===0){B.msg="invalid bit length repeat",_.mode=30;break}h=_.lens[_.have-1],V=3+(3&H),H>>>=2,R-=2}else if(P===17){for(n=m+3;R<n;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}R-=m,h=0,V=3+(7&(H>>>=m)),H>>>=3,R-=3}else{for(n=m+7;R<n;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}R-=m,h=0,V=11+(127&(H>>>=m)),H>>>=7,R-=7}if(_.have+V>_.nlen+_.ndist){B.msg="invalid bit length repeat",_.mode=30;break}for(;V--;)_.lens[_.have++]=h}}if(_.mode===30)break;if(_.lens[256]===0){B.msg="invalid code -- missing end-of-block",_.mode=30;break}if(_.lenbits=9,b={bits:_.lenbits},Z=x(v,_.lens,0,_.nlen,_.lencode,0,_.work,b),_.lenbits=b.bits,Z){B.msg="invalid literal/lengths set",_.mode=30;break}if(_.distbits=6,_.distcode=_.distdyn,b={bits:_.distbits},Z=x(S,_.lens,_.nlen,_.ndist,_.distcode,0,_.work,b),_.distbits=b.bits,Z){B.msg="invalid distances set",_.mode=30;break}if(_.mode=20,X===6)break e;case 20:_.mode=21;case 21:if(6<=te&&258<=fe){B.next_out=pe,B.avail_out=fe,B.next_in=Q,B.avail_in=te,_.hold=H,_.bits=R,c(B,K),pe=B.next_out,de=B.output,fe=B.avail_out,Q=B.next_in,Y=B.input,te=B.avail_in,H=_.hold,R=_.bits,_.mode===12&&(_.back=-1);break}for(_.back=0;M=(i=_.lencode[H&(1<<_.lenbits)-1])>>>16&255,P=65535&i,!((m=i>>>24)<=R);){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(M&&!(240&M)){for(C=m,I=M,J=P;M=(i=_.lencode[J+((H&(1<<C+I)-1)>>C)])>>>16&255,P=65535&i,!(C+(m=i>>>24)<=R);){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}H>>>=C,R-=C,_.back+=C}if(H>>>=m,R-=m,_.back+=m,_.length=P,M===0){_.mode=26;break}if(32&M){_.back=-1,_.mode=12;break}if(64&M){B.msg="invalid literal/length code",_.mode=30;break}_.extra=15&M,_.mode=22;case 22:if(_.extra){for(n=_.extra;R<n;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.length+=H&(1<<_.extra)-1,H>>>=_.extra,R-=_.extra,_.back+=_.extra}_.was=_.length,_.mode=23;case 23:for(;M=(i=_.distcode[H&(1<<_.distbits)-1])>>>16&255,P=65535&i,!((m=i>>>24)<=R);){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(!(240&M)){for(C=m,I=M,J=P;M=(i=_.distcode[J+((H&(1<<C+I)-1)>>C)])>>>16&255,P=65535&i,!(C+(m=i>>>24)<=R);){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}H>>>=C,R-=C,_.back+=C}if(H>>>=m,R-=m,_.back+=m,64&M){B.msg="invalid distance code",_.mode=30;break}_.offset=P,_.extra=15&M,_.mode=24;case 24:if(_.extra){for(n=_.extra;R<n;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}_.offset+=H&(1<<_.extra)-1,H>>>=_.extra,R-=_.extra,_.back+=_.extra}if(_.offset>_.dmax){B.msg="invalid distance too far back",_.mode=30;break}_.mode=25;case 25:if(fe===0)break e;if(V=K-fe,_.offset>V){if((V=_.offset-V)>_.whave&&_.sane){B.msg="invalid distance too far back",_.mode=30;break}z=V>_.wnext?(V-=_.wnext,_.wsize-V):_.wnext-V,V>_.length&&(V=_.length),g=_.window}else g=de,z=pe-_.offset,V=_.length;for(fe<V&&(V=fe),fe-=V,_.length-=V;de[pe++]=g[z++],--V;);_.length===0&&(_.mode=21);break;case 26:if(fe===0)break e;de[pe++]=_.length,fe--,_.mode=21;break;case 27:if(_.wrap){for(;R<32;){if(te===0)break e;te--,H|=Y[Q++]<<R,R+=8}if(K-=fe,B.total_out+=K,_.total+=K,K&&(B.adler=_.check=_.flags?a(_.check,de,K,pe-K):s(_.check,de,K,pe-K)),K=fe,(_.flags?H:p(H))!==_.check){B.msg="incorrect data check",_.mode=30;break}R=H=0}_.mode=28;case 28:if(_.wrap&&_.flags){for(;R<32;){if(te===0)break e;te--,H+=Y[Q++]<<R,R+=8}if(H!==(4294967295&_.total)){B.msg="incorrect length check",_.mode=30;break}R=H=0}_.mode=29;case 29:Z=1;break e;case 30:Z=-3;break e;case 31:return-4;case 32:default:return w}return B.next_out=pe,B.avail_out=fe,B.next_in=Q,B.avail_in=te,_.hold=H,_.bits=R,(_.wsize||K!==B.avail_out&&_.mode<30&&(_.mode<27||X!==4))&&se(B,B.output,B.next_out,K-B.avail_out)?(_.mode=31,-4):(q-=B.avail_in,K-=B.avail_out,B.total_in+=q,B.total_out+=K,_.total+=K,_.wrap&&K&&(B.adler=_.check=_.flags?a(_.check,de,K,B.next_out-K):s(_.check,de,K,B.next_out-K)),B.data_type=_.bits+(_.last?64:0)+(_.mode===12?128:0)+(_.mode===20||_.mode===15?256:0),(q==0&&K===0||X===4)&&Z===T&&(Z=-5),Z)},d.inflateEnd=function(B){if(!B||!B.state)return w;var X=B.state;return X.window&&(X.window=null),B.state=null,T},d.inflateGetHeader=function(B,X){var _;return B&&B.state&&2&(_=B.state).wrap?((_.head=X).done=!1,T):w},d.inflateSetDictionary=function(B,X){var _,Y=X.length;return B&&B.state?(_=B.state).wrap!==0&&_.mode!==11?w:_.mode===11&&s(1,X,Y,0)!==_.check?-3:se(B,X,Y,Y)?(_.mode=31,-4):(_.havedict=1,T):w},d.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(r,l,d){var o=r("../utils/common"),s=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],x=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];l.exports=function(v,S,T,w,E,y,A,p){var k,j,O,F,G,W,$,N,ne,se=p.bits,B=0,X=0,_=0,Y=0,de=0,Q=0,pe=0,te=0,fe=0,H=0,R=null,q=0,K=new o.Buf16(16),V=new o.Buf16(16),z=null,g=0;for(B=0;B<=15;B++)K[B]=0;for(X=0;X<w;X++)K[S[T+X]]++;for(de=se,Y=15;1<=Y&&K[Y]===0;Y--);if(Y<de&&(de=Y),Y===0)return E[y++]=20971520,E[y++]=20971520,p.bits=1,0;for(_=1;_<Y&&K[_]===0;_++);for(de<_&&(de=_),B=te=1;B<=15;B++)if(te<<=1,(te-=K[B])<0)return-1;if(0<te&&(v===0||Y!==1))return-1;for(V[1]=0,B=1;B<15;B++)V[B+1]=V[B]+K[B];for(X=0;X<w;X++)S[T+X]!==0&&(A[V[S[T+X]]++]=X);if(W=v===0?(R=z=A,19):v===1?(R=s,q-=257,z=a,g-=257,256):(R=c,z=x,-1),B=_,G=y,pe=X=H=0,O=-1,F=(fe=1<<(Q=de))-1,v===1&&852<fe||v===2&&592<fe)return 1;for(;;){for($=B-pe,ne=A[X]<W?(N=0,A[X]):A[X]>W?(N=z[g+A[X]],R[q+A[X]]):(N=96,0),k=1<<B-pe,_=j=1<<Q;E[G+(H>>pe)+(j-=k)]=$<<24|N<<16|ne|0,j!==0;);for(k=1<<B-1;H&k;)k>>=1;if(k!==0?(H&=k-1,H+=k):H=0,X++,--K[B]==0){if(B===Y)break;B=S[T+A[X]]}if(de<B&&(H&F)!==O){for(pe===0&&(pe=de),G+=_,te=1<<(Q=B-pe);Q+pe<Y&&!((te-=K[Q+pe])<=0);)Q++,te<<=1;if(fe+=1<<Q,v===1&&852<fe||v===2&&592<fe)return 1;E[O=H&F]=de<<24|Q<<16|G-y|0}}return H!==0&&(E[G+H]=B-pe<<24|64<<16|0),p.bits=de,0}},{"../utils/common":41}],51:[function(r,l,d){l.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(r,l,d){var o=r("../utils/common"),s=0,a=1;function c(i){for(var f=i.length;0<=--f;)i[f]=0}var x=0,v=29,S=256,T=S+1+v,w=30,E=19,y=2*T+1,A=15,p=16,k=7,j=256,O=16,F=17,G=18,W=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],$=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],N=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ne=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],se=new Array(2*(T+2));c(se);var B=new Array(2*w);c(B);var X=new Array(512);c(X);var _=new Array(256);c(_);var Y=new Array(v);c(Y);var de,Q,pe,te=new Array(w);function fe(i,f,D,U,L){this.static_tree=i,this.extra_bits=f,this.extra_base=D,this.elems=U,this.max_length=L,this.has_stree=i&&i.length}function H(i,f){this.dyn_tree=i,this.max_code=0,this.stat_desc=f}function R(i){return i<256?X[i]:X[256+(i>>>7)]}function q(i,f){i.pending_buf[i.pending++]=255&f,i.pending_buf[i.pending++]=f>>>8&255}function K(i,f,D){i.bi_valid>p-D?(i.bi_buf|=f<<i.bi_valid&65535,q(i,i.bi_buf),i.bi_buf=f>>p-i.bi_valid,i.bi_valid+=D-p):(i.bi_buf|=f<<i.bi_valid&65535,i.bi_valid+=D)}function V(i,f,D){K(i,D[2*f],D[2*f+1])}function z(i,f){for(var D=0;D|=1&i,i>>>=1,D<<=1,0<--f;);return D>>>1}function g(i,f,D){var U,L,re=new Array(A+1),le=0;for(U=1;U<=A;U++)re[U]=le=le+D[U-1]<<1;for(L=0;L<=f;L++){var ae=i[2*L+1];ae!==0&&(i[2*L]=z(re[ae]++,ae))}}function m(i){var f;for(f=0;f<T;f++)i.dyn_ltree[2*f]=0;for(f=0;f<w;f++)i.dyn_dtree[2*f]=0;for(f=0;f<E;f++)i.bl_tree[2*f]=0;i.dyn_ltree[2*j]=1,i.opt_len=i.static_len=0,i.last_lit=i.matches=0}function M(i){8<i.bi_valid?q(i,i.bi_buf):0<i.bi_valid&&(i.pending_buf[i.pending++]=i.bi_buf),i.bi_buf=0,i.bi_valid=0}function P(i,f,D,U){var L=2*f,re=2*D;return i[L]<i[re]||i[L]===i[re]&&U[f]<=U[D]}function C(i,f,D){for(var U=i.heap[D],L=D<<1;L<=i.heap_len&&(L<i.heap_len&&P(f,i.heap[L+1],i.heap[L],i.depth)&&L++,!P(f,U,i.heap[L],i.depth));)i.heap[D]=i.heap[L],D=L,L<<=1;i.heap[D]=U}function I(i,f,D){var U,L,re,le,ae=0;if(i.last_lit!==0)for(;U=i.pending_buf[i.d_buf+2*ae]<<8|i.pending_buf[i.d_buf+2*ae+1],L=i.pending_buf[i.l_buf+ae],ae++,U===0?V(i,L,f):(V(i,(re=_[L])+S+1,f),(le=W[re])!==0&&K(i,L-=Y[re],le),V(i,re=R(--U),D),(le=$[re])!==0&&K(i,U-=te[re],le)),ae<i.last_lit;);V(i,j,f)}function J(i,f){var D,U,L,re=f.dyn_tree,le=f.stat_desc.static_tree,ae=f.stat_desc.has_stree,he=f.stat_desc.elems,ge=-1;for(i.heap_len=0,i.heap_max=y,D=0;D<he;D++)re[2*D]!==0?(i.heap[++i.heap_len]=ge=D,i.depth[D]=0):re[2*D+1]=0;for(;i.heap_len<2;)re[2*(L=i.heap[++i.heap_len]=ge<2?++ge:0)]=1,i.depth[L]=0,i.opt_len--,ae&&(i.static_len-=le[2*L+1]);for(f.max_code=ge,D=i.heap_len>>1;1<=D;D--)C(i,re,D);for(L=he;D=i.heap[1],i.heap[1]=i.heap[i.heap_len--],C(i,re,1),U=i.heap[1],i.heap[--i.heap_max]=D,i.heap[--i.heap_max]=U,re[2*L]=re[2*D]+re[2*U],i.depth[L]=(i.depth[D]>=i.depth[U]?i.depth[D]:i.depth[U])+1,re[2*D+1]=re[2*U+1]=L,i.heap[1]=L++,C(i,re,1),2<=i.heap_len;);i.heap[--i.heap_max]=i.heap[1],function(ye,Be){var ce,we,_e,be,Re,Ne,je=Be.dyn_tree,We=Be.max_code,Le=Be.stat_desc.static_tree,Ke=Be.stat_desc.has_stree,qe=Be.stat_desc.extra_bits,lt=Be.stat_desc.extra_base,et=Be.stat_desc.max_length,It=0;for(be=0;be<=A;be++)ye.bl_count[be]=0;for(je[2*ye.heap[ye.heap_max]+1]=0,ce=ye.heap_max+1;ce<y;ce++)et<(be=je[2*je[2*(we=ye.heap[ce])+1]+1]+1)&&(be=et,It++),je[2*we+1]=be,We<we||(ye.bl_count[be]++,Re=0,lt<=we&&(Re=qe[we-lt]),Ne=je[2*we],ye.opt_len+=Ne*(be+Re),Ke&&(ye.static_len+=Ne*(Le[2*we+1]+Re)));if(It!==0){do{for(be=et-1;ye.bl_count[be]===0;)be--;ye.bl_count[be]--,ye.bl_count[be+1]+=2,ye.bl_count[et]--,It-=2}while(0<It);for(be=et;be!==0;be--)for(we=ye.bl_count[be];we!==0;)We<(_e=ye.heap[--ce])||(je[2*_e+1]!==be&&(ye.opt_len+=(be-je[2*_e+1])*je[2*_e],je[2*_e+1]=be),we--)}}(i,f),g(re,ge,i.bl_count)}function h(i,f,D){var U,L,re=-1,le=f[1],ae=0,he=7,ge=4;for(le===0&&(he=138,ge=3),f[2*(D+1)+1]=65535,U=0;U<=D;U++)L=le,le=f[2*(U+1)+1],++ae<he&&L===le||(ae<ge?i.bl_tree[2*L]+=ae:L!==0?(L!==re&&i.bl_tree[2*L]++,i.bl_tree[2*O]++):ae<=10?i.bl_tree[2*F]++:i.bl_tree[2*G]++,re=L,ge=(ae=0)===le?(he=138,3):L===le?(he=6,3):(he=7,4))}function Z(i,f,D){var U,L,re=-1,le=f[1],ae=0,he=7,ge=4;for(le===0&&(he=138,ge=3),U=0;U<=D;U++)if(L=le,le=f[2*(U+1)+1],!(++ae<he&&L===le)){if(ae<ge)for(;V(i,L,i.bl_tree),--ae!=0;);else L!==0?(L!==re&&(V(i,L,i.bl_tree),ae--),V(i,O,i.bl_tree),K(i,ae-3,2)):ae<=10?(V(i,F,i.bl_tree),K(i,ae-3,3)):(V(i,G,i.bl_tree),K(i,ae-11,7));re=L,ge=(ae=0)===le?(he=138,3):L===le?(he=6,3):(he=7,4)}}c(te);var b=!1;function n(i,f,D,U){K(i,(x<<1)+(U?1:0),3),function(L,re,le,ae){M(L),q(L,le),q(L,~le),o.arraySet(L.pending_buf,L.window,re,le,L.pending),L.pending+=le}(i,f,D)}d._tr_init=function(i){b||(function(){var f,D,U,L,re,le=new Array(A+1);for(L=U=0;L<v-1;L++)for(Y[L]=U,f=0;f<1<<W[L];f++)_[U++]=L;for(_[U-1]=L,L=re=0;L<16;L++)for(te[L]=re,f=0;f<1<<$[L];f++)X[re++]=L;for(re>>=7;L<w;L++)for(te[L]=re<<7,f=0;f<1<<$[L]-7;f++)X[256+re++]=L;for(D=0;D<=A;D++)le[D]=0;for(f=0;f<=143;)se[2*f+1]=8,f++,le[8]++;for(;f<=255;)se[2*f+1]=9,f++,le[9]++;for(;f<=279;)se[2*f+1]=7,f++,le[7]++;for(;f<=287;)se[2*f+1]=8,f++,le[8]++;for(g(se,T+1,le),f=0;f<w;f++)B[2*f+1]=5,B[2*f]=z(f,5);de=new fe(se,W,S+1,T,A),Q=new fe(B,$,0,w,A),pe=new fe(new Array(0),N,0,E,k)}(),b=!0),i.l_desc=new H(i.dyn_ltree,de),i.d_desc=new H(i.dyn_dtree,Q),i.bl_desc=new H(i.bl_tree,pe),i.bi_buf=0,i.bi_valid=0,m(i)},d._tr_stored_block=n,d._tr_flush_block=function(i,f,D,U){var L,re,le=0;0<i.level?(i.strm.data_type===2&&(i.strm.data_type=function(ae){var he,ge=4093624447;for(he=0;he<=31;he++,ge>>>=1)if(1&ge&&ae.dyn_ltree[2*he]!==0)return s;if(ae.dyn_ltree[18]!==0||ae.dyn_ltree[20]!==0||ae.dyn_ltree[26]!==0)return a;for(he=32;he<S;he++)if(ae.dyn_ltree[2*he]!==0)return a;return s}(i)),J(i,i.l_desc),J(i,i.d_desc),le=function(ae){var he;for(h(ae,ae.dyn_ltree,ae.l_desc.max_code),h(ae,ae.dyn_dtree,ae.d_desc.max_code),J(ae,ae.bl_desc),he=E-1;3<=he&&ae.bl_tree[2*ne[he]+1]===0;he--);return ae.opt_len+=3*(he+1)+5+5+4,he}(i),L=i.opt_len+3+7>>>3,(re=i.static_len+3+7>>>3)<=L&&(L=re)):L=re=D+5,D+4<=L&&f!==-1?n(i,f,D,U):i.strategy===4||re===L?(K(i,2+(U?1:0),3),I(i,se,B)):(K(i,4+(U?1:0),3),function(ae,he,ge,ye){var Be;for(K(ae,he-257,5),K(ae,ge-1,5),K(ae,ye-4,4),Be=0;Be<ye;Be++)K(ae,ae.bl_tree[2*ne[Be]+1],3);Z(ae,ae.dyn_ltree,he-1),Z(ae,ae.dyn_dtree,ge-1)}(i,i.l_desc.max_code+1,i.d_desc.max_code+1,le+1),I(i,i.dyn_ltree,i.dyn_dtree)),m(i),U&&M(i)},d._tr_tally=function(i,f,D){return i.pending_buf[i.d_buf+2*i.last_lit]=f>>>8&255,i.pending_buf[i.d_buf+2*i.last_lit+1]=255&f,i.pending_buf[i.l_buf+i.last_lit]=255&D,i.last_lit++,f===0?i.dyn_ltree[2*D]++:(i.matches++,f--,i.dyn_ltree[2*(_[D]+S+1)]++,i.dyn_dtree[2*R(f)]++),i.last_lit===i.lit_bufsize-1},d._tr_align=function(i){K(i,2,3),V(i,j,se),function(f){f.bi_valid===16?(q(f,f.bi_buf),f.bi_buf=0,f.bi_valid=0):8<=f.bi_valid&&(f.pending_buf[f.pending++]=255&f.bi_buf,f.bi_buf>>=8,f.bi_valid-=8)}(i)}},{"../utils/common":41}],53:[function(r,l,d){l.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(r,l,d){(function(o){(function(s,a){if(!s.setImmediate){var c,x,v,S,T=1,w={},E=!1,y=s.document,A=Object.getPrototypeOf&&Object.getPrototypeOf(s);A=A&&A.setTimeout?A:s,c={}.toString.call(s.process)==="[object process]"?function(O){ke.nextTick(function(){k(O)})}:function(){if(s.postMessage&&!s.importScripts){var O=!0,F=s.onmessage;return s.onmessage=function(){O=!1},s.postMessage("","*"),s.onmessage=F,O}}()?(S="setImmediate$"+Math.random()+"$",s.addEventListener?s.addEventListener("message",j,!1):s.attachEvent("onmessage",j),function(O){s.postMessage(S+O,"*")}):s.MessageChannel?((v=new MessageChannel).port1.onmessage=function(O){k(O.data)},function(O){v.port2.postMessage(O)}):y&&"onreadystatechange"in y.createElement("script")?(x=y.documentElement,function(O){var F=y.createElement("script");F.onreadystatechange=function(){k(O),F.onreadystatechange=null,x.removeChild(F),F=null},x.appendChild(F)}):function(O){setTimeout(k,0,O)},A.setImmediate=function(O){typeof O!="function"&&(O=new Function(""+O));for(var F=new Array(arguments.length-1),G=0;G<F.length;G++)F[G]=arguments[G+1];var W={callback:O,args:F};return w[T]=W,c(T),T++},A.clearImmediate=p}function p(O){delete w[O]}function k(O){if(E)setTimeout(k,0,O);else{var F=w[O];if(F){E=!0;try{(function(G){var W=G.callback,$=G.args;switch($.length){case 0:W();break;case 1:W($[0]);break;case 2:W($[0],$[1]);break;case 3:W($[0],$[1],$[2]);break;default:W.apply(a,$)}})(F)}finally{p(O),E=!1}}}}function j(O){O.source===s&&typeof O.data=="string"&&O.data.indexOf(S)===0&&k(+O.data.slice(S.length))}})(typeof self>"u"?o===void 0?this:o:self)}).call(this,typeof Qe<"u"?Qe:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})})(ps);var Pd=ps.exports;const Dd=bi(Pd);var or={exports:{}},Bd={"&":"&amp;",'"':"&quot;","'":"&apos;","<":"&lt;",">":"&gt;"};function Ld(t){return t&&t.replace?t.replace(/([&"<>'])/g,function(e,r){return Bd[r]}):t}var Md=Ld,_n=Md,ii=Fn.Stream,zd="    ";function Ud(t,e){typeof e!="object"&&(e={indent:e});var r=e.stream?new ii:null,l="",d=!1,o=e.indent?e.indent===!0?zd:e.indent:"",s=!0;function a(T){s?ke.nextTick(T):T()}function c(T,w){if(w!==void 0&&(l+=w),T&&!d&&(r=r||new ii,d=!0),T&&d){var E=l;a(function(){r.emit("data",E)}),l=""}}function x(T,w){Gn(c,lr(T,o,o?1:0),w)}function v(){if(r){var T=l;a(function(){r.emit("data",T),r.emit("end"),r.readable=!1,r.emit("close")})}}function S(T){var w=T.encoding||"UTF-8",E={version:"1.0",encoding:w};T.standalone&&(E.standalone=T.standalone),x({"?xml":{_attr:E}}),l=l.replace("/>","?>")}return a(function(){s=!1}),e.declaration&&S(e.declaration),t&&t.forEach?t.forEach(function(T,w){var E;w+1===t.length&&(E=v),x(T,E)}):x(t,v),r?(r.readable=!0,r):l}function Wd(){var t=Array.prototype.slice.call(arguments),e={_elem:lr(t)};return e.push=function(r){if(!this.append)throw new Error("not assigned to a parent!");var l=this,d=this._elem.indent;Gn(this.append,lr(r,d,this._elem.icount+(d?1:0)),function(){l.append(!0)})},e.close=function(r){r!==void 0&&this.push(r),this.end&&this.end()},e}function Hd(t,e){return new Array(e||0).join(t||"")}function lr(t,e,r){r=r||0;var l=Hd(e,r),d,o=t,s=!1;if(typeof t=="object"){var a=Object.keys(t);if(d=a[0],o=t[d],o&&o._elem)return o._elem.name=d,o._elem.icount=r,o._elem.indent=e,o._elem.indents=l,o._elem.interrupt=o,o._elem}var c=[],x=[],v;function S(T){var w=Object.keys(T);w.forEach(function(E){c.push(Gd(E,T[E]))})}switch(typeof o){case"object":if(o===null)break;o._attr&&S(o._attr),o._cdata&&x.push(("<![CDATA["+o._cdata).replace(/\]\]>/g,"]]]]><![CDATA[>")+"]]>"),o.forEach&&(v=!1,x.push(""),o.forEach(function(T){if(typeof T=="object"){var w=Object.keys(T)[0];w=="_attr"?S(T._attr):x.push(lr(T,e,r+1))}else x.pop(),v=!0,x.push(_n(T))}),v||x.push(""));break;default:x.push(_n(o))}return{name:d,interrupt:s,attributes:c,content:x,icount:r,indents:l,indent:e}}function Gn(t,e,r){if(typeof e!="object")return t(!1,e);var l=e.interrupt?1:e.content.length;function d(){for(;e.content.length;){var s=e.content.shift();if(s!==void 0){if(o(s))return;Gn(t,s)}}t(!1,(l>1?e.indents:"")+(e.name?"</"+e.name+">":"")+(e.indent&&!r?`
`:"")),r&&r()}function o(s){return s.interrupt?(s.interrupt.append=t,s.interrupt.end=d,s.interrupt=!1,t(!0),!0):!1}if(t(!1,e.indents+(e.name?"<"+e.name:"")+(e.attributes.length?" "+e.attributes.join(" "):"")+(l?e.name?">":"":e.name?"/>":"")+(e.indent&&l>1?`
`:"")),!l)return t(!1,e.indent?`
`:"");o(e)||d()}function Gd(t,e){return t+'="'+_n(e)+'"'}or.exports=Ud;or.exports.element=or.exports.Element=Wd;var Kd=or.exports;const Ie=bi(Kd),si=0,oi=32,qd=32,Vd=(t,e)=>{const r=e.replace(/-/g,"");if(r.length!==qd)throw new Error(`Error: Cannot extract GUID from font filename: ${e}`);const d=r.replace(/(..)/g,"$1 ").trim().split(" ").map(c=>parseInt(c,16));d.reverse();const s=t.slice(si,oi).map((c,x)=>c^d[x%d.length]);return Buffer.concat([t.slice(0,si),s,t.slice(oi)])};class $d{format(e,r={stack:[]}){const l=e.prepForXml(r);if(l)return l;throw Error("XMLComponent did not format correctly")}}class Xd{replace(e,r,l){let d=e;return r.forEach((o,s)=>{d=d.replace(new RegExp(`{${o.fileName}}`,"g"),(l+s).toString())}),d}getMediaData(e,r){return r.Array.filter(l=>e.search(`{${l.fileName}}`)>0)}}class Zd{replace(e,r){let l=e;for(const d of r)l=l.replace(new RegExp(`{${d.reference}-${d.instance}}`,"g"),d.numId.toString());return l}}class Yd{constructor(){ie(this,"formatter"),ie(this,"imageReplacer"),ie(this,"numberingReplacer"),this.formatter=new $d,this.imageReplacer=new Xd,this.numberingReplacer=new Zd}compile(e,r){const l=new Dd,d=this.xmlifyFile(e,r),o=new Map(Object.entries(d));for(const[,s]of o)if(Array.isArray(s))for(const a of s)l.file(a.path,a.data);else l.file(s.path,s.data);for(const{stream:s,fileName:a}of e.Media.Array)l.file(`word/media/${a}`,s);for(const{data:s,name:a,fontKey:c}of e.FontTable.fontOptionsWithKey){const[x]=a.split(".");l.file(`word/fonts/${x}.odttf`,Vd(s,c))}return l}xmlifyFile(e,r){const l=e.Document.Relationships.RelationshipCount+1,d=Ie(this.formatter.format(e.Document.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),o=this.imageReplacer.getMediaData(d,e.Media);return{Relationships:{data:(o.forEach((s,a)=>{e.Document.Relationships.createRelationship(l+a,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${s.fileName}`)}),Ie(this.formatter.format(e.Document.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}})),path:"word/_rels/document.xml.rels"},Document:{data:(()=>{const s=this.imageReplacer.replace(d,o,l);return this.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering)})(),path:"word/document.xml"},Styles:{data:(()=>{const s=Ie(this.formatter.format(e.Styles,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}});return this.numberingReplacer.replace(s,e.Numbering.ConcreteNumbering)})(),path:"word/styles.xml"},Properties:{data:Ie(this.formatter.format(e.CoreProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/core.xml"},Numbering:{data:Ie(this.formatter.format(e.Numbering,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/numbering.xml"},FileRelationships:{data:Ie(this.formatter.format(e.FileRelationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"_rels/.rels"},HeaderRelationships:e.Headers.map((s,a)=>{const c=Ie(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(c,e.Media).forEach((v,S)=>{s.Relationships.createRelationship(S,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:Ie(this.formatter.format(s.Relationships,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/header${a+1}.xml.rels`}}),FooterRelationships:e.Footers.map((s,a)=>{const c=Ie(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}});return this.imageReplacer.getMediaData(c,e.Media).forEach((v,S)=>{s.Relationships.createRelationship(S,"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",`media/${v.fileName}`)}),{data:Ie(this.formatter.format(s.Relationships,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:`word/_rels/footer${a+1}.xml.rels`}}),Headers:e.Headers.map((s,a)=>{const c=Ie(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(c,e.Media),v=this.imageReplacer.replace(c,x,0);return{data:this.numberingReplacer.replace(v,e.Numbering.ConcreteNumbering),path:`word/header${a+1}.xml`}}),Footers:e.Footers.map((s,a)=>{const c=Ie(this.formatter.format(s.View,{viewWrapper:s,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),x=this.imageReplacer.getMediaData(c,e.Media),v=this.imageReplacer.replace(c,x,0);return{data:this.numberingReplacer.replace(v,e.Numbering.ConcreteNumbering),path:`word/footer${a+1}.xml`}}),ContentTypes:{data:Ie(this.formatter.format(e.ContentTypes,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"[Content_Types].xml"},CustomProperties:{data:Ie(this.formatter.format(e.CustomProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/custom.xml"},AppProperties:{data:Ie(this.formatter.format(e.AppProperties,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"docProps/app.xml"},FootNotes:{data:Ie(this.formatter.format(e.FootNotes.View,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/footnotes.xml"},FootNotesRelationships:{data:Ie(this.formatter.format(e.FootNotes.Relationships,{viewWrapper:e.FootNotes,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/footnotes.xml.rels"},Settings:{data:Ie(this.formatter.format(e.Settings,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/settings.xml"},Comments:{data:Ie(this.formatter.format(e.Comments,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/comments.xml"},FontTable:{data:Ie(this.formatter.format(e.FontTable.View,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{standalone:"yes",encoding:"UTF-8"}}),path:"word/fontTable.xml"},FontTableRelationships:{data:Ie(this.formatter.format(e.FontTable.Relationships,{viewWrapper:e.Document,file:e,stack:[]}),{indent:r,declaration:{encoding:"UTF-8"}}),path:"word/_rels/fontTable.xml.rels"}}}}const Jd={WITH_2_BLANKS:"  "},Lt=t=>t===!0?Jd.WITH_2_BLANKS:t===!1?void 0:t;class ms{static toString(e,r){return Kt(this,null,function*(){return yield this.compiler.compile(e,Lt(r)).generateAsync({type:"string",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBuffer(e,r){return Kt(this,null,function*(){return yield this.compiler.compile(e,Lt(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBase64String(e,r){return Kt(this,null,function*(){return yield this.compiler.compile(e,Lt(r)).generateAsync({type:"base64",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toBlob(e,r){return Kt(this,null,function*(){return yield this.compiler.compile(e,Lt(r)).generateAsync({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"})})}static toStream(e,r){const l=new Fn.Stream;return this.compiler.compile(e,Lt(r)).generateAsync({type:"nodebuffer",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document",compression:"DEFLATE"}).then(o=>{l.emit("data",o),l.emit("end")}),l}}ie(ms,"compiler",new Yd);const Qd={fontName:"times",fontSize:12,lineSpacing:1.5,firstLineIndent:1.27,marginTop:4,marginBottom:3,marginLeft:4,marginRight:3,paperSize:"a4"},If=({sections:t,activeSectionId:e,setActiveSectionId:r,handleAddSection:l,handleDeleteSection:d,updateActiveSection:o,activeSection:s,isGenerating:a,onGenerate:c,onToolAction:x,textAreaRef:v,onNavigate:S,metadata:T,onCancelGeneration:w,bibliography:E,setBibliography:y,onReorderSections:A})=>{const[p,k]=me.useState(!1),[j,O]=me.useState(()=>typeof window<"u"?window.innerWidth>=768:!1),[F,G]=me.useState(0),[W,$]=me.useState(16),N=me.useRef(null),[ne,se]=me.useState(!1),[B,X]=me.useState(null),[_,Y]=me.useState(null),[de,Q]=me.useState(!1),[pe,te]=me.useState(!1),[fe,H]=me.useState(!1),R=me.useRef(null),[q,K]=me.useState(!1),[V,z]=me.useState(Qd),[g,m]=me.useState(!1);me.useEffect(()=>{const ce=s.content.trim().split(/\s+/).filter(we=>we.length>0).length;G(ce)},[s.content]),me.useEffect(()=>{const ce=we=>{R.current&&!R.current.contains(we.target)&&H(!1)};return document.addEventListener("mousedown",ce),()=>document.removeEventListener("mousedown",ce)},[]);const M=ce=>{N.current&&(N.current.scrollTop=ce.currentTarget.scrollTop)},P=ce=>{const we=ce.currentTarget,_e=we.selectionStart!==we.selectionEnd;Q(_e)},C=()=>{const ce=/^(\d+[\.\)]|[a-zA-Z][\.\)]|[-])\s/;return s.content.split(`
`).map((we,_e)=>{const be=ce.test(we);return u.jsx("div",{className:be?"hanging-indent":"",style:{minHeight:"1.8em"},children:we===""?u.jsx("br",{}):we},_e)})},I=ce=>{const we=ce.currentTarget,_e=we.selectionStart,be=we.value;if(we.selectionStart!==we.selectionEnd?Q(!0):Q(!1),ce.key==="Enter"){const Re=be.substring(0,_e).split(`
`),Ne=Re[Re.length-1],je=Ne.match(/^(\d+|[a-zA-Z])([\.\)])\s/),We=Ne.match(/^([-])\s/);if(je){ce.preventDefault();const Le=je[1],Ke=je[2];let qe="";if(!isNaN(Number(Le)))qe=`${parseInt(Le)+1}${Ke} `;else{const et=Le.charCodeAt(0);qe=`${String.fromCharCode(et+1)}${Ke} `}const lt=be.substring(0,_e)+`
`+qe+be.substring(we.selectionEnd);o({content:lt}),setTimeout(()=>{we.selectionStart=we.selectionEnd=_e+1+qe.length},0)}else if(We){ce.preventDefault();const Ke=`${We[1]} `,qe=be.substring(0,_e)+`
`+Ke+be.substring(we.selectionEnd);o({content:qe}),setTimeout(()=>{we.selectionStart=we.selectionEnd=_e+1+Ke.length},0)}}else if(ce.key==="Backspace"){const Ne=be.lastIndexOf(`
`,_e-1)+1,je=be.indexOf(`
`,_e),We=je===-1?be.length:je;if(_e===We){const Le=be.substring(Ne,We);if(/^(\d+[\.\)]|[a-zA-Z][\.\)]|[-])\s$/.test(Le)){ce.preventDefault();const qe=be.substring(0,Ne)+be.substring(We);o({content:qe}),setTimeout(()=>{v.current&&(v.current.selectionStart=v.current.selectionEnd=Ne)},0)}}}},J=ce=>{De.haptic("light"),S(ce),k(!1)},h=ce=>{De.haptic("light"),r(ce),k(!1)},Z=()=>{De.haptic("light"),$(ce=>Math.min(ce+2,32))},b=()=>{De.haptic("light"),$(ce=>Math.max(ce-2,12))},n=async()=>{De.haptic("medium");try{await navigator.clipboard.writeText(s.content),alert("Teks berhasil disalin ke clipboard!")}catch(ce){console.error("Gagal menyalin:",ce),alert("Gagal menyalin teks.")}},i=()=>{De.haptic("heavy"),confirm("Hapus tulisan di bagian ini? Tindakan ini tidak dapat dibatalkan.")&&o({content:""})},f=()=>(s.title||"untitled").replace(/[^a-z0-9]/gi,"_").toLowerCase(),D=async()=>{De.haptic("medium");const ce=`skripsi_${f()}.txt`,we=new Blob([s.content],{type:"text/plain"});await De.shareOrDownloadFile(ce,we,"text/plain"),H(!1)},U=()=>{const ce=new Ts({orientation:"portrait",unit:"mm",format:V.paperSize}),we=V.marginLeft*10,_e=V.marginTop*10,be=V.marginRight*10,Re=V.marginBottom*10,Ne=210,je=297,We=Ne-we-be;ce.setFont(V.fontName,"roman"),ce.setFontSize(V.fontSize),ce.setLineHeightFactor(V.lineSpacing);let Le=_e;ce.setFont(V.fontName,"bold"),ce.setFontSize(V.fontSize+2);const Ke=ce.splitTextToSize(s.title.toUpperCase(),We);return ce.text(Ke,Ne/2,Le,{align:"center"}),Le+=Ke.length*(V.fontSize/2)+10,ce.setFont(V.fontName,"roman"),ce.setFontSize(V.fontSize),s.content.split(`
`).forEach(lt=>{if(!lt.trim()){Le+=V.fontSize*.3528*V.lineSpacing;return}const et=Math.round(V.firstLineIndent*10/1.5),gs=" ".repeat(Math.max(0,et))+lt.trim(),Kn=ce.splitTextToSize(gs,We),qn=V.fontSize*.3528*V.lineSpacing,Vn=Kn.length*qn;Le+Vn>je-Re&&(ce.addPage(),Le=_e),ce.text(Kn,we,Le,{align:"justify",maxWidth:We});const ws=V.lineSpacing<1.5?qn*.5:0;Le+=Vn+ws}),ce},L=async()=>{m(!0),De.haptic("medium"),await new Promise(ce=>setTimeout(ce,100));try{const ce=U(),we=`skripsi_${f()}.pdf`,_e=ce.output("blob");await De.shareOrDownloadFile(we,_e,"application/pdf"),K(!1)}catch(ce){console.error(ce),alert("Gagal membuat PDF.")}finally{m(!1)}},re=({label:ce,value:we,onChange:_e,step:be=1,unit:Re=""})=>u.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-xl border border-slate-200",children:[u.jsx("span",{className:"text-xs font-bold text-slate-600",children:ce}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("button",{onClick:()=>{De.haptic("light"),_e(Number((we-be).toFixed(2)))},className:"w-8 h-8 flex items-center justify-center rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors",children:u.jsx(gi,{size:14})}),u.jsxs("span",{className:"text-sm font-mono font-bold w-12 text-center",children:[we,Re]}),u.jsx("button",{onClick:()=>{De.haptic("light"),_e(Number((we+be).toFixed(2)))},className:"w-8 h-8 flex items-center justify-center rounded-lg bg-blue-50 hover:bg-blue-100 text-blue-600 transition-colors",children:u.jsx(En,{size:14})})]})]}),le=()=>{De.haptic("medium");const ce=s.content.split(`
`).map(_e=>new Ut({children:[new sr({text:_e,font:"Times New Roman",size:24})],spacing:{line:360,before:0,after:0},indent:{firstLine:720},alignment:"both"})),we=new Od({sections:[{properties:{page:{margin:{top:1701,right:1701,bottom:2268,left:2268}}},children:[new Ut({children:[new sr({text:s.title.toUpperCase(),bold:!0,font:"Times New Roman",size:28})],alignment:"center",spacing:{after:400}}),...ce]}]});ms.toBlob(we).then(async _e=>{const be=`skripsi_${f()}.docx`;await De.shareOrDownloadFile(be,_e,"application/vnd.openxmlformats-officedocument.wordprocessingml.document"),H(!1)})},ae=ce=>{De.haptic("light");const we=ce==="bibliography";if(!j){te(we),O(!0);return}j&&(pe===we?O(!1):te(we))},he=ce=>{if(De.haptic("light"),ce==="bibliography"){ae("bibliography");return}if(te(!1),!v.current)return;const we=v.current,_e=we.selectionStart,be=we.selectionEnd,Re=we.value;let Ne;if(_e===be?Ne={start:0,end:Re.length,isFullText:!0,text:Re}:Ne={start:_e,end:be,isFullText:!1,text:Re.substring(_e,be)},Ne.text.trim().length===0&&ce!=="continue"){alert("Bagian ini masih kosong. Silakan tulis sesuatu atau gunakan 'Auto Tulis'.");return}Y(Ne),X(ce),se(!0),O(!1)},ge=(ce,we)=>{if(De.haptic("medium"),!B||!_||!v.current)return;const be=v.current.value;let Re="";if(B==="continue")if(!_.isFullText&&_.start!==_.end){const Ne=be.substring(0,_.start),je=be.substring(_.end);Re=Ne+ce+je}else Re=be+ce;else{const Ne=be.substring(0,_.start),je=be.substring(_.end);Re=Ne+ce+je}if(o({content:Re}),we&&we.length>0){const Ne=[...new Set([...E,...we])].sort();y(Ne),alert(`Berhasil menambahkan ${we.length} referensi ke Daftar Pustaka.`)}se(!1),Q(!1),B==="continue"&&setTimeout(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},100)},ye=()=>{De.haptic("light"),O(!1)},Be=ce=>{setTimeout(()=>{te(!0),O(!0)},50)};return u.jsxs("div",{className:"flex h-screen w-full bg-slate-100 overflow-hidden text-slate-800 relative",children:[u.jsx(bo,{isVisible:a,onCancel:w}),q&&u.jsx("div",{className:"fixed inset-0 z-[80] flex items-center justify-center bg-slate-900/80 backdrop-blur-sm animate-fade-in p-4",children:u.jsxs("div",{className:"bg-white w-full md:max-w-lg rounded-3xl shadow-2xl flex flex-col overflow-hidden animate-scale-in",children:[u.jsxs("div",{className:"p-4 md:px-6 border-b border-slate-100 flex justify-between items-center bg-white z-10 shrink-0",children:[u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("div",{className:"p-2 bg-red-50 text-red-600 rounded-xl",children:u.jsx(Bs,{size:20})}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold text-slate-900 text-lg leading-tight",children:"Ekspor PDF"}),u.jsx("p",{className:"text-xs text-slate-500",children:"Sesuaikan format dokumen."})]})]}),u.jsx("button",{onClick:()=>K(!1),className:"p-2 hover:bg-slate-100 rounded-full text-slate-400 transition-colors",children:u.jsx(it,{size:24})})]}),u.jsxs("div",{className:"flex-1 flex flex-col overflow-y-auto scroll-light bg-slate-50 p-6 space-y-8",children:[u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(qs,{size:14})," Tipografi"]}),u.jsxs("div",{className:"space-y-3",children:[u.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-200",children:[u.jsx("label",{className:"text-xs font-bold text-slate-600 mb-1 block",children:"Jenis Font"}),u.jsxs("select",{value:V.fontName,onChange:ce=>z({...V,fontName:ce.target.value}),className:"w-full p-2 bg-slate-50 rounded-lg text-sm font-medium outline-none",children:[u.jsx("option",{value:"times",children:"Times New Roman (Standar)"}),u.jsx("option",{value:"helvetica",children:"Arial / Helvetica"}),u.jsx("option",{value:"courier",children:"Courier New"})]})]}),u.jsx(re,{label:"Ukuran Font",value:V.fontSize,onChange:ce=>z({...V,fontSize:ce}),unit:"pt"}),u.jsxs("div",{className:"bg-white p-3 rounded-xl border border-slate-200",children:[u.jsx("label",{className:"text-xs font-bold text-slate-600 mb-1 block",children:"Spasi Baris"}),u.jsxs("select",{value:V.lineSpacing,onChange:ce=>z({...V,lineSpacing:Number(ce.target.value)}),className:"w-full p-2 bg-slate-50 rounded-lg text-sm font-medium outline-none",children:[u.jsx("option",{value:1,children:"1.0 (Single)"}),u.jsx("option",{value:1.15,children:"1.15"}),u.jsx("option",{value:1.5,children:"1.5 (1.5 Lines)"}),u.jsx("option",{value:2,children:"2.0 (Double)"})]})]}),u.jsx(re,{label:"Identasi Awal",value:V.firstLineIndent,onChange:ce=>z({...V,firstLineIndent:ce}),step:.1,unit:"cm"})]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("h4",{className:"text-xs font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2",children:[u.jsx(Ws,{size:14})," Margin (cm)"]}),u.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[u.jsx(re,{label:"Atas",value:V.marginTop,onChange:ce=>z({...V,marginTop:ce}),step:.1}),u.jsx(re,{label:"Bawah",value:V.marginBottom,onChange:ce=>z({...V,marginBottom:ce}),step:.1}),u.jsx(re,{label:"Kiri",value:V.marginLeft,onChange:ce=>z({...V,marginLeft:ce}),step:.1}),u.jsx(re,{label:"Kanan",value:V.marginRight,onChange:ce=>z({...V,marginRight:ce}),step:.1})]})]})]}),u.jsxs("div",{className:"p-4 border-t border-slate-200 bg-white flex gap-3 justify-end z-20 shrink-0",children:[u.jsx("button",{onClick:()=>K(!1),disabled:g,className:"px-6 py-3 rounded-xl border border-slate-200 text-slate-600 font-bold text-sm hover:bg-slate-50 transition-colors disabled:opacity-50",children:"Batal"}),u.jsxs("button",{onClick:L,disabled:g,className:"px-6 py-3 bg-red-600 text-white rounded-xl font-bold text-sm hover:bg-red-700 transition-all shadow-lg shadow-red-500/30 flex items-center gap-2 disabled:opacity-70 disabled:cursor-not-allowed",children:[g?u.jsx(Tn,{size:18,className:"animate-spin"}):u.jsx(Ks,{size:18}),g?"Menyimpan...":"Simpan PDF"]})]})]})}),ne&&B==="continue"&&u.jsx(eo,{isOpen:!0,onClose:()=>se(!1),onConfirm:ge,metadata:T,sectionTitle:s.title,toolType:B,currentContent:s.content,isExpandMode:!!_&&!_.isFullText,existingBibliography:E}),ne&&B==="paraphrase"&&u.jsx(po,{isOpen:!0,onClose:()=>se(!1),onConfirm:ce=>ge(ce),metadata:T,sectionTitle:s.title,textScope:_}),ne&&B==="fix"&&u.jsx(mo,{isOpen:!0,onClose:()=>se(!1),onConfirm:ce=>ge(ce),metadata:T,sectionTitle:s.title,textScope:_}),ne&&B==="plagiarism"&&u.jsx(go,{isOpen:!0,onClose:()=>se(!1),textScope:_}),u.jsx("div",{className:`fixed inset-0 bg-slate-950/60 z-40 transition-opacity duration-300 ease-in-out backdrop-blur-sm md:hidden ${p?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>k(!1)}),u.jsx("div",{className:`fixed inset-y-0 left-0 z-50 w-[80vw] md:w-80 transform transition-transform duration-300 cubic-bezier(0.2, 0, 0, 1) shadow-2xl md:relative md:translate-x-0 md:shadow-none ${p?"translate-x-0":"-translate-x-full"}`,children:u.jsxs("div",{className:"h-full relative flex flex-col",children:[u.jsx("button",{onClick:()=>k(!1),className:"absolute top-4 right-4 text-slate-400 hover:text-white md:hidden z-50 p-2",children:u.jsx(it,{size:24})}),u.jsx(ks,{sections:t,activeSectionId:e,setActiveSectionId:h,handleAddSection:l,handleDeleteSection:d,updateActiveSection:o,onReorderSections:A,activeSectionTitle:s.title,activeView:"editor",onNavigate:J})]})}),u.jsxs("div",{className:"flex-1 flex flex-col h-full w-full relative z-0 bg-slate-50 overflow-hidden transition-all duration-300 page-enter",children:[u.jsxs("div",{className:"h-16 border-b border-slate-200 flex items-center justify-between px-4 md:px-6 shadow-sm z-20 shrink-0 bg-white/80 backdrop-blur-md",children:[u.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[u.jsx("button",{onClick:()=>k(!p),className:"p-2 -ml-2 text-slate-600 hover:bg-slate-100 rounded-lg md:hidden hover-lift",children:u.jsx(_s,{size:20})}),u.jsxs("div",{className:"flex items-center gap-3 text-slate-500 text-sm overflow-hidden",children:[u.jsx("div",{className:"p-1.5 rounded-lg bg-slate-900 border border-slate-800 shadow-sm shrink-0 animate-scale-in",children:u.jsx(ht,{className:"w-5 h-5 text-white"})}),u.jsxs("div",{className:"flex flex-col animate-fade-in-up",children:[u.jsx("span",{className:"font-bold text-slate-900 truncate max-w-[150px] md:max-w-xs text-sm",children:s.title||"Draf Baru"}),u.jsxs("div",{className:"flex items-center gap-2 text-[10px] text-slate-400",children:[u.jsxs("span",{className:"truncate",children:[F," Kata"]}),a&&u.jsxs("span",{className:"text-[#3EC1FF] animate-pulse flex items-center gap-1",children:[u.jsx("span",{className:"w-1.5 h-1.5 rounded-full bg-[#3EC1FF]"})," Menulis..."]})]})]})]})]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("div",{className:"relative",ref:R,children:[u.jsxs("button",{onClick:()=>H(!fe),className:`p-2 text-slate-600 hover:bg-blue-50 hover:text-blue-600 rounded-lg transition-all border flex items-center gap-2 btn-press ${fe?"bg-blue-50 border-blue-200 text-blue-600":"border-transparent"}`,title:"Download / Ekspor",children:[u.jsx(Ps,{size:18}),u.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Simpan"})]}),fe&&u.jsx("div",{className:"absolute right-0 top-full mt-2 w-56 bg-white rounded-xl shadow-xl border border-slate-200 z-50 animate-scale-in origin-top-right overflow-hidden",children:u.jsxs("div",{className:"p-1.5 space-y-0.5",children:[u.jsx("div",{className:"px-3 py-2 text-[10px] font-bold text-slate-400 uppercase tracking-wider bg-slate-50/50 rounded-lg mb-1",children:"Format File"}),u.jsxs("button",{onClick:()=>{le()},className:"w-full text-left px-3 py-2.5 text-xs text-slate-700 hover:bg-blue-50 hover:text-blue-700 rounded-lg flex items-center gap-3 transition-colors",children:[u.jsx(ar,{size:16,className:"text-blue-500"})," Microsoft Word (.docx)"]}),u.jsxs("button",{onClick:()=>{K(!0),H(!1)},className:"w-full text-left px-3 py-2.5 text-xs text-slate-700 hover:bg-red-50 hover:text-red-700 rounded-lg flex items-center gap-3 transition-colors",children:[u.jsx(zs,{size:16,className:"text-red-500"})," PDF Document (.pdf)"]}),u.jsxs("button",{onClick:()=>{D()},className:"w-full text-left px-3 py-2.5 text-xs text-slate-700 hover:bg-slate-100 rounded-lg flex items-center gap-3 transition-colors",children:[u.jsx(ar,{size:16,className:"text-slate-400"})," Plain Text (.txt)"]}),u.jsx("div",{className:"h-px bg-slate-100 my-1"}),u.jsxs("button",{onClick:()=>{n(),H(!1)},className:"w-full text-left px-3 py-2.5 text-xs text-slate-700 hover:bg-green-50 hover:text-green-700 rounded-lg flex items-center gap-3 transition-colors",children:[u.jsx(pn,{size:16,className:"text-green-500"})," Salin ke Clipboard"]}),u.jsx("div",{className:"h-px bg-slate-100 my-1"}),u.jsxs("button",{onClick:()=>{i(),H(!1)},className:"w-full text-left px-3 py-2.5 text-xs text-red-600 hover:bg-red-50 rounded-lg flex items-center gap-3 transition-colors group",children:[u.jsx(Sn,{size:16,className:"group-hover:animate-bounce"})," Hapus Isi Editor"]})]})})]}),u.jsxs("button",{onClick:()=>ae("bibliography"),className:`p-2 rounded-lg transition-all border flex items-center gap-2 hover-lift ${pe?"bg-[#3EC1FF]/10 text-[#3EC1FF] border-[#3EC1FF]/30":"text-slate-600 hover:bg-slate-100 border-transparent"}`,title:"Daftar Pustaka",children:[u.jsx(nr,{size:18}),u.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Referensi"})]}),u.jsx("div",{className:"h-6 w-px bg-slate-200 mx-1"}),u.jsxs("button",{onClick:()=>ae("tools"),className:`p-2 text-white bg-slate-900 hover:bg-slate-800 rounded-lg shadow-lg shadow-slate-900/20 btn-press flex items-center gap-2 ${j&&!pe?"bg-slate-800":""}`,children:[u.jsx(wi,{size:18}),u.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Tools"})]})]})]}),u.jsxs("div",{className:"flex-1 overflow-hidden relative",children:[u.jsxs("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none z-0 overflow-hidden",children:[u.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-400/5 rounded-full blur-3xl animate-blob"}),u.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-400/5 rounded-full blur-3xl animate-blob animation-delay-2000"}),u.jsx(ht,{className:"w-[300px] h-[300px] md:w-[400px] md:h-[400px] opacity-[0.02]"})]}),u.jsxs("div",{className:"relative w-full h-full z-10",children:[u.jsx("div",{ref:N,className:"editor-backdrop editor-layer-config scroll-light p-6 md:p-12",style:{fontSize:`${W}px`},children:C()}),u.jsx("textarea",{ref:v,value:s.content,onChange:ce=>o({content:ce.target.value}),onKeyDown:I,onSelect:P,onScroll:M,onDrop:Be,placeholder:"Mulai menulis skripsi Anda di sini...",style:{fontSize:`${W}px`},className:"editor-textarea-transparent editor-layer-config scroll-light p-6 md:p-12",spellCheck:!1})]}),u.jsxs("div",{className:"absolute bottom-6 right-6 z-20 flex flex-col gap-3 items-end",children:[u.jsxs("div",{className:"flex items-center bg-white/80 backdrop-blur-md border border-slate-200 shadow-xl rounded-full p-1.5 gap-1 transition-all hover:scale-105 hover:shadow-2xl",children:[u.jsx("button",{onClick:b,className:"p-2 text-slate-500 hover:text-slate-900 hover:bg-slate-100 rounded-full transition-colors active:scale-90",title:"Perkecil Teks",children:u.jsx(Zs,{size:16})}),u.jsx("div",{className:"w-px h-4 bg-slate-300"}),u.jsx("button",{onClick:Z,className:"p-2 text-slate-500 hover:text-slate-900 hover:bg-slate-100 rounded-full transition-colors active:scale-90",title:"Perbesar Teks",children:u.jsx(Xs,{size:16})})]}),s.content.length>50&&!a&&u.jsxs("button",{onClick:()=>he("continue"),className:"pl-3 pr-4 py-2.5 bg-[#0A1A2E] hover:bg-slate-800 text-white rounded-full shadow-lg hover:shadow-xl shadow-slate-900/20 transition-all hover:-translate-y-1 active:scale-95 flex items-center gap-2 group animate-scale-in",title:"Lanjutkan Penulisan (AI)",children:[u.jsx("div",{className:"w-6 h-6 rounded-full bg-white/10 flex items-center justify-center group-hover:rotate-12 transition-transform",children:u.jsx(Gs,{size:12,className:"text-[#3EC1FF]"})}),u.jsx("span",{className:"text-xs font-bold tracking-wide",children:"Lanjutkan"})]})]})]})]}),u.jsx("div",{className:`fixed inset-0 bg-slate-950/60 z-40 transition-opacity duration-300 ease-in-out backdrop-blur-sm md:hidden ${j?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"}`,onClick:()=>O(!1)}),u.jsx("div",{className:`fixed inset-y-0 right-0 z-50 w-[80vw] md:w-72 transform transition-transform duration-300 cubic-bezier(0.2, 0, 0, 1) shadow-2xl md:relative md:shadow-none ${j?"translate-x-0":"translate-x-full md:hidden"}`,children:u.jsxs("div",{className:"h-full relative bg-white md:border-l border-slate-200",children:[!pe&&u.jsx("button",{onClick:()=>O(!1),className:"absolute top-5 right-4 text-slate-400 hover:text-slate-800 md:hidden z-50 p-2",children:u.jsx(it,{size:24})}),u.jsx("div",{className:"h-full animate-fade-in",children:pe?u.jsx(wo,{bibliography:E,setBibliography:y,onClose:()=>{te(!1),O(!1)},onDragStartAction:ye,currentContent:s.content}):u.jsx(Js,{onToolAction:he,isGenerating:a,hasSelection:de})},pe?"biblio":"tools")]})})]})};export{If as Editor};
